<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Masters Case: Exploração inicial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="01-eda_files/libs/clipboard/clipboard.min.js"></script>
<script src="01-eda_files/libs/quarto-html/quarto.js"></script>
<script src="01-eda_files/libs/quarto-html/popper.min.js"></script>
<script src="01-eda_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="01-eda_files/libs/quarto-html/anchor.min.js"></script>
<link href="01-eda_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="01-eda_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="01-eda_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="01-eda_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="01-eda_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Masters Case: Exploração inicial</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Felipe Viacava – São Paulo, ago/2023</p>
<p>O presente documento consiste na análise exploratória inicial dos dados fornecidos para a solução do Case “Data Masters - Cientista de Dados” do Santander Brasil. O objetivo é conhecer melhor os dados para definir com assertividade cada passo do processo de modelagem para as duas primeiras partes do projeto, que envolvem a classificação de clientes como satisfeitos ou insatisfeitos.</p>
<p>As premissas do presente documento são as seguintes: - Os dados fornecidos são confiáveis e representam a realidade; - Os dados fornecidos são suficientes para a solução do problema; - O problema é bem definido e pode ser resolvido com técnicas de classificação; - O objetivo é treinar o modelo com maior capacidade de predição possível, independente de sua explicabilidade; - A análise exploratória deve contemplar apenas um subconjunto dos dados para evitar <em>data leakage</em>, garantindo que a etapa de testes seja a mais próxima possível de um modelo em produção, sem qualquer viés decorrente dessa etapa; - Nenhuma transformação realizada nesta etapa deve ser gravada em disco. Aqui, os passos de transformação serão definidos para aplicação nos <em>pipelines</em> de classificação, garantindo maior reprodutibilidade e facilidade de manutenção; - Dada a quantidade de variáveis, seus prefixos e a ausência de metadados que descrevam suas características e seus propósitos de negócio, assumiu-se o contexto da empresa Santander Brasil enquanto banco para realizar suposições sobre as variáveis. Cada grupo de variáveis tem sua própria seção neste documento com suas premissas e análises.</p>
<section id="bibliotecas" class="level2">
<h2 class="anchored" data-anchor-id="bibliotecas">Bibliotecas</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Data Exploration --- #</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> missingno <span class="im">as</span> mno</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> resources.customviz <span class="im">as</span> cv</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> resources.edautils <span class="im">import</span> neg_pos_zero</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Data Processing --- #</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> resources.customtransformers <span class="im">import</span> <span class="op">\</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    DropConstantColumns, <span class="op">\</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    DropDuplicateColumns, <span class="op">\</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    AddNonZeroCount, <span class="op">\</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    CustomSum, <span class="op">\</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    CustomImputer, <span class="op">\</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    AddNoneCount, <span class="op">\</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    CustomEncoder</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Setting Global Options --- #</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>pd.options.display.max_columns <span class="op">=</span> <span class="va">None</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>pd.options.display.max_rows <span class="op">=</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="separação-em-treino-e-teste" class="level2">
<h2 class="anchored" data-anchor-id="separação-em-treino-e-teste">Separação em treino e teste</h2>
<p>Como explicitado nas premissas deste documento, o conjunto de dados foi dividido entre treino e teste para evitar <em>data leakage</em>. Utilizamos 80% do conjunto original, estratificado pela variável de interesse (“TARGET”).</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"data/raw.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df, test <span class="op">=</span> train_test_split(df, stratify<span class="op">=</span>df[<span class="st">"TARGET"</span>], random_state<span class="op">=</span><span class="dv">42</span>, train_size<span class="op">=</span><span class="fl">.8</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">"data/train.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>test.to_csv(<span class="st">"data/test.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> test</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">var3</th>
<th data-quarto-table-cell-role="th">var15</th>
<th data-quarto-table-cell-role="th">imp_ent_var16_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var40_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var40_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var41_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var41_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var39_ult1</th>
<th data-quarto-table-cell-role="th">imp_sal_var16_ult1</th>
<th data-quarto-table-cell-role="th">ind_var1_0</th>
<th data-quarto-table-cell-role="th">ind_var1</th>
<th data-quarto-table-cell-role="th">ind_var2_0</th>
<th data-quarto-table-cell-role="th">ind_var2</th>
<th data-quarto-table-cell-role="th">ind_var5_0</th>
<th data-quarto-table-cell-role="th">ind_var5</th>
<th data-quarto-table-cell-role="th">ind_var6_0</th>
<th data-quarto-table-cell-role="th">ind_var6</th>
<th data-quarto-table-cell-role="th">ind_var8_0</th>
<th data-quarto-table-cell-role="th">ind_var8</th>
<th data-quarto-table-cell-role="th">ind_var12_0</th>
<th data-quarto-table-cell-role="th">ind_var12</th>
<th data-quarto-table-cell-role="th">ind_var13_0</th>
<th data-quarto-table-cell-role="th">ind_var13_corto_0</th>
<th data-quarto-table-cell-role="th">ind_var13_corto</th>
<th data-quarto-table-cell-role="th">ind_var13_largo_0</th>
<th data-quarto-table-cell-role="th">ind_var13_largo</th>
<th data-quarto-table-cell-role="th">ind_var13_medio_0</th>
<th data-quarto-table-cell-role="th">ind_var13_medio</th>
<th data-quarto-table-cell-role="th">ind_var13</th>
<th data-quarto-table-cell-role="th">ind_var14_0</th>
<th data-quarto-table-cell-role="th">ind_var14</th>
<th data-quarto-table-cell-role="th">ind_var17_0</th>
<th data-quarto-table-cell-role="th">ind_var17</th>
<th data-quarto-table-cell-role="th">ind_var18_0</th>
<th data-quarto-table-cell-role="th">ind_var18</th>
<th data-quarto-table-cell-role="th">ind_var19</th>
<th data-quarto-table-cell-role="th">ind_var20_0</th>
<th data-quarto-table-cell-role="th">ind_var20</th>
<th data-quarto-table-cell-role="th">ind_var24_0</th>
<th data-quarto-table-cell-role="th">ind_var24</th>
<th data-quarto-table-cell-role="th">ind_var25_cte</th>
<th data-quarto-table-cell-role="th">ind_var26_0</th>
<th data-quarto-table-cell-role="th">ind_var26_cte</th>
<th data-quarto-table-cell-role="th">ind_var26</th>
<th data-quarto-table-cell-role="th">ind_var25_0</th>
<th data-quarto-table-cell-role="th">ind_var25</th>
<th data-quarto-table-cell-role="th">ind_var27_0</th>
<th data-quarto-table-cell-role="th">ind_var28_0</th>
<th data-quarto-table-cell-role="th">ind_var28</th>
<th data-quarto-table-cell-role="th">ind_var27</th>
<th data-quarto-table-cell-role="th">ind_var29_0</th>
<th data-quarto-table-cell-role="th">ind_var29</th>
<th data-quarto-table-cell-role="th">ind_var30_0</th>
<th data-quarto-table-cell-role="th">ind_var30</th>
<th data-quarto-table-cell-role="th">ind_var31_0</th>
<th data-quarto-table-cell-role="th">ind_var31</th>
<th data-quarto-table-cell-role="th">ind_var32_cte</th>
<th data-quarto-table-cell-role="th">ind_var32_0</th>
<th data-quarto-table-cell-role="th">ind_var32</th>
<th data-quarto-table-cell-role="th">ind_var33_0</th>
<th data-quarto-table-cell-role="th">ind_var33</th>
<th data-quarto-table-cell-role="th">ind_var34_0</th>
<th data-quarto-table-cell-role="th">ind_var34</th>
<th data-quarto-table-cell-role="th">ind_var37_cte</th>
<th data-quarto-table-cell-role="th">ind_var37_0</th>
<th data-quarto-table-cell-role="th">ind_var37</th>
<th data-quarto-table-cell-role="th">ind_var39_0</th>
<th data-quarto-table-cell-role="th">ind_var40_0</th>
<th data-quarto-table-cell-role="th">ind_var40</th>
<th data-quarto-table-cell-role="th">ind_var41_0</th>
<th data-quarto-table-cell-role="th">ind_var41</th>
<th data-quarto-table-cell-role="th">ind_var39</th>
<th data-quarto-table-cell-role="th">ind_var44_0</th>
<th data-quarto-table-cell-role="th">ind_var44</th>
<th data-quarto-table-cell-role="th">ind_var46_0</th>
<th data-quarto-table-cell-role="th">ind_var46</th>
<th data-quarto-table-cell-role="th">num_var1_0</th>
<th data-quarto-table-cell-role="th">num_var1</th>
<th data-quarto-table-cell-role="th">num_var4</th>
<th data-quarto-table-cell-role="th">num_var5_0</th>
<th data-quarto-table-cell-role="th">num_var5</th>
<th data-quarto-table-cell-role="th">num_var6_0</th>
<th data-quarto-table-cell-role="th">num_var6</th>
<th data-quarto-table-cell-role="th">num_var8_0</th>
<th data-quarto-table-cell-role="th">num_var8</th>
<th data-quarto-table-cell-role="th">num_var12_0</th>
<th data-quarto-table-cell-role="th">num_var12</th>
<th data-quarto-table-cell-role="th">num_var13_0</th>
<th data-quarto-table-cell-role="th">num_var13_corto_0</th>
<th data-quarto-table-cell-role="th">num_var13_corto</th>
<th data-quarto-table-cell-role="th">num_var13_largo_0</th>
<th data-quarto-table-cell-role="th">num_var13_largo</th>
<th data-quarto-table-cell-role="th">num_var13_medio_0</th>
<th data-quarto-table-cell-role="th">num_var13_medio</th>
<th data-quarto-table-cell-role="th">num_var13</th>
<th data-quarto-table-cell-role="th">num_var14_0</th>
<th data-quarto-table-cell-role="th">num_var14</th>
<th data-quarto-table-cell-role="th">num_var17_0</th>
<th data-quarto-table-cell-role="th">num_var17</th>
<th data-quarto-table-cell-role="th">num_var18_0</th>
<th data-quarto-table-cell-role="th">num_var18</th>
<th data-quarto-table-cell-role="th">num_var20_0</th>
<th data-quarto-table-cell-role="th">num_var20</th>
<th data-quarto-table-cell-role="th">num_var24_0</th>
<th data-quarto-table-cell-role="th">num_var24</th>
<th data-quarto-table-cell-role="th">num_var26_0</th>
<th data-quarto-table-cell-role="th">num_var26</th>
<th data-quarto-table-cell-role="th">num_var25_0</th>
<th data-quarto-table-cell-role="th">num_var25</th>
<th data-quarto-table-cell-role="th">num_op_var40_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var40_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var40_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var41_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var41_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var39_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var39_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_ult3</th>
<th data-quarto-table-cell-role="th">num_var27_0</th>
<th data-quarto-table-cell-role="th">num_var28_0</th>
<th data-quarto-table-cell-role="th">num_var28</th>
<th data-quarto-table-cell-role="th">num_var27</th>
<th data-quarto-table-cell-role="th">num_var29_0</th>
<th data-quarto-table-cell-role="th">num_var29</th>
<th data-quarto-table-cell-role="th">num_var30_0</th>
<th data-quarto-table-cell-role="th">num_var30</th>
<th data-quarto-table-cell-role="th">num_var31_0</th>
<th data-quarto-table-cell-role="th">num_var31</th>
<th data-quarto-table-cell-role="th">num_var32_0</th>
<th data-quarto-table-cell-role="th">num_var32</th>
<th data-quarto-table-cell-role="th">num_var33_0</th>
<th data-quarto-table-cell-role="th">num_var33</th>
<th data-quarto-table-cell-role="th">num_var34_0</th>
<th data-quarto-table-cell-role="th">num_var34</th>
<th data-quarto-table-cell-role="th">num_var35</th>
<th data-quarto-table-cell-role="th">num_var37_med_ult2</th>
<th data-quarto-table-cell-role="th">num_var37_0</th>
<th data-quarto-table-cell-role="th">num_var37</th>
<th data-quarto-table-cell-role="th">num_var39_0</th>
<th data-quarto-table-cell-role="th">num_var40_0</th>
<th data-quarto-table-cell-role="th">num_var40</th>
<th data-quarto-table-cell-role="th">num_var41_0</th>
<th data-quarto-table-cell-role="th">num_var41</th>
<th data-quarto-table-cell-role="th">num_var39</th>
<th data-quarto-table-cell-role="th">num_var42_0</th>
<th data-quarto-table-cell-role="th">num_var42</th>
<th data-quarto-table-cell-role="th">num_var44_0</th>
<th data-quarto-table-cell-role="th">num_var44</th>
<th data-quarto-table-cell-role="th">num_var46_0</th>
<th data-quarto-table-cell-role="th">num_var46</th>
<th data-quarto-table-cell-role="th">saldo_var1</th>
<th data-quarto-table-cell-role="th">saldo_var5</th>
<th data-quarto-table-cell-role="th">saldo_var6</th>
<th data-quarto-table-cell-role="th">saldo_var8</th>
<th data-quarto-table-cell-role="th">saldo_var12</th>
<th data-quarto-table-cell-role="th">saldo_var13_corto</th>
<th data-quarto-table-cell-role="th">saldo_var13_largo</th>
<th data-quarto-table-cell-role="th">saldo_var13_medio</th>
<th data-quarto-table-cell-role="th">saldo_var13</th>
<th data-quarto-table-cell-role="th">saldo_var14</th>
<th data-quarto-table-cell-role="th">saldo_var17</th>
<th data-quarto-table-cell-role="th">saldo_var18</th>
<th data-quarto-table-cell-role="th">saldo_var20</th>
<th data-quarto-table-cell-role="th">saldo_var24</th>
<th data-quarto-table-cell-role="th">saldo_var26</th>
<th data-quarto-table-cell-role="th">saldo_var25</th>
<th data-quarto-table-cell-role="th">saldo_var28</th>
<th data-quarto-table-cell-role="th">saldo_var27</th>
<th data-quarto-table-cell-role="th">saldo_var29</th>
<th data-quarto-table-cell-role="th">saldo_var30</th>
<th data-quarto-table-cell-role="th">saldo_var31</th>
<th data-quarto-table-cell-role="th">saldo_var32</th>
<th data-quarto-table-cell-role="th">saldo_var33</th>
<th data-quarto-table-cell-role="th">saldo_var34</th>
<th data-quarto-table-cell-role="th">saldo_var37</th>
<th data-quarto-table-cell-role="th">saldo_var40</th>
<th data-quarto-table-cell-role="th">saldo_var41</th>
<th data-quarto-table-cell-role="th">saldo_var42</th>
<th data-quarto-table-cell-role="th">saldo_var44</th>
<th data-quarto-table-cell-role="th">saldo_var46</th>
<th data-quarto-table-cell-role="th">var36</th>
<th data-quarto-table-cell-role="th">delta_imp_amort_var18_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_amort_var34_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_venta_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_reemb_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_reemb_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_reemb_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_trasp_var17_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_trasp_var17_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_trasp_var33_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_trasp_var33_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_venta_var44_1y3</th>
<th data-quarto-table-cell-role="th">imp_amort_var18_hace3</th>
<th data-quarto-table-cell-role="th">imp_amort_var18_ult1</th>
<th data-quarto-table-cell-role="th">imp_amort_var34_hace3</th>
<th data-quarto-table-cell-role="th">imp_amort_var34_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var13_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var13_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var17_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var17_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var33_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var33_ult1</th>
<th data-quarto-table-cell-role="th">imp_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">imp_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">imp_compra_var44_hace3</th>
<th data-quarto-table-cell-role="th">imp_compra_var44_ult1</th>
<th data-quarto-table-cell-role="th">imp_reemb_var13_hace3</th>
<th data-quarto-table-cell-role="th">imp_reemb_var13_ult1</th>
<th data-quarto-table-cell-role="th">imp_reemb_var17_hace3</th>
<th data-quarto-table-cell-role="th">imp_reemb_var17_ult1</th>
<th data-quarto-table-cell-role="th">imp_reemb_var33_hace3</th>
<th data-quarto-table-cell-role="th">imp_reemb_var33_ult1</th>
<th data-quarto-table-cell-role="th">imp_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">imp_trans_var37_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_in_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_in_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_out_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_out_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_in_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_in_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_out_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_out_ult1</th>
<th data-quarto-table-cell-role="th">imp_venta_var44_hace3</th>
<th data-quarto-table-cell-role="th">imp_venta_var44_ult1</th>
<th data-quarto-table-cell-role="th">ind_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">ind_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">ind_var10_ult1</th>
<th data-quarto-table-cell-role="th">ind_var10cte_ult1</th>
<th data-quarto-table-cell-role="th">ind_var9_cte_ult1</th>
<th data-quarto-table-cell-role="th">ind_var9_ult1</th>
<th data-quarto-table-cell-role="th">ind_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">ind_var43_recib_ult1</th>
<th data-quarto-table-cell-role="th">var21</th>
<th data-quarto-table-cell-role="th">num_var2_0_ult1</th>
<th data-quarto-table-cell-role="th">num_var2_ult1</th>
<th data-quarto-table-cell-role="th">num_aport_var13_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var13_ult1</th>
<th data-quarto-table-cell-role="th">num_aport_var17_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var17_ult1</th>
<th data-quarto-table-cell-role="th">num_aport_var33_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var33_ult1</th>
<th data-quarto-table-cell-role="th">num_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">num_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">num_compra_var44_hace3</th>
<th data-quarto-table-cell-role="th">num_compra_var44_ult1</th>
<th data-quarto-table-cell-role="th">num_ent_var16_ult1</th>
<th data-quarto-table-cell-role="th">num_var22_hace2</th>
<th data-quarto-table-cell-role="th">num_var22_hace3</th>
<th data-quarto-table-cell-role="th">num_var22_ult1</th>
<th data-quarto-table-cell-role="th">num_var22_ult3</th>
<th data-quarto-table-cell-role="th">num_med_var22_ult3</th>
<th data-quarto-table-cell-role="th">num_med_var45_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var5_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var8_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var12_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var13_corto_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var13_largo_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var13_medio_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var17_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var29_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var33_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var39_vig_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var44_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var40_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var40_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_reemb_var13_hace3</th>
<th data-quarto-table-cell-role="th">num_reemb_var13_ult1</th>
<th data-quarto-table-cell-role="th">num_reemb_var17_hace3</th>
<th data-quarto-table-cell-role="th">num_reemb_var17_ult1</th>
<th data-quarto-table-cell-role="th">num_reemb_var33_hace3</th>
<th data-quarto-table-cell-role="th">num_reemb_var33_ult1</th>
<th data-quarto-table-cell-role="th">num_sal_var16_ult1</th>
<th data-quarto-table-cell-role="th">num_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">num_var43_recib_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var11_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_in_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_in_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_out_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_out_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_in_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_in_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_out_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_out_ult1</th>
<th data-quarto-table-cell-role="th">num_venta_var44_hace3</th>
<th data-quarto-table-cell-role="th">num_venta_var44_ult1</th>
<th data-quarto-table-cell-role="th">num_var45_hace2</th>
<th data-quarto-table-cell-role="th">num_var45_hace3</th>
<th data-quarto-table-cell-role="th">num_var45_ult1</th>
<th data-quarto-table-cell-role="th">num_var45_ult3</th>
<th data-quarto-table-cell-role="th">saldo_var2_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_medio_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_medio_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_medio_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_medio_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_ult3</th>
<th data-quarto-table-cell-role="th">var38</th>
<th data-quarto-table-cell-role="th">TARGET</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">56035</td>
<td>111813</td>
<td>2</td>
<td>22</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>3.0</td>
<td>0.0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3.00</td>
<td>1.56</td>
<td>3.0</td>
<td>2.52</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>117310.979016</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15449</td>
<td>31053</td>
<td>2</td>
<td>79</td>
<td>105.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>30.0</td>
<td>0.0</td>
<td>0.0</td>
<td>42048.6</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>42048.6</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>42078.6</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>42078.6</td>
<td>0.0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>105.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>3</td>
<td>3</td>
<td>12</td>
<td>0</td>
<td>14933.22</td>
<td>8.28</td>
<td>30.0</td>
<td>4990.50</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>25741.95</td>
<td>0.0</td>
<td>42034.5</td>
<td>33888.24</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>68480.010000</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">68443</td>
<td>136647</td>
<td>2</td>
<td>29</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>3.0</td>
<td>0.0</td>
<td>0</td>
<td>99</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3.00</td>
<td>1.44</td>
<td>3.0</td>
<td>2.49</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>57517.740000</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50258</td>
<td>100343</td>
<td>2</td>
<td>29</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>3.0</td>
<td>0.0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3.00</td>
<td>1.95</td>
<td>3.0</td>
<td>2.64</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>60060.930000</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4858</td>
<td>9720</td>
<td>2</td>
<td>25</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>3.0</td>
<td>0.0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2.67</td>
<td>0.00</td>
<td>3.0</td>
<td>2.85</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>84028.740000</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="análise-exploratória-e-feature-engineering" class="level2">
<h2 class="anchored" data-anchor-id="análise-exploratória-e-feature-engineering">Análise Exploratória e Feature Engineering</h2>
<p>A análise exploratória segue as premissas descritas no cabeçalho deste documento, e foi dividida em 3 partes: - Análise generalizada, onde se detectou a presença de colunas constantes e/ou duplicadas; - Análise por prefixo, onde se assumiram as mesmas premissas para variáveis com o mesmo prefixo; - Análise individual para variáveis sem prefixos.</p>
<p>Cada parte inclui apenas as colunas que não foram descartadas nas etapas anteriores, ou seja: uma variável de prefixo “ind” que tenha sido encontrada como constante ou duplicada na primeira etapa de análise (e processamento, durante a transformação no <em>pipeline</em>) não foi analisada durante a seção de seu prefixo.</p>
<p>Muitas variáveis compartilham o nome principal (“var30”, por exemplo), indicando que uma variável de prefixo “ind” por ser um indicador de uma variável de prefixo “saldo”. Contudo, por haver muitos nomes, esta relação foi deixada como um ponto a melhorar em futuras versões deste <em>case</em>.</p>
<section id="removendo-variáveis-constantes-e-duplicadas" class="level3">
<h3 class="anchored" data-anchor-id="removendo-variáveis-constantes-e-duplicadas">Removendo variáveis constantes e duplicadas</h3>
<p>Percebeu-se a existência de variáveis constantes e/ou duplicadas.</p>
<p>Variáveis aleatórias constantes não servem propósito algum na modelagem e ocupam espaço na memória, aumentando o custo computacional sem qualquer benefício na predição. Isso motiva a criação de um transformador customizado que detecta estas variáveis durante o <em>fit</em> (considerando apenas o subconjunto de treino) e as remove durante a transformação (tanto no subconjunto de treino quanto no de teste).</p>
<p>Variáveis duplicadas, por outro lado, levam à multicolinearidade, que pode impactar negativamente qualquer modelo estatístico – tanto em poder preditivo quanto em explicabilidade.</p>
<p>Os dois transformadores utilizados para realizar esta operação são <em>DropConstantColumns</em> e <em>DropDuplicateColumns</em>, encontrados no arquivo “customtransformers.py”, na pasta “resources” deste projeto.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dcc <span class="op">=</span> DropConstantColumns(print_cols<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>dcc <span class="op">=</span> dcc.fit(df)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> dcc.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>47 constant columns were found</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ddc <span class="op">=</span> DropDuplicateColumns(print_cols<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ddc <span class="op">=</span> ddc.fit(df)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ddc.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>25 duplicate columns were found.</code></pre>
</div>
</div>
</section>
<section id="valores-faltantes" class="level3">
<h3 class="anchored" data-anchor-id="valores-faltantes">Valores faltantes</h3>
<p>Percebeu-se que não há nenhum valor faltante no conjunto de dados. Isso indica que, possivelmente, estes dados passaram por algum tratamento prévio, onde os valores faltantes foram preenchidos ou removidos. A investigação sobre dados faltantes, nesta análise, é própria de cada prefixo ou variável sem prefixo.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Número de valores faltantes no dataset:"</span>, df.isna().<span class="bu">sum</span>().<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Número de valores faltantes no dataset: 0</code></pre>
</div>
</div>
</section>
<section id="id" class="level3">
<h3 class="anchored" data-anchor-id="id">ID</h3>
<p>Assumiu-se que esta coluna é o ID anonimizado de cada observação (cliente) da base, tanto pelo nome quanto por não conter nenhum valor duplicado ou faltante. Esta coluna não deve ser usada em hipótese alguma durante o treinamento pois, por ser uma chave única, não há como generalizar o aprendizado sobre ela para novos clientes (<em>overfitting</em>).</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"ID"</span>].nunique() <span class="op">/</span> df.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>1.0</code></pre>
</div>
</div>
</section>
<section id="target" class="level3">
<h3 class="anchored" data-anchor-id="target">TARGET</h3>
<p>Assumiu-se que esta é a variável de interesse do problema por conta de seu nome e por ser binária (considerando que este é um problema de classificação binária). Dada a proporção de clientes insatisfeitos, é necessário validar o corte de classificação antes de classificar os clientes, além de usar os parâmetros feitos para lidar com este tipo de problema (como <em>class weight</em>) quando possível.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"TARGET"</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>).reset_index().set_index(<span class="st">"TARGET"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">proportion</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.960438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.039562</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="saldo" class="level3">
<h3 class="anchored" data-anchor-id="saldo">Saldo</h3>
<p>Assumiu-se, partindo das premissas descritas no cabeçalho, que esta é uma variável numérica, pois o prefixo “saldo” sugere que se trata de uma valor monetário. Como são muitas colunas, entende-se que se trata do saldo que um cliente tem em diversos produtos financeiros.</p>
<p>Números decimais, números negativos (no caso de um produto como Cheque Especial) e muitos valores únicos corroboram esta hipótese, assim como a esparsidade destes dados: com algum conhecimento de negócios, podemos inferir que é incomum um cliente possuir saldo em todos os produtos financeiros que o banco oferece.</p>
<p>Para detectar clientes com muitos produtos, foi criado o transformador “<em>AddNonZeroCount</em>”, que conta a quantidade de valores diferentes de zero um cliente tem nas colunas mesmo prefixo. Essa variável mostra que clientes com mais produtos tendem a ser mais satisfeitos – o que faz sentido, pois mostra que com maior satisfação, o cliente tende a adquirir mais produtos. Na verdade, a suma maioria dos clientes insatisfeitos se concentra em 0.</p>
<p>Para encontrar a diferença entre os saldos dos clientes de modo geral, foi criado o transformador “<em>CustomSum</em>”, que soma os valores de todas as colunas com o mesmo prefixo. Diferentemente da contagem de não-zeros, essa variável não aparenta ter poder de discriminação relevante</p>
<section id="verificações-generalizadas" class="level4">
<h4 class="anchored" data-anchor-id="verificações-generalizadas">Verificações generalizadas</h4>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>saldo_cols <span class="op">=</span> [</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col.startswith(<span class="st">"saldo"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>df[saldo_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">saldo_var1</th>
<th data-quarto-table-cell-role="th">saldo_var5</th>
<th data-quarto-table-cell-role="th">saldo_var8</th>
<th data-quarto-table-cell-role="th">saldo_var12</th>
<th data-quarto-table-cell-role="th">saldo_var13_corto</th>
<th data-quarto-table-cell-role="th">saldo_var13_largo</th>
<th data-quarto-table-cell-role="th">saldo_var13</th>
<th data-quarto-table-cell-role="th">saldo_var14</th>
<th data-quarto-table-cell-role="th">saldo_var17</th>
<th data-quarto-table-cell-role="th">saldo_var18</th>
<th data-quarto-table-cell-role="th">saldo_var20</th>
<th data-quarto-table-cell-role="th">saldo_var24</th>
<th data-quarto-table-cell-role="th">saldo_var26</th>
<th data-quarto-table-cell-role="th">saldo_var25</th>
<th data-quarto-table-cell-role="th">saldo_var29</th>
<th data-quarto-table-cell-role="th">saldo_var30</th>
<th data-quarto-table-cell-role="th">saldo_var31</th>
<th data-quarto-table-cell-role="th">saldo_var32</th>
<th data-quarto-table-cell-role="th">saldo_var33</th>
<th data-quarto-table-cell-role="th">saldo_var34</th>
<th data-quarto-table-cell-role="th">saldo_var37</th>
<th data-quarto-table-cell-role="th">saldo_var40</th>
<th data-quarto-table-cell-role="th">saldo_var42</th>
<th data-quarto-table-cell-role="th">saldo_var44</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_ult3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>5.421243e+01</td>
<td>1023.580114</td>
<td>147.164810</td>
<td>6.145564e+03</td>
<td>5007.146940</td>
<td>1.556449e+03</td>
<td>6.563596e+03</td>
<td>73.400380</td>
<td>2.193110e+02</td>
<td>4.932912e+01</td>
<td>29.460104</td>
<td>6.042704e+03</td>
<td>77.008466</td>
<td>73.592049</td>
<td>0.518094</td>
<td>1.388042e+04</td>
<td>3.350655e+02</td>
<td>3.416418</td>
<td>8.024900</td>
<td>0.838595</td>
<td>37.824253</td>
<td>4.044708</td>
<td>7.316827e+03</td>
<td>107.729578</td>
<td>1574.486122</td>
<td>8.892026e+02</td>
<td>1084.740443</td>
<td>1056.020634</td>
<td>72.059624</td>
<td>9.595272</td>
<td>129.412427</td>
<td>113.547998</td>
<td>4.096795e+03</td>
<td>632.316635</td>
<td>5.827253e+03</td>
<td>4.479855e+03</td>
<td>3632.299539</td>
<td>563.873755</td>
<td>4867.817947</td>
<td>3869.127405</td>
<td>801.746822</td>
<td>165.940223</td>
<td>9.967677e+02</td>
<td>7.797536e+02</td>
<td>1.076352e+02</td>
<td>4.474321e+01</td>
<td>1.559413e+02</td>
<td>1.300591e+02</td>
<td>0.266339</td>
<td>0.002388</td>
<td>0.317384</td>
<td>0.233287</td>
<td>6.440666</td>
<td>1.311271</td>
<td>7.954414</td>
<td>5.865130</td>
<td>33.599873</td>
<td>1.668842</td>
<td>82.080819</td>
<td>61.958431</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>1.216651e+04</td>
<td>9631.082614</td>
<td>2638.277572</td>
<td>4.976986e+04</td>
<td>32708.177345</td>
<td>2.077014e+04</td>
<td>3.888554e+04</td>
<td>3051.818963</td>
<td>2.535943e+04</td>
<td>1.216501e+04</td>
<td>2748.430264</td>
<td>4.961221e+04</td>
<td>769.211470</td>
<td>755.560611</td>
<td>92.904907</td>
<td>6.467857e+04</td>
<td>2.601808e+04</td>
<td>131.023675</td>
<td>492.024186</td>
<td>158.144155</td>
<td>500.605840</td>
<td>109.663575</td>
<td>5.069721e+04</td>
<td>5733.602855</td>
<td>11921.458336</td>
<td>1.031913e+04</td>
<td>9390.625089</td>
<td>8065.251410</td>
<td>1870.405196</td>
<td>481.561337</td>
<td>2268.032588</td>
<td>1945.458121</td>
<td>3.961191e+04</td>
<td>9593.663815</td>
<td>4.789661e+04</td>
<td>3.649015e+04</td>
<td>26286.326792</td>
<td>7297.654879</td>
<td>31963.155279</td>
<td>25587.988788</td>
<td>13401.769748</td>
<td>4705.909949</td>
<td>1.661751e+04</td>
<td>1.279101e+04</td>
<td>1.719559e+04</td>
<td>9.627698e+03</td>
<td>1.670705e+04</td>
<td>1.461361e+04</td>
<td>46.756603</td>
<td>0.588786</td>
<td>58.225764</td>
<td>35.642179</td>
<td>416.720118</td>
<td>116.443347</td>
<td>488.355798</td>
<td>353.187991</td>
<td>2193.005808</td>
<td>140.817701</td>
<td>4381.968936</td>
<td>3106.016476</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000e+00</td>
<td>-1842.000000</td>
<td>-4942.260000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-4.942260e+03</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-4.942260e+03</td>
<td>0.000000</td>
<td>-128.370000</td>
<td>-8.040000e+00</td>
<td>-922.380000</td>
<td>-476.070000</td>
<td>-287.670000</td>
<td>0.000000</td>
<td>-3401.340000</td>
<td>-1844.520000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>-3.000000e-02</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.000000e+00</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000e+00</td>
<td>0.000000</td>
<td>3.000000</td>
<td>9.900000e-01</td>
<td>3.000000</td>
<td>2.730000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.000000e+00</td>
<td>90.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>2.403075e+02</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.200000e+02</td>
<td>0.000000</td>
<td>90.000000</td>
<td>1.245000e+01</td>
<td>90.000000</td>
<td>83.880000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>3.000000e+06</td>
<td>619329.150000</td>
<td>240045.000000</td>
<td>3.008077e+06</td>
<td>450000.000000</td>
<td>1.500000e+06</td>
<td>1.500000e+06</td>
<td>450000.000000</td>
<td>6.119500e+06</td>
<td>3.000000e+06</td>
<td>455858.160000</td>
<td>3.008077e+06</td>
<td>69756.720000</td>
<td>69756.720000</td>
<td>19531.800000</td>
<td>3.458077e+06</td>
<td>6.119500e+06</td>
<td>12210.780000</td>
<td>51024.180000</td>
<td>36000.000000</td>
<td>60000.000000</td>
<td>8192.610000</td>
<td>3.008077e+06</td>
<td>740006.610000</td>
<td>812137.260000</td>
<td>1.542339e+06</td>
<td>601428.600000</td>
<td>544365.570000</td>
<td>231351.990000</td>
<td>73362.240000</td>
<td>228031.800000</td>
<td>177582.000000</td>
<td>3.000538e+06</td>
<td>668335.320000</td>
<td>3.004186e+06</td>
<td>2.272859e+06</td>
<td>450000.000000</td>
<td>304838.700000</td>
<td>450000.000000</td>
<td>450000.000000</td>
<td>840000.000000</td>
<td>534000.000000</td>
<td>1.500000e+06</td>
<td>1.034483e+06</td>
<td>4.210084e+06</td>
<td>2.368559e+06</td>
<td>3.998687e+06</td>
<td>3.525777e+06</td>
<td>10430.010000</td>
<td>145.200000</td>
<td>13793.670000</td>
<td>7331.340000</td>
<td>50003.880000</td>
<td>20385.720000</td>
<td>50232.960000</td>
<td>40207.530000</td>
<td>438329.220000</td>
<td>24650.010000</td>
<td>681462.900000</td>
<td>397884.300000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df[saldo_cols] <span class="op">\</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    .nunique() <span class="op">\</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    .nlargest(<span class="dv">5</span>) <span class="op">\</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    .rename(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        mapper<span class="op">=</span>{</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"index"</span>: <span class="st">"Column"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>: <span class="st">"Number of unique values"</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">\</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    .set_index(<span class="st">"Column"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Number of unique values</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">saldo_medio_var5_ult3</td>
<td>14582</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">saldo_var30</td>
<td>13974</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">saldo_var42</td>
<td>12946</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">saldo_medio_var5_ult1</td>
<td>12279</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">saldo_medio_var5_hace2</td>
<td>12115</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>neg_pos_zero(df, saldo_cols) <span class="co"># Esta função foi criada no arquivo "edautils.py"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Negative values (%)</th>
<th data-quarto-table-cell-role="th">Positive values (%)</th>
<th data-quarto-table-cell-role="th">Zero values (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>saldo_var1</td>
<td>0.000000</td>
<td>0.358458</td>
<td>99.641542</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>saldo_medio_var12_hace3</td>
<td>0.000000</td>
<td>1.687056</td>
<td>98.312944</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>saldo_medio_var12_ult1</td>
<td>0.000000</td>
<td>4.589253</td>
<td>95.410747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>saldo_medio_var12_ult3</td>
<td>0.000000</td>
<td>4.589253</td>
<td>95.410747</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>saldo_medio_var13_corto_hace2</td>
<td>0.000000</td>
<td>3.897001</td>
<td>96.102999</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>saldo_medio_var13_corto_hace3</td>
<td>0.000000</td>
<td>1.784070</td>
<td>98.215930</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>saldo_medio_var13_corto_ult1</td>
<td>0.000000</td>
<td>4.181465</td>
<td>95.818535</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>saldo_medio_var13_corto_ult3</td>
<td>0.000000</td>
<td>4.181465</td>
<td>95.818535</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>saldo_medio_var13_largo_hace2</td>
<td>0.000000</td>
<td>0.656077</td>
<td>99.343923</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>saldo_medio_var13_largo_hace3</td>
<td>0.000000</td>
<td>0.406143</td>
<td>99.593857</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>saldo_medio_var13_largo_ult1</td>
<td>0.000000</td>
<td>0.721850</td>
<td>99.278150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>saldo_medio_var13_largo_ult3</td>
<td>0.000000</td>
<td>0.721850</td>
<td>99.278150</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>saldo_medio_var12_hace2</td>
<td>0.000000</td>
<td>3.959484</td>
<td>96.040516</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>saldo_medio_var17_hace3</td>
<td>0.000000</td>
<td>0.021376</td>
<td>99.978624</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">47</td>
<td>saldo_medio_var17_ult3</td>
<td>0.000000</td>
<td>0.164430</td>
<td>99.835570</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">48</td>
<td>saldo_medio_var29_hace2</td>
<td>0.000000</td>
<td>0.006577</td>
<td>99.993423</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">49</td>
<td>saldo_medio_var29_hace3</td>
<td>0.000000</td>
<td>0.001644</td>
<td>99.998356</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50</td>
<td>saldo_medio_var29_ult1</td>
<td>0.000000</td>
<td>0.004933</td>
<td>99.995067</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">51</td>
<td>saldo_medio_var29_ult3</td>
<td>0.000000</td>
<td>0.004933</td>
<td>99.995067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">52</td>
<td>saldo_medio_var33_hace2</td>
<td>0.000000</td>
<td>0.050973</td>
<td>99.949027</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">53</td>
<td>saldo_medio_var33_hace3</td>
<td>0.000000</td>
<td>0.029597</td>
<td>99.970403</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">54</td>
<td>saldo_medio_var33_ult1</td>
<td>0.000000</td>
<td>0.054262</td>
<td>99.945738</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">55</td>
<td>saldo_medio_var33_ult3</td>
<td>0.000000</td>
<td>0.054262</td>
<td>99.945738</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">56</td>
<td>saldo_medio_var44_hace2</td>
<td>0.000000</td>
<td>0.126611</td>
<td>99.873389</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">57</td>
<td>saldo_medio_var44_hace3</td>
<td>0.000000</td>
<td>0.037819</td>
<td>99.962181</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">46</td>
<td>saldo_medio_var17_ult1</td>
<td>0.000000</td>
<td>0.164430</td>
<td>99.835570</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>saldo_medio_var44_ult1</td>
<td>0.000000</td>
<td>0.187451</td>
<td>99.812549</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>saldo_medio_var8_hace3</td>
<td>0.000000</td>
<td>0.628124</td>
<td>99.371876</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>saldo_var29</td>
<td>0.000000</td>
<td>0.003289</td>
<td>99.996711</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>saldo_var12</td>
<td>0.000000</td>
<td>4.564588</td>
<td>95.435412</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>saldo_var13_corto</td>
<td>0.000000</td>
<td>4.138713</td>
<td>95.861287</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>saldo_var13_largo</td>
<td>0.000000</td>
<td>1.019469</td>
<td>98.980531</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>saldo_var13</td>
<td>0.000000</td>
<td>5.092410</td>
<td>94.907590</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>saldo_var14</td>
<td>0.000000</td>
<td>0.527822</td>
<td>99.472178</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>saldo_var17</td>
<td>0.000000</td>
<td>0.154565</td>
<td>99.845435</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>saldo_var18</td>
<td>0.000000</td>
<td>0.001644</td>
<td>99.998356</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>saldo_var20</td>
<td>0.000000</td>
<td>0.248290</td>
<td>99.751710</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>saldo_var24</td>
<td>0.000000</td>
<td>3.832873</td>
<td>96.167127</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>saldo_var26</td>
<td>0.000000</td>
<td>2.489476</td>
<td>97.510524</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>saldo_var25</td>
<td>0.000000</td>
<td>2.390818</td>
<td>97.609182</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>saldo_var31</td>
<td>0.000000</td>
<td>0.369968</td>
<td>99.630032</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">59</td>
<td>saldo_medio_var44_ult3</td>
<td>0.000000</td>
<td>0.187451</td>
<td>99.812549</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>saldo_var44</td>
<td>0.000000</td>
<td>0.172652</td>
<td>99.827348</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>saldo_var32</td>
<td>0.000000</td>
<td>0.106880</td>
<td>99.893120</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>saldo_var33</td>
<td>0.000000</td>
<td>0.054262</td>
<td>99.945738</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>saldo_var34</td>
<td>0.000000</td>
<td>0.003289</td>
<td>99.996711</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>saldo_var37</td>
<td>0.000000</td>
<td>6.560773</td>
<td>93.439227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>saldo_var40</td>
<td>0.000000</td>
<td>0.353525</td>
<td>99.646475</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>saldo_medio_var17_hace2</td>
<td>0.001644</td>
<td>0.118390</td>
<td>99.879966</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>saldo_medio_var8_hace2</td>
<td>0.003289</td>
<td>1.826822</td>
<td>98.169890</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>saldo_medio_var5_hace3</td>
<td>0.006577</td>
<td>61.002039</td>
<td>38.991384</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>saldo_medio_var8_ult3</td>
<td>0.009866</td>
<td>2.884109</td>
<td>97.106025</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>saldo_medio_var8_ult1</td>
<td>0.016443</td>
<td>2.877532</td>
<td>97.106025</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>saldo_medio_var5_ult3</td>
<td>0.029597</td>
<td>67.551302</td>
<td>32.419100</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>saldo_var8</td>
<td>0.029597</td>
<td>2.826559</td>
<td>97.143844</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>saldo_medio_var5_hace2</td>
<td>0.034530</td>
<td>69.422520</td>
<td>30.542949</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>saldo_medio_var5_ult1</td>
<td>0.060839</td>
<td>67.520061</td>
<td>32.419100</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>saldo_var5</td>
<td>0.138122</td>
<td>66.257235</td>
<td>33.604644</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>saldo_var30</td>
<td>0.164430</td>
<td>73.145225</td>
<td>26.690345</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>saldo_var42</td>
<td>0.166075</td>
<td>71.191792</td>
<td>28.642134</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="feature-engineering" class="level4">
<h4 class="anchored" data-anchor-id="feature-engineering">Feature engineering</h4>
<section id="contagem-de-colunas-diferentes-de-0" class="level5">
<h5 class="anchored" data-anchor-id="contagem-de-colunas-diferentes-de-0">Contagem de colunas diferentes de 0</h5>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>anzc_saldo <span class="op">=</span> AddNonZeroCount(prefix<span class="op">=</span><span class="st">"saldo"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>anzc_saldo <span class="op">=</span> anzc_saldo.fit(df)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anzc_saldo.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"non_zero_count_saldo"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df[col],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span>df[<span class="st">"TARGET"</span>],</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">15</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-13-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="soma-total-das-colunas" class="level5">
<h5 class="anchored" data-anchor-id="soma-total-das-colunas">Soma total das colunas</h5>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cs_saldo <span class="op">=</span> CustomSum(prefix<span class="op">=</span><span class="st">"saldo"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cs_saldo <span class="op">=</span> cs_saldo.fit(df)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> cs_saldo.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"sum_of_saldo"</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>min_sum <span class="op">=</span> df[col].<span class="bu">min</span>()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df[col].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.log(x<span class="op">+</span><span class="dv">1</span><span class="op">-</span>min_sum)),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span>df[<span class="st">"TARGET"</span>],</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">10</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="imp" class="level3">
<h3 class="anchored" data-anchor-id="imp">Imp</h3>
<p>Assumindo que “imp” se deriva de “imposición”, ou seja, algum tipo de taxa, com caracteríticas semelhantes às descritas no subset de “saldo”(com excessão de valores negativos, que aqui não existem), também partimos do pressuposto de que estas são variáveis numéricas. Foram criadas as mesmas colunas que no subset de “saldo”, com exceção da coluna de saldo médio por produto.</p>
<p>Neste caso, nenhuma das variáveis criadas parece ter poder de discriminação.</p>
<section id="verificações-generalizadas-1" class="level4">
<h4 class="anchored" data-anchor-id="verificações-generalizadas-1">Verificações generalizadas</h4>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>imp_cols <span class="op">=</span> [</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col.startswith(<span class="st">"imp"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>df[imp_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">imp_ent_var16_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var40_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var40_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var41_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var41_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var39_ult1</th>
<th data-quarto-table-cell-role="th">imp_sal_var16_ult1</th>
<th data-quarto-table-cell-role="th">imp_amort_var18_ult1</th>
<th data-quarto-table-cell-role="th">imp_amort_var34_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var13_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var13_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var17_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var17_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var33_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var33_ult1</th>
<th data-quarto-table-cell-role="th">imp_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">imp_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">imp_compra_var44_hace3</th>
<th data-quarto-table-cell-role="th">imp_compra_var44_ult1</th>
<th data-quarto-table-cell-role="th">imp_reemb_var13_ult1</th>
<th data-quarto-table-cell-role="th">imp_reemb_var17_hace3</th>
<th data-quarto-table-cell-role="th">imp_reemb_var17_ult1</th>
<th data-quarto-table-cell-role="th">imp_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">imp_trans_var37_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_in_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_in_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_out_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_in_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_in_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_out_ult1</th>
<th data-quarto-table-cell-role="th">imp_venta_var44_hace3</th>
<th data-quarto-table-cell-role="th">imp_venta_var44_ult1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.00000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>81.239989</td>
<td>72.185307</td>
<td>119.169036</td>
<td>3.164183</td>
<td>5.748708</td>
<td>0.406672</td>
<td>0.566005</td>
<td>2.919893</td>
<td>69.021124</td>
<td>113.420328</td>
<td>67.706449</td>
<td>111.796809</td>
<td>137.324003</td>
<td>68.113121</td>
<td>112.362815</td>
<td>140.243896</td>
<td>4.13353</td>
<td>0.258021</td>
<td>0.022564</td>
<td>2848.155970</td>
<td>631.587649</td>
<td>1.197763e+02</td>
<td>34.288115</td>
<td>2.484215</td>
<td>0.034530</td>
<td>3.401817</td>
<td>1.480680e+02</td>
<td>11.881684</td>
<td>1.416635e+02</td>
<td>48.352820</td>
<td>0.197763</td>
<td>14.439225</td>
<td>870.980582</td>
<td>1.934909e+03</td>
<td>2.343510</td>
<td>3.140848</td>
<td>2.339529</td>
<td>3.067888</td>
<td>0.173346</td>
<td>0.049329</td>
<td>1.283605</td>
<td>9.881891e+01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>1364.095864</td>
<td>338.049064</td>
<td>544.262724</td>
<td>86.245545</td>
<td>142.173207</td>
<td>32.490295</td>
<td>38.812040</td>
<td>92.048327</td>
<td>320.203951</td>
<td>514.898002</td>
<td>526.841213</td>
<td>849.182252</td>
<td>700.709527</td>
<td>530.960400</td>
<td>853.740784</td>
<td>715.611960</td>
<td>286.69313</td>
<td>63.630281</td>
<td>4.583333</td>
<td>25562.833133</td>
<td>11407.934951</td>
<td>2.472546e+04</td>
<td>2666.701966</td>
<td>207.221753</td>
<td>4.213975</td>
<td>619.668860</td>
<td>7.036092e+03</td>
<td>936.771518</td>
<td>1.522183e+04</td>
<td>3014.222511</td>
<td>48.770117</td>
<td>1206.329762</td>
<td>13961.760981</td>
<td>2.340013e+04</td>
<td>434.070579</td>
<td>569.043654</td>
<td>399.381114</td>
<td>346.953267</td>
<td>26.398397</td>
<td>12.165006</td>
<td>316.454762</td>
<td>1.260544e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>135000.000000</td>
<td>9968.040000</td>
<td>16086.060000</td>
<td>8237.820000</td>
<td>10351.950000</td>
<td>6600.000000</td>
<td>6600.000000</td>
<td>8237.820000</td>
<td>9177.180000</td>
<td>16086.060000</td>
<td>45990.000000</td>
<td>96870.000000</td>
<td>47598.090000</td>
<td>45990.000000</td>
<td>96870.000000</td>
<td>47598.090000</td>
<td>58048.05000</td>
<td>15691.800000</td>
<td>1096.020000</td>
<td>840000.000000</td>
<td>450000.000000</td>
<td>6.083692e+06</td>
<td>432457.320000</td>
<td>36000.000000</td>
<td>750.000000</td>
<td>145384.920000</td>
<td>1.039260e+06</td>
<td>128874.510000</td>
<td>3.410059e+06</td>
<td>450000.000000</td>
<td>12027.150000</td>
<td>182132.970000</td>
<td>901169.100000</td>
<td>1.608000e+06</td>
<td>96781.440000</td>
<td>133730.580000</td>
<td>69622.290000</td>
<td>49581.270000</td>
<td>5400.000000</td>
<td>3000.000000</td>
<td>78040.590000</td>
<td>2.754476e+06</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df[imp_cols] <span class="op">\</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    .nunique() <span class="op">\</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    .sort_values() <span class="op">\</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    .rename(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        mapper<span class="op">=</span>{</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"index"</span>: <span class="st">"Column"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>: <span class="st">"Number of unique values"</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Number of unique values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>imp_amort_var18_ult1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>imp_trasp_var33_out_ult1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>imp_reemb_var17_hace3</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>imp_venta_var44_hace3</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>imp_amort_var34_ult1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>imp_trasp_var17_in_hace3</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>imp_trasp_var17_out_ult1</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>imp_trasp_var33_in_ult1</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>imp_var7_emit_ult1</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>imp_trasp_var17_in_ult1</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>imp_aport_var33_ult1</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>imp_trasp_var33_in_hace3</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>imp_aport_var33_hace3</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>imp_aport_var17_hace3</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>imp_reemb_var17_ult1</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>imp_op_var40_efect_ult1</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>imp_op_var40_efect_ult3</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>imp_compra_var44_hace3</td>
<td>24</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>imp_reemb_var13_ult1</td>
<td>29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>imp_aport_var17_ult1</td>
<td>35</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>imp_venta_var44_ult1</td>
<td>40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>imp_sal_var16_ult1</td>
<td>57</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>imp_compra_var44_ult1</td>
<td>72</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>imp_var7_recib_ult1</td>
<td>153</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>imp_aport_var13_ult1</td>
<td>160</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>imp_op_var40_ult1</td>
<td>171</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>imp_op_var40_comer_ult1</td>
<td>219</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>imp_op_var40_comer_ult3</td>
<td>262</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>imp_op_var41_efect_ult1</td>
<td>284</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>imp_op_var39_efect_ult1</td>
<td>287</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>imp_aport_var13_hace3</td>
<td>351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>imp_op_var41_efect_ult3</td>
<td>392</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>imp_op_var39_efect_ult3</td>
<td>395</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>imp_ent_var16_ult1</td>
<td>500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>imp_var43_emit_ult1</td>
<td>1956</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>imp_trans_var37_ult1</td>
<td>3194</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>imp_op_var41_comer_ult1</td>
<td>6114</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>imp_op_var39_comer_ult1</td>
<td>6209</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>imp_op_var41_ult1</td>
<td>6565</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>imp_op_var39_ult1</td>
<td>6658</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>imp_op_var41_comer_ult3</td>
<td>7356</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>imp_op_var39_comer_ult3</td>
<td>7456</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="feature-engineering-1" class="level4">
<h4 class="anchored" data-anchor-id="feature-engineering-1">Feature Engineering</h4>
<section id="contagem-de-colunas-diferentes-de-0-1" class="level5">
<h5 class="anchored" data-anchor-id="contagem-de-colunas-diferentes-de-0-1">Contagem de colunas diferentes de 0</h5>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>anzc_imp <span class="op">=</span> AddNonZeroCount(prefix<span class="op">=</span><span class="st">"imp"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>anzc_imp <span class="op">=</span> anzc_imp.fit(df)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anzc_imp.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"non_zero_count_imp"</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    df[col],</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">10</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="soma-total-das-colunas-1" class="level5">
<h5 class="anchored" data-anchor-id="soma-total-das-colunas-1">Soma total das colunas</h5>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>cs_imp <span class="op">=</span> CustomSum(prefix<span class="op">=</span><span class="st">"imp"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cs_imp <span class="op">=</span> cs_imp.fit(df)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> cs_imp.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"sum_of_imp"</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"sum_of_imp"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.log(x <span class="op">+</span> <span class="dv">1</span>)),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">15</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="delta" class="level3">
<h3 class="anchored" data-anchor-id="delta">Delta</h3>
<p>O nome da coluna sugere que seja algum tipo de variação. Assim, também assumimos que se trata de uma variável numérica. Mesmo que haja poucos valores únicos, aqueles que são diferentes de zero são, em geral, negativos ou decimais.</p>
<p>Diferentemente dos demais subconjuntos estudados até o momento, acredita-se haver valores nulos neste subconjunto, mas que foram preenchidos com 9999999999. Todas as colunas deste subconjunto compartilham este valor como valor máximo, sendo que ao removê-lo o maior valor máximo é de 8. Um transformador customizado foi criado para preencher estes valores falsos com <em>np.nan</em>.</p>
<p>Em seguida, foi criado um transformador para contar valores nulos neste subconjunto, mas a variável criada não aparenta ter poder de discriminação, assim como a contagem de não-zeros e a soma total.</p>
<p>Como lidar com valores nulos varia para cada problema e seu respectivo conjunto de dados. O próprio <em>sklearn</em> implementa <em>KNN</em> para preencher campos vazios. Essa abordagem é funcional pois as distâncias dos vizinhos mais próximos de uma determinada observação serão calculadas com base apenas em suas variáveis devidamente preenchidas.</p>
<p>Contudo, o <em>KNNImputer</em> precisa de uma série de preprocessamentos e considerações antes do uso: - Medida de distância razoável para os tipos das variáveis no conjunto de dados. - Pré-processamento cuidadoso, ajustando a escala das variáveis de forma que façam sentido para a medida de distância escolhida. - Tratamento da multicolinearidade, pois variáveis com forte correlação aumentam a distância entre observações sem agregar mais informação.</p>
<p>Um processamento cauteloso dos dados envolveria estudar cada variável individualmente para entender sua distribuição e, então, tomar as decisões necessárias sobre seu preprocessamento. Para esta entrega, optou-se por utilizar modelos baseados em árvores, pois estes não assumem qualquer tipo de distribuição.</p>
<p>A escolha do modelo usado também afeta na decisão de como tratar os valores faltantes. No <em>sklearn</em>, árvores de decisão e modelos de <em>boosting</em> têm uma estratégia própria para lidar com valores faltantes. Em cada nó, os algoritmos encontram o <em>split</em> que minimiza a função de custo desconsiderando valores faltantes. Encontrado este split, os modelos testam em qual dos nós filhos as observações com valores faltantes devem ser alocadas: o nó filho que minimiza a função de custo é o escolhido. Estes modelos também testam se o melhor <em>split</em> é, na verdade, separar faltantes de preenchidos, eliminando também a necessidade de criar uma <em>flag</em> para nulo em determinada coluna.</p>
<p>Contudo, a implementação de florestas aleatórias do <em>sklearn</em> ainda não oferece esta funcionalidade. Neste caso, optou-se por preencher os valores faltantes com a mediana. Dada a distribuição das variáveis (avaliadas pelo <em>df.describe</em> deste prefixo), preencher os dados com a mediana é essencialmente o mesmo que preenche-los com 0, pois são dados esparsos.</p>
<p>Percebe-se também que há correlação entre observações na presença de valores nulos em mais de uma coluna, mas apenas entre variáveis com nomes semelhantes – corroborando a ideia de que muitas das variáveis estão diretamente relacionadas umas com as outras.</p>
<p>Foram criadas variáveis de contagem de nulos, contagem de valores diferentes de zero e soma do subconjunto, sendo que nenhuma delas parece ter poder de discriminação.</p>
<section id="verificações-generalizadas-2" class="level4">
<h4 class="anchored" data-anchor-id="verificações-generalizadas-2">Verificações generalizadas</h4>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>delta_cols <span class="op">=</span> [</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col.startswith(<span class="st">"delta"</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>df[delta_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">delta_imp_amort_var18_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_amort_var34_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_venta_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_venta_var44_1y3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
<td>6.081600e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>1.644304e+05</td>
<td>3.288608e+05</td>
<td>4.817811e+07</td>
<td>5.590634e+06</td>
<td>1.644304e+05</td>
<td>9.701394e+06</td>
<td>5.097343e+06</td>
<td>2.466456e+06</td>
<td>6.577217e+05</td>
<td>4.932912e+05</td>
<td>4.932912e+05</td>
<td>1.644304e+05</td>
<td>6.248356e+06</td>
<td>4.817811e+07</td>
<td>5.590634e+06</td>
<td>1.644304e+05</td>
<td>9.701394e+06</td>
<td>6.248356e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>4.055002e+07</td>
<td>5.734592e+07</td>
<td>6.924362e+08</td>
<td>2.363811e+08</td>
<td>4.055002e+07</td>
<td>3.113221e+08</td>
<td>2.257173e+08</td>
<td>1.570315e+08</td>
<td>8.109804e+07</td>
<td>7.023354e+07</td>
<td>7.023354e+07</td>
<td>4.055002e+07</td>
<td>2.498911e+08</td>
<td>6.924362e+08</td>
<td>2.363811e+08</td>
<td>4.055002e+07</td>
<td>3.113221e+08</td>
<td>2.498911e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>0.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>0.000000e+00</td>
<td>-1.000000e+00</td>
<td>0.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df[delta_cols] <span class="op">\</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    .nunique() <span class="op">\</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    .sort_values() <span class="op">\</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    .rename(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        mapper<span class="op">=</span>{</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"index"</span>: <span class="st">"Column"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>: <span class="st">"Number of unique values"</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Number of unique values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>delta_imp_amort_var18_1y3</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>delta_imp_amort_var34_1y3</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>delta_imp_trasp_var33_out_1y3</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>delta_imp_trasp_var17_out_1y3</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>delta_imp_reemb_var13_1y3</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>delta_num_aport_var17_1y3</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>delta_imp_trasp_var33_in_1y3</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>delta_imp_trasp_var17_in_1y3</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>delta_imp_reemb_var17_1y3</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>delta_imp_aport_var17_1y3</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>delta_imp_venta_var44_1y3</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>delta_num_aport_var13_1y3</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>delta_num_aport_var33_1y3</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>delta_num_venta_var44_1y3</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>delta_num_compra_var44_1y3</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>delta_imp_aport_var33_1y3</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>delta_imp_compra_var44_1y3</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>delta_imp_aport_var13_1y3</td>
<td>23</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ci_delta <span class="op">=</span> CustomImputer(prefix<span class="op">=</span><span class="st">"delta"</span>, to_replace<span class="op">=</span><span class="dv">9999999999</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>ci_delta <span class="op">=</span> ci_delta.fit(df)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ci_delta.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df[delta_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">delta_imp_amort_var18_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_amort_var34_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_venta_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_venta_var44_1y3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>60815.0</td>
<td>60814.0</td>
<td>60523.000000</td>
<td>60782.000000</td>
<td>60815.000000</td>
<td>60757.000000</td>
<td>60785.0</td>
<td>60801.000000</td>
<td>60812.000000</td>
<td>60813.0</td>
<td>60813.000000</td>
<td>60815.0</td>
<td>60778.000000</td>
<td>60523.000000</td>
<td>60782.000000</td>
<td>60815.000000</td>
<td>60757.00000</td>
<td>60778.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.0</td>
<td>0.0</td>
<td>-0.021865</td>
<td>-0.000206</td>
<td>-0.000265</td>
<td>-0.000008</td>
<td>0.0</td>
<td>-0.000016</td>
<td>-0.000033</td>
<td>0.0</td>
<td>-0.000082</td>
<td>0.0</td>
<td>0.000073</td>
<td>-0.022091</td>
<td>-0.000230</td>
<td>-0.000222</td>
<td>0.00003</td>
<td>0.000115</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.0</td>
<td>0.0</td>
<td>0.151406</td>
<td>0.016350</td>
<td>0.015977</td>
<td>0.035928</td>
<td>0.0</td>
<td>0.004056</td>
<td>0.005735</td>
<td>0.0</td>
<td>0.009067</td>
<td>0.0</td>
<td>0.022345</td>
<td>0.147205</td>
<td>0.015175</td>
<td>0.014759</td>
<td>0.02945</td>
<td>0.032703</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.0</td>
<td>0.0</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>0.0</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>0.0</td>
<td>-1.000000</td>
<td>0.0</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.00000</td>
<td>-1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.0</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.0</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.0</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>0.0</td>
<td>0.0</td>
<td>5.500000</td>
<td>1.500000</td>
<td>0.000000</td>
<td>6.267608</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.0</td>
<td>5.417098</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>4.00000</td>
<td>8.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mno.matrix(df[delta_cols])</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>mno.dendrogram(df[delta_cols])</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-26-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="feature-engineering-2" class="level4">
<h4 class="anchored" data-anchor-id="feature-engineering-2">Feature Engineering</h4>
<section id="contagem-de-nulos" class="level5">
<h5 class="anchored" data-anchor-id="contagem-de-nulos">Contagem de nulos</h5>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>anc_delta <span class="op">=</span> AddNoneCount(prefix<span class="op">=</span><span class="st">"delta"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>anc_delta <span class="op">=</span> anc_delta.fit(df)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anc_delta.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"none_count_delta"</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    df[col],</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">5</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-28-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="contagem-de-colunas-diferentes-de-0-2" class="level5">
<h5 class="anchored" data-anchor-id="contagem-de-colunas-diferentes-de-0-2">Contagem de colunas diferentes de 0</h5>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>anzc_delta <span class="op">=</span> AddNonZeroCount(prefix<span class="op">=</span><span class="st">"delta"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>anzc_delta <span class="op">=</span> anzc_delta.fit(df)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anzc_delta.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"non_zero_count_delta"</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    df[col],</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">7</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="soma-total-das-colunas-2" class="level5">
<h5 class="anchored" data-anchor-id="soma-total-das-colunas-2">Soma total das colunas</h5>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cs_delta <span class="op">=</span> CustomSum(prefix<span class="op">=</span><span class="st">"delta"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>cs_delta <span class="op">=</span> cs_delta.fit(df)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> cs_delta.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"sum_of_delta"</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>min_sum <span class="op">=</span> df[col].<span class="bu">min</span>()</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    df[col],</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">8</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="ind" class="level3">
<h3 class="anchored" data-anchor-id="ind">Ind</h3>
<p>Estas variáveis são compostas exclusivamente por valores de 0 e 1, ou seja, são variáveis binárias.</p>
<p>Neste caso, como as variáveis já são binarizadas, a análise é mais simples. Não há nenhum outlier que chame a atenção ou levante suspeitas de ser, na verdade, algum valor faltante.</p>
<p>Foi criada a coluna de contagem de valores diferentes de zero e percebe-se que observações com “TARGET” = 1 se concentram em valores mais baixos de contagem.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ind_cols <span class="op">=</span> [</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col.startswith(<span class="st">"ind"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>df[ind_cols].describe().loc[[<span class="st">"min"</span>, <span class="st">"max"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ind_var1_0</th>
<th data-quarto-table-cell-role="th">ind_var1</th>
<th data-quarto-table-cell-role="th">ind_var5_0</th>
<th data-quarto-table-cell-role="th">ind_var5</th>
<th data-quarto-table-cell-role="th">ind_var8_0</th>
<th data-quarto-table-cell-role="th">ind_var8</th>
<th data-quarto-table-cell-role="th">ind_var12_0</th>
<th data-quarto-table-cell-role="th">ind_var12</th>
<th data-quarto-table-cell-role="th">ind_var13_0</th>
<th data-quarto-table-cell-role="th">ind_var13_corto_0</th>
<th data-quarto-table-cell-role="th">ind_var13_corto</th>
<th data-quarto-table-cell-role="th">ind_var13_largo_0</th>
<th data-quarto-table-cell-role="th">ind_var13_largo</th>
<th data-quarto-table-cell-role="th">ind_var13</th>
<th data-quarto-table-cell-role="th">ind_var14_0</th>
<th data-quarto-table-cell-role="th">ind_var14</th>
<th data-quarto-table-cell-role="th">ind_var17_0</th>
<th data-quarto-table-cell-role="th">ind_var17</th>
<th data-quarto-table-cell-role="th">ind_var18</th>
<th data-quarto-table-cell-role="th">ind_var19</th>
<th data-quarto-table-cell-role="th">ind_var20_0</th>
<th data-quarto-table-cell-role="th">ind_var20</th>
<th data-quarto-table-cell-role="th">ind_var24_0</th>
<th data-quarto-table-cell-role="th">ind_var24</th>
<th data-quarto-table-cell-role="th">ind_var25_cte</th>
<th data-quarto-table-cell-role="th">ind_var26_cte</th>
<th data-quarto-table-cell-role="th">ind_var26</th>
<th data-quarto-table-cell-role="th">ind_var25</th>
<th data-quarto-table-cell-role="th">ind_var29_0</th>
<th data-quarto-table-cell-role="th">ind_var29</th>
<th data-quarto-table-cell-role="th">ind_var30_0</th>
<th data-quarto-table-cell-role="th">ind_var30</th>
<th data-quarto-table-cell-role="th">ind_var31_0</th>
<th data-quarto-table-cell-role="th">ind_var31</th>
<th data-quarto-table-cell-role="th">ind_var32_cte</th>
<th data-quarto-table-cell-role="th">ind_var32</th>
<th data-quarto-table-cell-role="th">ind_var33_0</th>
<th data-quarto-table-cell-role="th">ind_var33</th>
<th data-quarto-table-cell-role="th">ind_var34</th>
<th data-quarto-table-cell-role="th">ind_var37_cte</th>
<th data-quarto-table-cell-role="th">ind_var37</th>
<th data-quarto-table-cell-role="th">ind_var39_0</th>
<th data-quarto-table-cell-role="th">ind_var40_0</th>
<th data-quarto-table-cell-role="th">ind_var41_0</th>
<th data-quarto-table-cell-role="th">ind_var39</th>
<th data-quarto-table-cell-role="th">ind_var44_0</th>
<th data-quarto-table-cell-role="th">ind_var44</th>
<th data-quarto-table-cell-role="th">ind_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">ind_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">ind_var10_ult1</th>
<th data-quarto-table-cell-role="th">ind_var10cte_ult1</th>
<th data-quarto-table-cell-role="th">ind_var9_cte_ult1</th>
<th data-quarto-table-cell-role="th">ind_var9_ult1</th>
<th data-quarto-table-cell-role="th">ind_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">ind_var43_recib_ult1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df[ind_cols].nunique().<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>anzc_ind <span class="op">=</span> AddNonZeroCount(prefix<span class="op">=</span><span class="st">"ind"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>anzc_ind <span class="op">=</span> anzc_ind.fit(df)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anzc_ind.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"non_zero_count_ind"</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    df[col],</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">15</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-36-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="num" class="level3">
<h3 class="anchored" data-anchor-id="num">Num</h3>
<p>O prefixo indica que as variáveis sejam uma contagem (“número de vendas”, “número de recibos”). O fato de não haver nenhum valor negativo nem nenhum número decimal corrobora com esta ideia. Também não há um valor exorbitante comum entre as colunas, indicando que estes dados não tiveram valores faltantes preenchidos artificialmente.</p>
<p>Percebe-se que tanto na contagem de valores diferentes de zero quanto na soma do subconjunto, clientes insatisfeitos se concentram de forma diferente de clientes satisfeitos.</p>
<section id="verificações-generalizadas-3" class="level4">
<h4 class="anchored" data-anchor-id="verificações-generalizadas-3">Verificações generalizadas</h4>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>num_cols <span class="op">=</span> [</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col.startswith(<span class="st">"num"</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>df[num_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">num_var1_0</th>
<th data-quarto-table-cell-role="th">num_var1</th>
<th data-quarto-table-cell-role="th">num_var4</th>
<th data-quarto-table-cell-role="th">num_var5_0</th>
<th data-quarto-table-cell-role="th">num_var5</th>
<th data-quarto-table-cell-role="th">num_var8_0</th>
<th data-quarto-table-cell-role="th">num_var8</th>
<th data-quarto-table-cell-role="th">num_var12_0</th>
<th data-quarto-table-cell-role="th">num_var12</th>
<th data-quarto-table-cell-role="th">num_var13_0</th>
<th data-quarto-table-cell-role="th">num_var13_corto_0</th>
<th data-quarto-table-cell-role="th">num_var13_corto</th>
<th data-quarto-table-cell-role="th">num_var13_largo_0</th>
<th data-quarto-table-cell-role="th">num_var13_largo</th>
<th data-quarto-table-cell-role="th">num_var13</th>
<th data-quarto-table-cell-role="th">num_var14_0</th>
<th data-quarto-table-cell-role="th">num_var14</th>
<th data-quarto-table-cell-role="th">num_var17_0</th>
<th data-quarto-table-cell-role="th">num_var17</th>
<th data-quarto-table-cell-role="th">num_var18</th>
<th data-quarto-table-cell-role="th">num_var20_0</th>
<th data-quarto-table-cell-role="th">num_var20</th>
<th data-quarto-table-cell-role="th">num_var24_0</th>
<th data-quarto-table-cell-role="th">num_var24</th>
<th data-quarto-table-cell-role="th">num_var26</th>
<th data-quarto-table-cell-role="th">num_var25</th>
<th data-quarto-table-cell-role="th">num_op_var40_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var40_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var40_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var41_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var41_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var39_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var39_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_ult3</th>
<th data-quarto-table-cell-role="th">num_var29_0</th>
<th data-quarto-table-cell-role="th">num_var29</th>
<th data-quarto-table-cell-role="th">num_var30_0</th>
<th data-quarto-table-cell-role="th">num_var30</th>
<th data-quarto-table-cell-role="th">num_var31_0</th>
<th data-quarto-table-cell-role="th">num_var31</th>
<th data-quarto-table-cell-role="th">num_var32</th>
<th data-quarto-table-cell-role="th">num_var33_0</th>
<th data-quarto-table-cell-role="th">num_var33</th>
<th data-quarto-table-cell-role="th">num_var34</th>
<th data-quarto-table-cell-role="th">num_var35</th>
<th data-quarto-table-cell-role="th">num_var37_med_ult2</th>
<th data-quarto-table-cell-role="th">num_var37</th>
<th data-quarto-table-cell-role="th">num_var39_0</th>
<th data-quarto-table-cell-role="th">num_var40_0</th>
<th data-quarto-table-cell-role="th">num_var41_0</th>
<th data-quarto-table-cell-role="th">num_var39</th>
<th data-quarto-table-cell-role="th">num_var42_0</th>
<th data-quarto-table-cell-role="th">num_var42</th>
<th data-quarto-table-cell-role="th">num_var44_0</th>
<th data-quarto-table-cell-role="th">num_var44</th>
<th data-quarto-table-cell-role="th">num_aport_var13_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var13_ult1</th>
<th data-quarto-table-cell-role="th">num_aport_var17_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var17_ult1</th>
<th data-quarto-table-cell-role="th">num_aport_var33_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var33_ult1</th>
<th data-quarto-table-cell-role="th">num_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">num_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">num_compra_var44_hace3</th>
<th data-quarto-table-cell-role="th">num_compra_var44_ult1</th>
<th data-quarto-table-cell-role="th">num_ent_var16_ult1</th>
<th data-quarto-table-cell-role="th">num_var22_hace2</th>
<th data-quarto-table-cell-role="th">num_var22_hace3</th>
<th data-quarto-table-cell-role="th">num_var22_ult1</th>
<th data-quarto-table-cell-role="th">num_var22_ult3</th>
<th data-quarto-table-cell-role="th">num_med_var22_ult3</th>
<th data-quarto-table-cell-role="th">num_med_var45_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var5_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var8_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var12_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var13_corto_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var13_largo_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var17_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var29_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var33_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var39_vig_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var44_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var40_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var40_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_reemb_var13_ult1</th>
<th data-quarto-table-cell-role="th">num_reemb_var17_hace3</th>
<th data-quarto-table-cell-role="th">num_reemb_var17_ult1</th>
<th data-quarto-table-cell-role="th">num_sal_var16_ult1</th>
<th data-quarto-table-cell-role="th">num_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">num_var43_recib_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var11_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_in_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_in_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_out_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_in_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_in_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_out_ult1</th>
<th data-quarto-table-cell-role="th">num_venta_var44_hace3</th>
<th data-quarto-table-cell-role="th">num_venta_var44_ult1</th>
<th data-quarto-table-cell-role="th">num_var45_hace2</th>
<th data-quarto-table-cell-role="th">num_var45_hace3</th>
<th data-quarto-table-cell-role="th">num_var45_ult1</th>
<th data-quarto-table-cell-role="th">num_var45_ult3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.033445</td>
<td>0.010754</td>
<td>1.080620</td>
<td>2.895570</td>
<td>1.999852</td>
<td>0.098856</td>
<td>0.085685</td>
<td>0.211770</td>
<td>0.138664</td>
<td>0.167719</td>
<td>0.129834</td>
<td>0.124260</td>
<td>0.037885</td>
<td>0.035764</td>
<td>0.160024</td>
<td>0.072563</td>
<td>0.016081</td>
<td>0.012727</td>
<td>0.009521</td>
<td>0.000049</td>
<td>0.010359</td>
<td>0.007449</td>
<td>0.128848</td>
<td>0.115134</td>
<td>0.089532</td>
<td>0.085635</td>
<td>0.020472</td>
<td>0.001135</td>
<td>0.054953</td>
<td>0.076559</td>
<td>1.618587</td>
<td>0.092443</td>
<td>2.875444</td>
<td>4.586474</td>
<td>1.639059</td>
<td>0.093577</td>
<td>2.930397</td>
<td>4.663033</td>
<td>0.000395</td>
<td>0.000099</td>
<td>3.374309</td>
<td>2.384323</td>
<td>0.020768</td>
<td>0.016476</td>
<td>0.003897</td>
<td>0.002269</td>
<td>0.001776</td>
<td>0.000099</td>
<td>3.302733</td>
<td>0.265341</td>
<td>0.420827</td>
<td>2.723954</td>
<td>0.033297</td>
<td>2.699191</td>
<td>0.010606</td>
<td>3.206590</td>
<td>2.219219</td>
<td>0.005772</td>
<td>0.005180</td>
<td>0.076263</td>
<td>0.017956</td>
<td>0.001332</td>
<td>0.003404</td>
<td>0.001036</td>
<td>0.000296</td>
<td>0.000148</td>
<td>0.010704</td>
<td>0.001677</td>
<td>0.008534</td>
<td>0.182715</td>
<td>1.305495</td>
<td>1.187253</td>
<td>0.566397</td>
<td>3.059146</td>
<td>0.641131</td>
<td>4.012382</td>
<td>1.980466</td>
<td>0.053522</td>
<td>0.102358</td>
<td>0.098625</td>
<td>0.017841</td>
<td>0.003058</td>
<td>0.000132</td>
<td>0.001348</td>
<td>1.591769</td>
<td>0.003519</td>
<td>2.198944</td>
<td>3.608573</td>
<td>0.067778</td>
<td>0.126233</td>
<td>0.002220</td>
<td>0.003404</td>
<td>2.131166</td>
<td>3.482340</td>
<td>0.720649</td>
<td>1.213990</td>
<td>0.722869</td>
<td>1.217393</td>
<td>0.001529</td>
<td>0.000049</td>
<td>0.001184</td>
<td>0.005032</td>
<td>0.393745</td>
<td>0.814621</td>
<td>0.119771</td>
<td>0.000148</td>
<td>0.000197</td>
<td>0.000148</td>
<td>0.000247</td>
<td>0.000197</td>
<td>0.000049</td>
<td>0.000099</td>
<td>0.005278</td>
<td>5.387086</td>
<td>3.870856</td>
<td>4.360596</td>
<td>13.618538</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.315459</td>
<td>0.179293</td>
<td>0.911055</td>
<td>0.656612</td>
<td>1.431956</td>
<td>0.535812</td>
<td>0.499716</td>
<td>0.913433</td>
<td>0.639458</td>
<td>0.743956</td>
<td>0.617682</td>
<td>0.598279</td>
<td>0.404259</td>
<td>0.380509</td>
<td>0.711733</td>
<td>0.642269</td>
<td>0.224397</td>
<td>0.383327</td>
<td>0.300551</td>
<td>0.012165</td>
<td>0.175985</td>
<td>0.149302</td>
<td>0.611630</td>
<td>0.577096</td>
<td>0.621830</td>
<td>0.608066</td>
<td>0.946549</td>
<td>0.198776</td>
<td>1.892900</td>
<td>2.683734</td>
<td>7.411964</td>
<td>1.197151</td>
<td>11.027480</td>
<td>17.103055</td>
<td>7.483482</td>
<td>1.213455</td>
<td>11.258438</td>
<td>17.398545</td>
<td>0.034406</td>
<td>0.017204</td>
<td>1.349025</td>
<td>1.642766</td>
<td>0.424575</td>
<td>0.340224</td>
<td>0.125776</td>
<td>0.095761</td>
<td>0.078819</td>
<td>0.017204</td>
<td>2.871679</td>
<td>1.628273</td>
<td>2.221866</td>
<td>1.139441</td>
<td>0.314770</td>
<td>1.106594</td>
<td>0.178060</td>
<td>0.966158</td>
<td>1.499252</td>
<td>0.132580</td>
<td>0.124548</td>
<td>0.555441</td>
<td>0.296445</td>
<td>0.095003</td>
<td>0.171576</td>
<td>0.071962</td>
<td>0.034407</td>
<td>0.021070</td>
<td>0.234072</td>
<td>0.094216</td>
<td>0.346334</td>
<td>0.987879</td>
<td>3.477569</td>
<td>3.256957</td>
<td>2.131784</td>
<td>6.245634</td>
<td>1.848512</td>
<td>10.849619</td>
<td>1.298516</td>
<td>0.334357</td>
<td>0.488120</td>
<td>0.485360</td>
<td>0.216086</td>
<td>0.078571</td>
<td>0.015172</td>
<td>0.059581</td>
<td>0.719764</td>
<td>0.086330</td>
<td>9.225778</td>
<td>15.001526</td>
<td>2.060719</td>
<td>4.093252</td>
<td>0.138151</td>
<td>0.200972</td>
<td>8.908613</td>
<td>14.300298</td>
<td>3.227072</td>
<td>5.183695</td>
<td>3.237633</td>
<td>5.203002</td>
<td>0.067715</td>
<td>0.012165</td>
<td>0.104642</td>
<td>0.157597</td>
<td>2.274789</td>
<td>3.551331</td>
<td>1.193239</td>
<td>0.027202</td>
<td>0.024329</td>
<td>0.021070</td>
<td>0.027201</td>
<td>0.029798</td>
<td>0.012165</td>
<td>0.017204</td>
<td>0.294187</td>
<td>14.409590</td>
<td>10.326959</td>
<td>14.260227</td>
<td>33.061046</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>2.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>2.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>12.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>6.000000</td>
<td>3.000000</td>
<td>7.000000</td>
<td>15.000000</td>
<td>15.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>111.000000</td>
<td>15.000000</td>
<td>15.000000</td>
<td>6.000000</td>
<td>6.000000</td>
<td>15.000000</td>
<td>15.000000</td>
<td>15.000000</td>
<td>111.000000</td>
<td>12.000000</td>
<td>36.000000</td>
<td>27.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>9.000000</td>
<td>6.000000</td>
<td>33.000000</td>
<td>33.000000</td>
<td>117.000000</td>
<td>48.000000</td>
<td>234.000000</td>
<td>351.000000</td>
<td>249.000000</td>
<td>81.000000</td>
<td>468.000000</td>
<td>468.000000</td>
<td>249.000000</td>
<td>81.000000</td>
<td>468.000000</td>
<td>468.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>114.000000</td>
<td>33.000000</td>
<td>36.000000</td>
<td>27.000000</td>
<td>6.000000</td>
<td>12.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>36.000000</td>
<td>90.000000</td>
<td>111.000000</td>
<td>33.000000</td>
<td>6.000000</td>
<td>33.000000</td>
<td>3.000000</td>
<td>114.000000</td>
<td>18.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>24.000000</td>
<td>30.000000</td>
<td>12.000000</td>
<td>21.000000</td>
<td>12.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>24.000000</td>
<td>9.000000</td>
<td>39.000000</td>
<td>60.000000</td>
<td>123.000000</td>
<td>108.000000</td>
<td>96.000000</td>
<td>234.000000</td>
<td>78.000000</td>
<td>267.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>2.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>438.000000</td>
<td>600.000000</td>
<td>210.000000</td>
<td>582.000000</td>
<td>24.000000</td>
<td>24.000000</td>
<td>438.000000</td>
<td>438.000000</td>
<td>90.000000</td>
<td>156.000000</td>
<td>90.000000</td>
<td>156.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>21.000000</td>
<td>15.000000</td>
<td>180.000000</td>
<td>264.000000</td>
<td>93.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>39.000000</td>
<td>342.000000</td>
<td>333.000000</td>
<td>510.000000</td>
<td>801.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df[num_cols] <span class="op">\</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    .nunique() <span class="op">\</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    .nlargest(<span class="dv">10</span>) <span class="op">\</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    .rename(</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>        mapper<span class="op">=</span>{</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"index"</span>: <span class="st">"Column"</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>: <span class="st">"Number of unique values"</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Number of unique values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>num_var45_ult3</td>
<td>160</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>num_op_var39_ult3</td>
<td>96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>num_op_var41_ult3</td>
<td>93</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>num_op_var39_comer_ult3</td>
<td>89</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>num_var45_ult1</td>
<td>89</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>num_op_var41_comer_ult3</td>
<td>86</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>num_var45_hace2</td>
<td>80</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>num_op_var39_ult1</td>
<td>67</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>num_med_var45_ult3</td>
<td>66</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>num_op_var41_ult1</td>
<td>64</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>nfloat <span class="op">=</span> df[num_cols].applymap(<span class="kw">lambda</span> x: <span class="dv">0</span> <span class="cf">if</span> x<span class="op">%</span><span class="dv">1</span> <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">1</span>).<span class="bu">sum</span>().<span class="bu">sum</span>()</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Contagem de números decimais: </span><span class="sc">{</span>nfloat<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Contagem de números decimais: 0</code></pre>
</div>
</div>
</section>
<section id="feature-engineering-3" class="level4">
<h4 class="anchored" data-anchor-id="feature-engineering-3">Feature Engineering</h4>
<section id="contagem-de-colunas-diferentes-de-0-3" class="level5">
<h5 class="anchored" data-anchor-id="contagem-de-colunas-diferentes-de-0-3">Contagem de colunas diferentes de 0</h5>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>anzc_num <span class="op">=</span> AddNonZeroCount(prefix<span class="op">=</span><span class="st">"num"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>anzc_num <span class="op">=</span> anzc_num.fit(df)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anzc_num.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"non_zero_count_num"</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    df[col],</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">16</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-41-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="soma-total-das-colunas-3" class="level5">
<h5 class="anchored" data-anchor-id="soma-total-das-colunas-3">Soma total das colunas</h5>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>cs_num <span class="op">=</span> CustomSum(prefix<span class="op">=</span><span class="st">"num"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>cs_num <span class="op">=</span> cs_num.fit(df)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> cs_num.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"sum_of_num"</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    df[col].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.log(x <span class="op">+</span> <span class="dv">1</span>)),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">16</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-43-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="demais-variáveis" class="level3">
<h3 class="anchored" data-anchor-id="demais-variáveis">Demais variáveis</h3>
<p>Por fim, foram encontradas variáveis sem prefixos. Como são poucas variáveis, optou-se por tratá-las uma a uma, pois sem prefixo não podemos assumir que se tratam de grandezas semelhantes nem que são do mesmo tipo (contínua, discreta, categórica, etc).</p>
<p>O ideal seria abordar todas as variáveis desta forma – não apenas individualmente, mas também tentando encontrar relações entre as variáveis.</p>
<section id="verificações-generalizadas-4" class="level4">
<h4 class="anchored" data-anchor-id="verificações-generalizadas-4">Verificações generalizadas</h4>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>remaining_cols <span class="op">=</span> [</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>        (col <span class="kw">not</span> <span class="kw">in</span> imp_cols)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (col <span class="kw">not</span> <span class="kw">in</span> ind_cols)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (col <span class="kw">not</span> <span class="kw">in</span> num_cols)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (col <span class="kw">not</span> <span class="kw">in</span> saldo_cols)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (col <span class="kw">not</span> <span class="kw">in</span> delta_cols)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (<span class="st">"count"</span> <span class="kw">not</span> <span class="kw">in</span> col)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (<span class="st">"sum"</span> <span class="kw">not</span> <span class="kw">in</span> col)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (<span class="st">"avg"</span> <span class="kw">not</span> <span class="kw">in</span> col)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">"TARGET"</span>, <span class="st">"ID"</span>])</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df[remaining_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">var3</th>
<th data-quarto-table-cell-role="th">var15</th>
<th data-quarto-table-cell-role="th">var36</th>
<th data-quarto-table-cell-role="th">var21</th>
<th data-quarto-table-cell-role="th">var38</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>60816.000000</td>
<td>6.081600e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>-1526.496991</td>
<td>33.218742</td>
<td>40.507054</td>
<td>31.871547</td>
<td>1.176408e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>39075.501176</td>
<td>12.947363</td>
<td>47.375790</td>
<td>393.703492</td>
<td>1.895319e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-999999.000000</td>
<td>5.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>5.163750e+03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>2.000000</td>
<td>23.000000</td>
<td>2.000000</td>
<td>0.000000</td>
<td>6.777529e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>2.000000</td>
<td>28.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>1.065147e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>2.000000</td>
<td>40.000000</td>
<td>99.000000</td>
<td>0.000000</td>
<td>1.187928e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>238.000000</td>
<td>105.000000</td>
<td>99.000000</td>
<td>30000.000000</td>
<td>2.203474e+07</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df[remaining_cols] <span class="op">\</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    .nunique() <span class="op">\</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    .rename(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>        mapper<span class="op">=</span>{</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"index"</span>: <span class="st">"Column"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>: <span class="st">"Number of unique values"</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Number of unique values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>var3</td>
<td>192</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>var15</td>
<td>100</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>var36</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>var21</td>
<td>22</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>var38</td>
<td>46671</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="var3" class="level4">
<h4 class="anchored" data-anchor-id="var3">var3</h4>
<p>Esta variável possui 192 valores únicos, incluindo um único valor negativo de -999999 que se repete 93 vezes. Este valor foi considerado como faltante e substituído por “None”, pelo motivo explicado na seção do prefixo “delta”. Não há números decimais, apenas inteiros. Assume-se que é uma variável de contagem. A variável não parece ter poder de discriminação, embora a concentração de clientes insatisfeitos seja menor para valores nulos. Para a floresta aleatória, foi criada uma outra coluna indicadora para valor faltante desta variável.</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"var3"</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>nfloat <span class="op">=</span> df[col].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">0</span> <span class="cf">if</span> x<span class="op">%</span><span class="dv">1</span> <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Contagem de números decimais: </span><span class="sc">{</span>nfloat<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Contagem de números decimais: 0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ci_var3 <span class="op">=</span> CustomImputer(prefix<span class="op">=</span><span class="st">"var3"</span>, to_replace<span class="op">=-</span><span class="dv">999999</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>ci_var3 <span class="op">=</span> ci_var3.fit(df)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ci_var3.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    df[col].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.log(x<span class="op">+</span><span class="dv">1</span>)),</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">5</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-49-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">\</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    .assign(null <span class="op">=</span> df[col].isna().astype(<span class="bu">int</span>)) <span class="op">\</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"null"</span>)[<span class="st">"TARGET"</span>] <span class="op">\</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    .value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">\</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    .unstack()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">null</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.960410</td>
<td>0.039590</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.978495</td>
<td>0.021505</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="var15" class="level4">
<h4 class="anchored" data-anchor-id="var15">var15</h4>
<p>Esta variável possui 100 valores únicos entre 5 e 105. Não há valores decimais. Todas estas características levam a acreditar que esta variável se trata da idade do cliente – o que faz algum sentido, dada a escassez de clientes menores de 18 anos, que provavelmente é resultado de alguma política do banco. Assumiu-se que é uma variável numérica, sem necessidade de qualquer outro tratamento.</p>
<p>Neste caso, as distribuições de clientes satisfeitos e insatisfeitos são bem diferentes, levando a acreditar que a variável possui poder de discriminação.</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"var15"</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>nfloat <span class="op">=</span> df[col].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">0</span> <span class="cf">if</span> x<span class="op">%</span><span class="dv">1</span> <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Contagem de números decimais: </span><span class="sc">{</span>nfloat<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Contagem de números decimais: 0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    df[col],</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">20</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-52-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="var36" class="level4">
<h4 class="anchored" data-anchor-id="var36">var36</h4>
<p>Esta variável aparenta ser uma variável categórica com labels não ordinais. Para a floresta aleatória, será interessante aplicar um Target Encoder customizado para que as categorias sejam ordenadas com base na proporção de clientes insatisfeitos. Já para modelos lineares e análise de cluster, One Hot Encoding ou Weight of Evidence podem ser mais interessantes. O valor 99 aparenta ser artificial, mas será considerado como uma categoria por ser muito representativo.</p>
<p>Os modelos de <em>boosting</em>, por outro lado, possuem métodos nativos para lidar com variáveis categóricas, mas exigem que seus <em>labels</em> sejam números inteiros variando de 0 a <em>nfeatures</em>-1. Assim, o tratamento será o mesmo que no caso da floresta por pura conveniência.</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">"var36"</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>ordered_df <span class="op">=</span> df <span class="op">\</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    .groupby(var)[<span class="st">"TARGET"</span>] <span class="op">\</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    .value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">\</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    .unstack() <span class="op">\</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="dv">0</span>, ascending<span class="op">=</span><span class="va">False</span>) <span class="op">\</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    .merge(</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>        df[var] <span class="op">\</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>            .value_counts() <span class="op">\</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>            .reset_index() <span class="op">\</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>            .set_index(var),</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>        left_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>        right_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>ordered_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">var36</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.000000</td>
<td>NaN</td>
<td>327</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.983607</td>
<td>0.016393</td>
<td>17691</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.970066</td>
<td>0.029934</td>
<td>6982</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.968366</td>
<td>0.031634</td>
<td>11728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>0.936234</td>
<td>0.063766</td>
<td>24088</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>CE_var36 <span class="op">=</span> CustomEncoder(colname<span class="op">=</span><span class="st">"var36"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>CE_var36 <span class="op">=</span> CE_var36.fit(df.drop(<span class="st">"TARGET"</span>, axis<span class="op">=</span><span class="dv">1</span>), df[<span class="st">"TARGET"</span>])</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> CE_var36.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ordered_df <span class="op">=</span> df <span class="op">\</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    .groupby(var)[<span class="st">"TARGET"</span>] <span class="op">\</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    .value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">\</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    .unstack() <span class="op">\</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="dv">0</span>, ascending<span class="op">=</span><span class="va">False</span>) <span class="op">\</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    .merge(</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>        df[var] <span class="op">\</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>            .value_counts() <span class="op">\</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>            .reset_index() <span class="op">\</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>            .set_index(var),</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>        left_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>        right_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>ordered_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">var36</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.000000</td>
<td>NaN</td>
<td>327</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.983607</td>
<td>0.016393</td>
<td>17691</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.970066</td>
<td>0.029934</td>
<td>6982</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.968366</td>
<td>0.031634</td>
<td>11728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.936234</td>
<td>0.063766</td>
<td>24088</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="var21" class="level4">
<h4 class="anchored" data-anchor-id="var21">var21</h4>
<p>Outra variável que aparenta ser categórica com labels não ordinais. Os mesmos tratamentos de var36 foram escolhidos.</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">"var21"</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>ordered_df <span class="op">=</span> df <span class="op">\</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    .groupby(var)[<span class="st">"TARGET"</span>] <span class="op">\</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    .value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">\</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    .unstack() <span class="op">\</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="dv">0</span>, ascending<span class="op">=</span><span class="va">False</span>) <span class="op">\</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    .merge(</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>        df[var] <span class="op">\</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>            .value_counts() <span class="op">\</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>            .reset_index() <span class="op">\</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>            .set_index(var),</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>        left_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>        right_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>ordered_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">var21</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">30000</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6000</td>
<td>1.000000</td>
<td>NaN</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1200</td>
<td>1.000000</td>
<td>NaN</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1500</td>
<td>1.000000</td>
<td>NaN</td>
<td>24</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18000</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10500</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2400</td>
<td>1.000000</td>
<td>NaN</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2700</td>
<td>1.000000</td>
<td>NaN</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9000</td>
<td>1.000000</td>
<td>NaN</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3300</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5100</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5400</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5700</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7200</td>
<td>0.978723</td>
<td>0.021277</td>
<td>47</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3600</td>
<td>0.977273</td>
<td>0.022727</td>
<td>44</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4500</td>
<td>0.974026</td>
<td>0.025974</td>
<td>77</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.960460</td>
<td>0.039540</td>
<td>60142</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3000</td>
<td>0.955882</td>
<td>0.044118</td>
<td>68</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">900</td>
<td>0.943820</td>
<td>0.056180</td>
<td>178</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1800</td>
<td>0.942675</td>
<td>0.057325</td>
<td>157</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2100</td>
<td>0.500000</td>
<td>0.500000</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4200</td>
<td>0.500000</td>
<td>0.500000</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>CE_var21 <span class="op">=</span> CustomEncoder(colname<span class="op">=</span><span class="st">"var21"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>CE_var21 <span class="op">=</span> CE_var21.fit(df.drop(<span class="st">"TARGET"</span>, axis<span class="op">=</span><span class="dv">1</span>), df[<span class="st">"TARGET"</span>])</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> CE_var21.transform(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>ordered_df <span class="op">=</span> df <span class="op">\</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    .groupby(var)[<span class="st">"TARGET"</span>] <span class="op">\</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    .value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">\</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    .unstack() <span class="op">\</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    .merge(</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>        df[var] <span class="op">\</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>            .value_counts() <span class="op">\</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>            .reset_index() <span class="op">\</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>            .set_index(var),</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>        left_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>        right_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>ordered_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">var21</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.000000</td>
<td>NaN</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.000000</td>
<td>NaN</td>
<td>24</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1.000000</td>
<td>NaN</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1.000000</td>
<td>NaN</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>1.000000</td>
<td>NaN</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>1.000000</td>
<td>NaN</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>0.978723</td>
<td>0.021277</td>
<td>47</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>0.977273</td>
<td>0.022727</td>
<td>44</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>0.974026</td>
<td>0.025974</td>
<td>77</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>0.960460</td>
<td>0.039540</td>
<td>60142</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>0.955882</td>
<td>0.044118</td>
<td>68</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>0.943820</td>
<td>0.056180</td>
<td>178</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>0.942675</td>
<td>0.057325</td>
<td>157</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>0.500000</td>
<td>0.500000</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>0.500000</td>
<td>0.500000</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="var38" class="level4">
<h4 class="anchored" data-anchor-id="var38">var38</h4>
<p>Já esta variável aparenta ser numérica, dada a grande quantidade de valores únicos e presença majoritária de números decimais. As ditribuições de clientes satisfeitos e insatisfeitos são muito parecidas, indicando que a variável não tem grande poder de discriminação.</p>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">"var38"</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>nfloat <span class="op">=</span> df[var] <span class="op">\</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x:</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> x<span class="op">%</span><span class="dv">1</span> <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">sum</span>() <span class="op">\</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> <span class="bu">len</span>(df) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Números decimais: </span><span class="sc">{</span>nfloat<span class="sc">:.2f}</span><span class="ss"> %"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Números decimais: 99.08 %</code></pre>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>df[[var]].describe().transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">var38</td>
<td>60816.0</td>
<td>117640.846586</td>
<td>189531.908253</td>
<td>5163.75</td>
<td>67775.2875</td>
<td>106514.73</td>
<td>118792.8225</td>
<td>22034738.76</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    df[var].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.log(x <span class="op">+</span> <span class="dv">1</span>)),</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">20</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/cell-61-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>