<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.3.433">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


    <title>Data Masters Case: Exploração inicial</title>    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>
    <style>
      .quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }
      .quarto-embed-header h6 {
        font-size: 1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 300;
      }
      .quarto-embed-header a.quarto-download-embed {
        font-size: 0.7em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }
    </style>
    
<script src="01-eda_files/libs/clipboard/clipboard.min.js"></script>
<script src="01-eda_files/libs/quarto-html/quarto.js"></script>
<script src="01-eda_files/libs/quarto-html/popper.min.js"></script>
<script src="01-eda_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="01-eda_files/libs/quarto-html/anchor.min.js"></script>
<link href="01-eda_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="01-eda_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="01-eda_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="01-eda_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="01-eda_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
     <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>  
      </head>
  <body class="quarto-notebook fullcontent">
    <div class="quarto-embed-header">
      <h6><i class="bi bi-journal-code"></i> 01-eda.ipynb</h6>
      <a href="01-eda.ipynb" class="btn btn-primary quarto-download-embed" data-noresolveinput="true" download="01-eda.ipynb">Download Notebook</a>
    </div>
     <div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content page-columns page-full" id="quarto-document-content">      <header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Masters Case: Exploração inicial</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>   <p>Felipe Viacava – São Paulo, ago/2023</p>
<p>O presente documento consiste na análise exploratória inicial dos dados fornecidos para a solução do Case “Data Masters - Cientista de Dados” do Santander Brasil. O objetivo é conhecer melhor os dados para definir com assertividade cada passo do processo de modelagem para as duas primeiras partes do projeto, que envolvem a classificação de clientes como satisfeitos ou insatisfeitos.</p>
<p>As premissas do presente documento são as seguintes:</p>
<ul>
<li><p>Os dados fornecidos são suficientes para a solução do problema;</p></li>
<li><p>O objetivo é treinar um modelo com boa capacidade de predição, independente de sua explicabilidade;</p></li>
<li><p>A análise exploratória deve contemplar apenas um subconjunto dos dados para evitar <em>data leakage</em>;</p></li>
<li><p>Nenhuma transformação realizada nesta etapa deve ser gravada em disco. Aqui, os passos de transformação serão definidos para aplicação nos <em>pipelines</em> de classificação, garantindo reprodutibilidade;</p></li>
<li><p>Dada a quantidade de variáveis, foram analisas em subconjuntos de acordo com seus prefixos.</p></li>
</ul>
<section id="bibliotecas" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="bibliotecas">Bibliotecas</h2>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Data Exploration --- #</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> missingno <span class="im">as</span> mno</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> resources.customviz <span class="im">as</span> cv</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> resources.edautils <span class="im">import</span> neg_pos_zero</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Data Processing --- #</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> resources.customtransformers <span class="im">import</span> <span class="op">\</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    DropConstantColumns, <span class="op">\</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    DropDuplicateColumns, <span class="op">\</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    AddNonZeroCount, <span class="op">\</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    CustomSum, <span class="op">\</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    CustomImputer, <span class="op">\</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    AddNoneCount, <span class="op">\</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    CustomEncoder</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Setting Global Options --- #</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>pd.options.display.max_columns <span class="op">=</span> <span class="va">None</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>pd.options.display.max_rows <span class="op">=</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
<section id="conjunto-de-dados" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="conjunto-de-dados">Conjunto de dados</h2>
<p>O conjunto de dados original do <em>Kaggle</em> (“train.csv”) foi renomeado para “raw.csv” e separado entre treino e teste previamente usando o script <em>resources/split.py</em>.</p>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"data/train.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">var3</th>
<th data-quarto-table-cell-role="th">var15</th>
<th data-quarto-table-cell-role="th">imp_ent_var16_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var40_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var40_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var41_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var41_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var39_ult1</th>
<th data-quarto-table-cell-role="th">imp_sal_var16_ult1</th>
<th data-quarto-table-cell-role="th">ind_var1_0</th>
<th data-quarto-table-cell-role="th">ind_var1</th>
<th data-quarto-table-cell-role="th">ind_var2_0</th>
<th data-quarto-table-cell-role="th">ind_var2</th>
<th data-quarto-table-cell-role="th">ind_var5_0</th>
<th data-quarto-table-cell-role="th">ind_var5</th>
<th data-quarto-table-cell-role="th">ind_var6_0</th>
<th data-quarto-table-cell-role="th">ind_var6</th>
<th data-quarto-table-cell-role="th">ind_var8_0</th>
<th data-quarto-table-cell-role="th">ind_var8</th>
<th data-quarto-table-cell-role="th">ind_var12_0</th>
<th data-quarto-table-cell-role="th">ind_var12</th>
<th data-quarto-table-cell-role="th">ind_var13_0</th>
<th data-quarto-table-cell-role="th">ind_var13_corto_0</th>
<th data-quarto-table-cell-role="th">ind_var13_corto</th>
<th data-quarto-table-cell-role="th">ind_var13_largo_0</th>
<th data-quarto-table-cell-role="th">ind_var13_largo</th>
<th data-quarto-table-cell-role="th">ind_var13_medio_0</th>
<th data-quarto-table-cell-role="th">ind_var13_medio</th>
<th data-quarto-table-cell-role="th">ind_var13</th>
<th data-quarto-table-cell-role="th">ind_var14_0</th>
<th data-quarto-table-cell-role="th">ind_var14</th>
<th data-quarto-table-cell-role="th">ind_var17_0</th>
<th data-quarto-table-cell-role="th">ind_var17</th>
<th data-quarto-table-cell-role="th">ind_var18_0</th>
<th data-quarto-table-cell-role="th">ind_var18</th>
<th data-quarto-table-cell-role="th">ind_var19</th>
<th data-quarto-table-cell-role="th">ind_var20_0</th>
<th data-quarto-table-cell-role="th">ind_var20</th>
<th data-quarto-table-cell-role="th">ind_var24_0</th>
<th data-quarto-table-cell-role="th">ind_var24</th>
<th data-quarto-table-cell-role="th">ind_var25_cte</th>
<th data-quarto-table-cell-role="th">ind_var26_0</th>
<th data-quarto-table-cell-role="th">ind_var26_cte</th>
<th data-quarto-table-cell-role="th">ind_var26</th>
<th data-quarto-table-cell-role="th">ind_var25_0</th>
<th data-quarto-table-cell-role="th">ind_var25</th>
<th data-quarto-table-cell-role="th">ind_var27_0</th>
<th data-quarto-table-cell-role="th">ind_var28_0</th>
<th data-quarto-table-cell-role="th">ind_var28</th>
<th data-quarto-table-cell-role="th">ind_var27</th>
<th data-quarto-table-cell-role="th">ind_var29_0</th>
<th data-quarto-table-cell-role="th">ind_var29</th>
<th data-quarto-table-cell-role="th">ind_var30_0</th>
<th data-quarto-table-cell-role="th">ind_var30</th>
<th data-quarto-table-cell-role="th">ind_var31_0</th>
<th data-quarto-table-cell-role="th">ind_var31</th>
<th data-quarto-table-cell-role="th">ind_var32_cte</th>
<th data-quarto-table-cell-role="th">ind_var32_0</th>
<th data-quarto-table-cell-role="th">ind_var32</th>
<th data-quarto-table-cell-role="th">ind_var33_0</th>
<th data-quarto-table-cell-role="th">ind_var33</th>
<th data-quarto-table-cell-role="th">ind_var34_0</th>
<th data-quarto-table-cell-role="th">ind_var34</th>
<th data-quarto-table-cell-role="th">ind_var37_cte</th>
<th data-quarto-table-cell-role="th">ind_var37_0</th>
<th data-quarto-table-cell-role="th">ind_var37</th>
<th data-quarto-table-cell-role="th">ind_var39_0</th>
<th data-quarto-table-cell-role="th">ind_var40_0</th>
<th data-quarto-table-cell-role="th">ind_var40</th>
<th data-quarto-table-cell-role="th">ind_var41_0</th>
<th data-quarto-table-cell-role="th">ind_var41</th>
<th data-quarto-table-cell-role="th">ind_var39</th>
<th data-quarto-table-cell-role="th">ind_var44_0</th>
<th data-quarto-table-cell-role="th">ind_var44</th>
<th data-quarto-table-cell-role="th">ind_var46_0</th>
<th data-quarto-table-cell-role="th">ind_var46</th>
<th data-quarto-table-cell-role="th">num_var1_0</th>
<th data-quarto-table-cell-role="th">num_var1</th>
<th data-quarto-table-cell-role="th">num_var4</th>
<th data-quarto-table-cell-role="th">num_var5_0</th>
<th data-quarto-table-cell-role="th">num_var5</th>
<th data-quarto-table-cell-role="th">num_var6_0</th>
<th data-quarto-table-cell-role="th">num_var6</th>
<th data-quarto-table-cell-role="th">num_var8_0</th>
<th data-quarto-table-cell-role="th">num_var8</th>
<th data-quarto-table-cell-role="th">num_var12_0</th>
<th data-quarto-table-cell-role="th">num_var12</th>
<th data-quarto-table-cell-role="th">num_var13_0</th>
<th data-quarto-table-cell-role="th">num_var13_corto_0</th>
<th data-quarto-table-cell-role="th">num_var13_corto</th>
<th data-quarto-table-cell-role="th">num_var13_largo_0</th>
<th data-quarto-table-cell-role="th">num_var13_largo</th>
<th data-quarto-table-cell-role="th">num_var13_medio_0</th>
<th data-quarto-table-cell-role="th">num_var13_medio</th>
<th data-quarto-table-cell-role="th">num_var13</th>
<th data-quarto-table-cell-role="th">num_var14_0</th>
<th data-quarto-table-cell-role="th">num_var14</th>
<th data-quarto-table-cell-role="th">num_var17_0</th>
<th data-quarto-table-cell-role="th">num_var17</th>
<th data-quarto-table-cell-role="th">num_var18_0</th>
<th data-quarto-table-cell-role="th">num_var18</th>
<th data-quarto-table-cell-role="th">num_var20_0</th>
<th data-quarto-table-cell-role="th">num_var20</th>
<th data-quarto-table-cell-role="th">num_var24_0</th>
<th data-quarto-table-cell-role="th">num_var24</th>
<th data-quarto-table-cell-role="th">num_var26_0</th>
<th data-quarto-table-cell-role="th">num_var26</th>
<th data-quarto-table-cell-role="th">num_var25_0</th>
<th data-quarto-table-cell-role="th">num_var25</th>
<th data-quarto-table-cell-role="th">num_op_var40_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var40_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var40_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var41_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var41_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var39_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var39_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_ult3</th>
<th data-quarto-table-cell-role="th">num_var27_0</th>
<th data-quarto-table-cell-role="th">num_var28_0</th>
<th data-quarto-table-cell-role="th">num_var28</th>
<th data-quarto-table-cell-role="th">num_var27</th>
<th data-quarto-table-cell-role="th">num_var29_0</th>
<th data-quarto-table-cell-role="th">num_var29</th>
<th data-quarto-table-cell-role="th">num_var30_0</th>
<th data-quarto-table-cell-role="th">num_var30</th>
<th data-quarto-table-cell-role="th">num_var31_0</th>
<th data-quarto-table-cell-role="th">num_var31</th>
<th data-quarto-table-cell-role="th">num_var32_0</th>
<th data-quarto-table-cell-role="th">num_var32</th>
<th data-quarto-table-cell-role="th">num_var33_0</th>
<th data-quarto-table-cell-role="th">num_var33</th>
<th data-quarto-table-cell-role="th">num_var34_0</th>
<th data-quarto-table-cell-role="th">num_var34</th>
<th data-quarto-table-cell-role="th">num_var35</th>
<th data-quarto-table-cell-role="th">num_var37_med_ult2</th>
<th data-quarto-table-cell-role="th">num_var37_0</th>
<th data-quarto-table-cell-role="th">num_var37</th>
<th data-quarto-table-cell-role="th">num_var39_0</th>
<th data-quarto-table-cell-role="th">num_var40_0</th>
<th data-quarto-table-cell-role="th">num_var40</th>
<th data-quarto-table-cell-role="th">num_var41_0</th>
<th data-quarto-table-cell-role="th">num_var41</th>
<th data-quarto-table-cell-role="th">num_var39</th>
<th data-quarto-table-cell-role="th">num_var42_0</th>
<th data-quarto-table-cell-role="th">num_var42</th>
<th data-quarto-table-cell-role="th">num_var44_0</th>
<th data-quarto-table-cell-role="th">num_var44</th>
<th data-quarto-table-cell-role="th">num_var46_0</th>
<th data-quarto-table-cell-role="th">num_var46</th>
<th data-quarto-table-cell-role="th">saldo_var1</th>
<th data-quarto-table-cell-role="th">saldo_var5</th>
<th data-quarto-table-cell-role="th">saldo_var6</th>
<th data-quarto-table-cell-role="th">saldo_var8</th>
<th data-quarto-table-cell-role="th">saldo_var12</th>
<th data-quarto-table-cell-role="th">saldo_var13_corto</th>
<th data-quarto-table-cell-role="th">saldo_var13_largo</th>
<th data-quarto-table-cell-role="th">saldo_var13_medio</th>
<th data-quarto-table-cell-role="th">saldo_var13</th>
<th data-quarto-table-cell-role="th">saldo_var14</th>
<th data-quarto-table-cell-role="th">saldo_var17</th>
<th data-quarto-table-cell-role="th">saldo_var18</th>
<th data-quarto-table-cell-role="th">saldo_var20</th>
<th data-quarto-table-cell-role="th">saldo_var24</th>
<th data-quarto-table-cell-role="th">saldo_var26</th>
<th data-quarto-table-cell-role="th">saldo_var25</th>
<th data-quarto-table-cell-role="th">saldo_var28</th>
<th data-quarto-table-cell-role="th">saldo_var27</th>
<th data-quarto-table-cell-role="th">saldo_var29</th>
<th data-quarto-table-cell-role="th">saldo_var30</th>
<th data-quarto-table-cell-role="th">saldo_var31</th>
<th data-quarto-table-cell-role="th">saldo_var32</th>
<th data-quarto-table-cell-role="th">saldo_var33</th>
<th data-quarto-table-cell-role="th">saldo_var34</th>
<th data-quarto-table-cell-role="th">saldo_var37</th>
<th data-quarto-table-cell-role="th">saldo_var40</th>
<th data-quarto-table-cell-role="th">saldo_var41</th>
<th data-quarto-table-cell-role="th">saldo_var42</th>
<th data-quarto-table-cell-role="th">saldo_var44</th>
<th data-quarto-table-cell-role="th">saldo_var46</th>
<th data-quarto-table-cell-role="th">var36</th>
<th data-quarto-table-cell-role="th">delta_imp_amort_var18_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_amort_var34_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_venta_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_reemb_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_reemb_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_reemb_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_trasp_var17_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_trasp_var17_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_trasp_var33_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_trasp_var33_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_venta_var44_1y3</th>
<th data-quarto-table-cell-role="th">imp_amort_var18_hace3</th>
<th data-quarto-table-cell-role="th">imp_amort_var18_ult1</th>
<th data-quarto-table-cell-role="th">imp_amort_var34_hace3</th>
<th data-quarto-table-cell-role="th">imp_amort_var34_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var13_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var13_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var17_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var17_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var33_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var33_ult1</th>
<th data-quarto-table-cell-role="th">imp_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">imp_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">imp_compra_var44_hace3</th>
<th data-quarto-table-cell-role="th">imp_compra_var44_ult1</th>
<th data-quarto-table-cell-role="th">imp_reemb_var13_hace3</th>
<th data-quarto-table-cell-role="th">imp_reemb_var13_ult1</th>
<th data-quarto-table-cell-role="th">imp_reemb_var17_hace3</th>
<th data-quarto-table-cell-role="th">imp_reemb_var17_ult1</th>
<th data-quarto-table-cell-role="th">imp_reemb_var33_hace3</th>
<th data-quarto-table-cell-role="th">imp_reemb_var33_ult1</th>
<th data-quarto-table-cell-role="th">imp_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">imp_trans_var37_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_in_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_in_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_out_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_out_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_in_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_in_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_out_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_out_ult1</th>
<th data-quarto-table-cell-role="th">imp_venta_var44_hace3</th>
<th data-quarto-table-cell-role="th">imp_venta_var44_ult1</th>
<th data-quarto-table-cell-role="th">ind_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">ind_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">ind_var10_ult1</th>
<th data-quarto-table-cell-role="th">ind_var10cte_ult1</th>
<th data-quarto-table-cell-role="th">ind_var9_cte_ult1</th>
<th data-quarto-table-cell-role="th">ind_var9_ult1</th>
<th data-quarto-table-cell-role="th">ind_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">ind_var43_recib_ult1</th>
<th data-quarto-table-cell-role="th">var21</th>
<th data-quarto-table-cell-role="th">num_var2_0_ult1</th>
<th data-quarto-table-cell-role="th">num_var2_ult1</th>
<th data-quarto-table-cell-role="th">num_aport_var13_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var13_ult1</th>
<th data-quarto-table-cell-role="th">num_aport_var17_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var17_ult1</th>
<th data-quarto-table-cell-role="th">num_aport_var33_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var33_ult1</th>
<th data-quarto-table-cell-role="th">num_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">num_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">num_compra_var44_hace3</th>
<th data-quarto-table-cell-role="th">num_compra_var44_ult1</th>
<th data-quarto-table-cell-role="th">num_ent_var16_ult1</th>
<th data-quarto-table-cell-role="th">num_var22_hace2</th>
<th data-quarto-table-cell-role="th">num_var22_hace3</th>
<th data-quarto-table-cell-role="th">num_var22_ult1</th>
<th data-quarto-table-cell-role="th">num_var22_ult3</th>
<th data-quarto-table-cell-role="th">num_med_var22_ult3</th>
<th data-quarto-table-cell-role="th">num_med_var45_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var5_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var8_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var12_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var13_corto_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var13_largo_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var13_medio_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var17_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var29_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var33_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var39_vig_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var44_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var40_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var40_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_reemb_var13_hace3</th>
<th data-quarto-table-cell-role="th">num_reemb_var13_ult1</th>
<th data-quarto-table-cell-role="th">num_reemb_var17_hace3</th>
<th data-quarto-table-cell-role="th">num_reemb_var17_ult1</th>
<th data-quarto-table-cell-role="th">num_reemb_var33_hace3</th>
<th data-quarto-table-cell-role="th">num_reemb_var33_ult1</th>
<th data-quarto-table-cell-role="th">num_sal_var16_ult1</th>
<th data-quarto-table-cell-role="th">num_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">num_var43_recib_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var11_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_in_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_in_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_out_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_out_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_in_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_in_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_out_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_out_ult1</th>
<th data-quarto-table-cell-role="th">num_venta_var44_hace3</th>
<th data-quarto-table-cell-role="th">num_venta_var44_ult1</th>
<th data-quarto-table-cell-role="th">num_var45_hace2</th>
<th data-quarto-table-cell-role="th">num_var45_hace3</th>
<th data-quarto-table-cell-role="th">num_var45_ult1</th>
<th data-quarto-table-cell-role="th">num_var45_ult3</th>
<th data-quarto-table-cell-role="th">saldo_var2_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_medio_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_medio_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_medio_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_medio_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_ult3</th>
<th data-quarto-table-cell-role="th">var38</th>
<th data-quarto-table-cell-role="th">TARGET</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>113911</td>
<td>2</td>
<td>23</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.00</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.00</td>
<td>0.0</td>
<td>0</td>
<td>3.00</td>
<td>0.0</td>
<td>0</td>
<td>99</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>3.00</td>
<td>2.61</td>
<td>3.00</td>
<td>2.88</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>182733.360000</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>120462</td>
<td>2</td>
<td>26</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.00</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.00</td>
<td>0.0</td>
<td>0</td>
<td>0.00</td>
<td>0.0</td>
<td>0</td>
<td>99</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>53329.230000</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>87126</td>
<td>2</td>
<td>47</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>1050.0</td>
<td>1050.0</td>
<td>1050.0</td>
<td>1050.0</td>
<td>1050.0</td>
<td>1050.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>9</td>
<td>9</td>
<td>0</td>
<td>0</td>
<td>9</td>
<td>9</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>12</td>
<td>3</td>
<td>6</td>
<td>6</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>861.12</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>1198.14</td>
<td>1198.14</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>861.12</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>563.31</td>
<td>0.0</td>
<td>0</td>
<td>861.12</td>
<td>0.0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>21</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>9</td>
<td>9</td>
<td>9</td>
<td>9</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>9</td>
<td>0</td>
<td>54</td>
<td>63</td>
<td>0</td>
<td>237.15</td>
<td>0.00</td>
<td>323.88</td>
<td>280.53</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>83674.500000</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>37241</td>
<td>2</td>
<td>33</td>
<td>0.0</td>
<td>0.0</td>
<td>67.05</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>67.05</td>
<td>60.0</td>
<td>300.0</td>
<td>60.0</td>
<td>60.0</td>
<td>300.0</td>
<td>60.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>21</td>
<td>0</td>
<td>3</td>
<td>24</td>
<td>21</td>
<td>0</td>
<td>3</td>
<td>24</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>1372.65</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.00</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>1372.65</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.00</td>
<td>0.0</td>
<td>0</td>
<td>1372.65</td>
<td>0.0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>600.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>9</td>
<td>0</td>
<td>9</td>
<td>3</td>
<td>6</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>3</td>
<td>9</td>
<td>3</td>
<td>9</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>18</td>
<td>3</td>
<td>24</td>
<td>0</td>
<td>774.42</td>
<td>250.02</td>
<td>1039.77</td>
<td>688.08</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>50519.070000</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>120348</td>
<td>2</td>
<td>23</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.00</td>
<td>0.00</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>3.00</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.00</td>
<td>0.0</td>
<td>0</td>
<td>3.00</td>
<td>0.0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3.00</td>
<td>0.18</td>
<td>3.00</td>
<td>2.07</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>117310.979016</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
</section>
<section id="análise-exploratória-e-feature-engineering" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="análise-exploratória-e-feature-engineering">Análise Exploratória e Feature Engineering</h2>
<p>A análise exploratória segue as premissas descritas no cabeçalho deste documento, e foi dividida em 3 partes:</p>
<ul>
<li><p>Análise generalizada, onde se detectou a presença de colunas constantes e/ou duplicadas;</p></li>
<li><p>Análise por prefixo, onde se assumiram as mesmas premissas para variáveis com o mesmo prefixo;</p></li>
<li><p>Análise individual para variáveis sem prefixos.</p></li>
</ul>
<p>Cada parte inclui apenas as colunas que não foram descartadas nas etapas anteriores, ou seja: uma variável de prefixo “ind” que tenha sido encontrada como constante ou duplicada na primeira etapa de análise (e processamento, durante a transformação no <em>pipeline</em>) não foi analisada durante a seção de seu prefixo.</p>
<p>Muitas variáveis compartilham o nome principal (“var30”, por exemplo), indicando que uma variável de prefixo “ind” pode ser um indicador de uma variável de prefixo “saldo”. Contudo, por haver muitos nomes, esta relação foi deixada como um ponto a desenvolver em futuras versões deste <em>case</em>.</p>
<section id="removendo-variáveis-constantes-e-duplicadas" class="level3">
<h3 class="anchored" data-anchor-id="removendo-variáveis-constantes-e-duplicadas">Removendo variáveis constantes e duplicadas</h3>
<p>Percebeu-se a existência de variáveis constantes e/ou duplicadas.</p>
<p>Variáveis aleatórias constantes não servem propósito algum na modelagem e ocupam espaço na memória, aumentando o custo computacional sem qualquer benefício na predição. Isso motiva a criação de um transformador customizado que detecta estas variáveis durante o <em>fit</em> (considerando apenas o subconjunto de treino) e as remove durante a transformação (tanto no subconjunto de treino quanto no de teste).</p>
<p>Variáveis duplicadas, por outro lado, levam à multicolinearidade, que pode impactar negativamente qualquer modelo estatístico – tanto em poder preditivo quanto em explicabilidade.</p>
<p>Os dois transformadores utilizados para realizar esta operação são <em>DropConstantColumns</em> e <em>DropDuplicateColumns</em>, encontrados no arquivo “customtransformers.py”, na pasta “resources” deste projeto.</p>
</section>
<section id="valores-faltantes" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="valores-faltantes">Valores faltantes</h3>
<p>Percebeu-se que não há nenhum valor faltante no conjunto de dados. Isso indica que, possivelmente, estes dados passaram por algum tratamento prévio, onde os valores faltantes foram preenchidos ou removidos. A investigação sobre dados faltantes, nesta análise, é própria de cada prefixo ou variável sem prefixo.</p>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [3]:</pre></div><div id="dupeconstdrop" class="cell" data-execution_count="3">
<details open="">
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dcc <span class="op">=</span> DropConstantColumns(print_cols<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>dcc <span class="op">=</span> dcc.fit(df)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> dcc.transform(df)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>ddc <span class="op">=</span> DropDuplicateColumns(print_cols<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>ddc <span class="op">=</span> ddc.fit(df)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ddc.transform(df)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>df<span class="sc">.</span>isna()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> missing values found."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>54 constant columns were found.
23 duplicate columns were found.
0 missing values found.</code></pre>
</div>
</div></div>
</section>
<section id="id-e-target" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="id-e-target">ID e TARGET</h3>
<p>ID:</p>
<p>Assumiu-se que esta coluna é o ID anonimizado de cada observação (cliente) da base, tanto pelo nome quanto por não conter nenhum valor duplicado ou faltante. Esta coluna não deve ser usada em hipótese alguma durante o treinamento pois, por ser uma chave única, não há como generalizar o aprendizado sobre ela para novos clientes (<em>overfitting</em>).</p>
<p>TARGET:</p>
<p>Assumiu-se que esta é a variável de interesse do problema por conta de seu nome e por ser binária (considerando que este é um problema de classificação binária). Dada a proporção de clientes insatisfeitos, é necessário validar o corte de classificação antes de classificar os clientes, além de usar os parâmetros feitos para lidar com este tipo de problema (como <em>class weight</em>) quando possível.</p>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [4]:</pre></div><div id="id-target" class="cell" data-execution_count="4">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>nu <span class="op">=</span> df[<span class="st">"ID"</span>].nunique() <span class="op">/</span> df.shape[<span class="dv">0</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Valores únicos em ID: </span><span class="sc">{</span><span class="dv">100</span><span class="op">*</span>nu<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>prop <span class="op">=</span> df[<span class="st">"TARGET"</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>).reset_index().set_index(<span class="st">"TARGET"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TARGET = 0: </span><span class="sc">{</span><span class="dv">100</span><span class="op">*</span>prop[<span class="st">'proportion'</span>][<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TARGET = 1: </span><span class="sc">{</span><span class="dv">100</span><span class="op">*</span>prop[<span class="st">'proportion'</span>][<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Valores únicos em ID: 100.00%
TARGET = 0: 96.04%
TARGET = 1: 3.96%</code></pre>
</div>
</div></div>
</section>
<section id="saldo" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="saldo">Saldo</h3>
<p>Assumiu-se, partindo das premissas descritas no cabeçalho, que esta é uma variável numérica, pois o prefixo “saldo” sugere que se trata de uma valor monetário. Como são muitas colunas, entende-se que se trata do saldo que um cliente tem em diversos produtos financeiros.</p>
<p>Números decimais, números negativos (no caso de um produto como Cheque Especial) e muitos valores únicos corroboram esta hipótese, assim como a esparsidade destes dados: com algum conhecimento de negócios, podemos inferir que é incomum um cliente possuir saldo em todos os produtos financeiros que o banco oferece.</p>
<p>Para detectar clientes com muitos produtos, foi criado o transformador “<em>AddNonZeroCount</em>”, que conta a quantidade de valores diferentes de zero um cliente tem nas colunas mesmo prefixo. Essa variável mostra que clientes com mais produtos tendem a ser mais satisfeitos – o que faz sentido, pois mostra que com maior satisfação, o cliente tende a adquirir mais produtos. Na verdade, a suma maioria dos clientes insatisfeitos se concentra em 0.</p>
<p>Para encontrar a diferença entre os saldos dos clientes de modo geral, foi criado o transformador “<em>CustomSum</em>”, que soma os valores de todas as colunas com o mesmo prefixo. Diferentemente da contagem de não-zeros, essa variável não aparenta ter poder de discriminação relevante</p>
<section id="verificações-generalizadas" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="verificações-generalizadas">Verificações generalizadas</h4>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell" data-execution_count="5">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>saldo_cols <span class="op">=</span> [</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col.startswith(<span class="st">"saldo"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>df[saldo_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="saldo-describe" class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">saldo_var1</th>
<th data-quarto-table-cell-role="th">saldo_var5</th>
<th data-quarto-table-cell-role="th">saldo_var8</th>
<th data-quarto-table-cell-role="th">saldo_var12</th>
<th data-quarto-table-cell-role="th">saldo_var13_corto</th>
<th data-quarto-table-cell-role="th">saldo_var13_largo</th>
<th data-quarto-table-cell-role="th">saldo_var13</th>
<th data-quarto-table-cell-role="th">saldo_var14</th>
<th data-quarto-table-cell-role="th">saldo_var17</th>
<th data-quarto-table-cell-role="th">saldo_var18</th>
<th data-quarto-table-cell-role="th">saldo_var20</th>
<th data-quarto-table-cell-role="th">saldo_var24</th>
<th data-quarto-table-cell-role="th">saldo_var26</th>
<th data-quarto-table-cell-role="th">saldo_var25</th>
<th data-quarto-table-cell-role="th">saldo_var29</th>
<th data-quarto-table-cell-role="th">saldo_var30</th>
<th data-quarto-table-cell-role="th">saldo_var31</th>
<th data-quarto-table-cell-role="th">saldo_var32</th>
<th data-quarto-table-cell-role="th">saldo_var33</th>
<th data-quarto-table-cell-role="th">saldo_var37</th>
<th data-quarto-table-cell-role="th">saldo_var40</th>
<th data-quarto-table-cell-role="th">saldo_var42</th>
<th data-quarto-table-cell-role="th">saldo_var44</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var5_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var8_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var12_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_corto_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var13_largo_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var17_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var29_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var33_ult3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_hace2</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_hace3</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_ult1</th>
<th data-quarto-table-cell-role="th">saldo_medio_var44_ult3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>57015.00000</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>5.647377e+01</td>
<td>1022.886994</td>
<td>148.382236</td>
<td>6.199680e+03</td>
<td>5043.312059</td>
<td>1.615135e+03</td>
<td>6.658447e+03</td>
<td>75.408646</td>
<td>2.280693e+02</td>
<td>5.261773e+01</td>
<td>30.574473</td>
<td>6.093697e+03</td>
<td>77.819255</td>
<td>74.31219</td>
<td>0.552634</td>
<td>1.402995e+04</td>
<td>3.477103e+02</td>
<td>3.507064</td>
<td>6.802496</td>
<td>38.415775</td>
<td>3.856036</td>
<td>7.371502e+03</td>
<td>112.838445</td>
<td>1579.223329</td>
<td>8.886114e+02</td>
<td>1087.701298</td>
<td>1060.380299</td>
<td>72.142799</td>
<td>9.915621</td>
<td>130.781521</td>
<td>114.667478</td>
<td>4.144313e+03</td>
<td>642.496189</td>
<td>5.888456e+03</td>
<td>4.520353e+03</td>
<td>3641.106408</td>
<td>563.469897</td>
<td>4905.352849</td>
<td>3893.801718</td>
<td>835.691014</td>
<td>175.699469</td>
<td>1.039760e+03</td>
<td>8.149678e+02</td>
<td>1.112751e+02</td>
<td>4.772609e+01</td>
<td>1.610807e+02</td>
<td>1.343335e+02</td>
<td>0.284095</td>
<td>0.002547</td>
<td>0.338542</td>
<td>0.248840</td>
<td>5.134473</td>
<td>0.970980</td>
<td>6.747690</td>
<td>4.802795</td>
<td>34.787668</td>
<td>1.683645</td>
<td>85.491811</td>
<td>64.562739</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>1.256438e+04</td>
<td>9585.151279</td>
<td>2674.921373</td>
<td>5.046542e+04</td>
<td>32941.531827</td>
<td>2.117787e+04</td>
<td>3.930945e+04</td>
<td>3135.619158</td>
<td>2.617611e+04</td>
<td>1.256396e+04</td>
<td>2836.440607</td>
<td>5.030050e+04</td>
<td>778.339337</td>
<td>764.19930</td>
<td>95.951729</td>
<td>6.551689e+04</td>
<td>2.685425e+04</td>
<td>133.813397</td>
<td>441.867908</td>
<td>512.919169</td>
<td>104.321349</td>
<td>5.136950e+04</td>
<td>5916.053871</td>
<td>12018.675179</td>
<td>1.048953e+04</td>
<td>9402.311934</td>
<td>8168.239694</td>
<td>1876.609553</td>
<td>494.372570</td>
<td>2286.641030</td>
<td>1951.417607</td>
<td>4.036733e+04</td>
<td>9786.216189</td>
<td>4.862178e+04</td>
<td>3.699663e+04</td>
<td>26377.374116</td>
<td>7323.317321</td>
<td>32191.041402</td>
<td>25734.410218</td>
<td>13702.722377</td>
<td>4857.309719</td>
<td>1.704264e+04</td>
<td>1.313540e+04</td>
<td>1.775392e+04</td>
<td>9.943442e+03</td>
<td>1.723843e+04</td>
<td>1.508243e+04</td>
<td>48.289987</td>
<td>0.608096</td>
<td>60.135284</td>
<td>36.811052</td>
<td>352.560232</td>
<td>83.872097</td>
<td>439.445853</td>
<td>300.110789</td>
<td>2260.794741</td>
<td>143.601303</td>
<td>4518.340854</td>
<td>3202.202490</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000e+00</td>
<td>-1842.000000</td>
<td>-4942.260000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>-4.942260e+03</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-4.942260e+03</td>
<td>0.000000</td>
<td>-128.370000</td>
<td>-8.040000e+00</td>
<td>-922.380000</td>
<td>-476.070000</td>
<td>-287.670000</td>
<td>0.000000</td>
<td>-3401.340000</td>
<td>-1844.520000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>-3.000000e-02</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.000000e+00</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>3.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000e+00</td>
<td>0.000000</td>
<td>3.000000</td>
<td>9.900000e-01</td>
<td>3.000000</td>
<td>2.730000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.000000e+00</td>
<td>90.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>2.429700e+02</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.200000e+02</td>
<td>0.000000</td>
<td>90.000000</td>
<td>1.245000e+01</td>
<td>90.000000</td>
<td>83.820000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>3.000000e+06</td>
<td>619329.150000</td>
<td>240045.000000</td>
<td>3.008077e+06</td>
<td>450000.000000</td>
<td>1.500000e+06</td>
<td>1.500000e+06</td>
<td>450000.000000</td>
<td>6.119500e+06</td>
<td>3.000000e+06</td>
<td>455858.160000</td>
<td>3.008077e+06</td>
<td>69756.720000</td>
<td>69756.72000</td>
<td>19531.800000</td>
<td>3.458077e+06</td>
<td>6.119500e+06</td>
<td>12210.780000</td>
<td>46005.300000</td>
<td>60000.000000</td>
<td>8192.610000</td>
<td>3.008077e+06</td>
<td>740006.610000</td>
<td>812137.260000</td>
<td>1.542339e+06</td>
<td>601428.600000</td>
<td>544365.570000</td>
<td>231351.990000</td>
<td>73362.240000</td>
<td>228031.800000</td>
<td>177582.000000</td>
<td>3.000538e+06</td>
<td>668335.320000</td>
<td>3.004186e+06</td>
<td>2.272859e+06</td>
<td>450000.000000</td>
<td>304838.700000</td>
<td>450000.000000</td>
<td>450000.000000</td>
<td>840000.000000</td>
<td>534000.000000</td>
<td>1.500000e+06</td>
<td>1.034483e+06</td>
<td>4.210084e+06</td>
<td>2.368559e+06</td>
<td>3.998687e+06</td>
<td>3.525777e+06</td>
<td>10430.010000</td>
<td>145.200000</td>
<td>13793.670000</td>
<td>7331.340000</td>
<td>43406.220000</td>
<td>11473.050000</td>
<td>46190.910000</td>
<td>32689.440000</td>
<td>438329.220000</td>
<td>24650.010000</td>
<td>681462.900000</td>
<td>397884.300000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [6]:</pre></div><div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df[saldo_cols] <span class="op">\</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    .nunique() <span class="op">\</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    .nlargest(<span class="dv">5</span>) <span class="op">\</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    .rename(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        mapper<span class="op">=</span>{</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"index"</span>: <span class="st">"Column"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>: <span class="st">"Number of unique values"</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">\</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    .set_index(<span class="st">"Column"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Number of unique values</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">saldo_medio_var5_ult3</td>
<td>13846</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">saldo_var30</td>
<td>13225</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">saldo_var42</td>
<td>12242</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">saldo_medio_var5_ult1</td>
<td>11621</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">saldo_medio_var5_hace2</td>
<td>11478</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>neg_pos_zero(df, saldo_cols) <span class="co"># Esta função foi criada no arquivo "edautils.py"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Negative values (%)</th>
<th data-quarto-table-cell-role="th">Positive values (%)</th>
<th data-quarto-table-cell-role="th">Zero values (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>saldo_var1</td>
<td>0.000000</td>
<td>0.350785</td>
<td>99.649215</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>saldo_medio_var12_hace2</td>
<td>0.000000</td>
<td>3.981408</td>
<td>96.018592</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>saldo_medio_var12_hace3</td>
<td>0.000000</td>
<td>1.704815</td>
<td>98.295185</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>saldo_medio_var12_ult1</td>
<td>0.000000</td>
<td>4.602298</td>
<td>95.397702</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>saldo_medio_var12_ult3</td>
<td>0.000000</td>
<td>4.602298</td>
<td>95.397702</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>saldo_medio_var13_corto_hace2</td>
<td>0.000000</td>
<td>3.900728</td>
<td>96.099272</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>saldo_medio_var13_corto_hace3</td>
<td>0.000000</td>
<td>1.781987</td>
<td>98.218013</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>saldo_medio_var13_corto_ult1</td>
<td>0.000000</td>
<td>4.184864</td>
<td>95.815136</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>saldo_medio_var13_corto_ult3</td>
<td>0.000000</td>
<td>4.184864</td>
<td>95.815136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>saldo_medio_var13_largo_hace2</td>
<td>0.000000</td>
<td>0.675261</td>
<td>99.324739</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>saldo_medio_var13_largo_hace3</td>
<td>0.000000</td>
<td>0.420942</td>
<td>99.579058</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>saldo_medio_var13_largo_ult1</td>
<td>0.000000</td>
<td>0.741910</td>
<td>99.258090</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>saldo_medio_var13_largo_ult3</td>
<td>0.000000</td>
<td>0.741910</td>
<td>99.258090</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">44</td>
<td>saldo_medio_var17_hace3</td>
<td>0.000000</td>
<td>0.022801</td>
<td>99.977199</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">45</td>
<td>saldo_medio_var17_ult1</td>
<td>0.000000</td>
<td>0.159607</td>
<td>99.840393</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">46</td>
<td>saldo_medio_var17_ult3</td>
<td>0.000000</td>
<td>0.159607</td>
<td>99.840393</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">47</td>
<td>saldo_medio_var29_hace2</td>
<td>0.000000</td>
<td>0.007016</td>
<td>99.992984</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">48</td>
<td>saldo_medio_var29_hace3</td>
<td>0.000000</td>
<td>0.001754</td>
<td>99.998246</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">49</td>
<td>saldo_medio_var29_ult1</td>
<td>0.000000</td>
<td>0.005262</td>
<td>99.994738</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50</td>
<td>saldo_medio_var29_ult3</td>
<td>0.000000</td>
<td>0.005262</td>
<td>99.994738</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">51</td>
<td>saldo_medio_var33_hace2</td>
<td>0.000000</td>
<td>0.047356</td>
<td>99.952644</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">52</td>
<td>saldo_medio_var33_hace3</td>
<td>0.000000</td>
<td>0.026309</td>
<td>99.973691</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">53</td>
<td>saldo_medio_var33_ult1</td>
<td>0.000000</td>
<td>0.050864</td>
<td>99.949136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">54</td>
<td>saldo_medio_var33_ult3</td>
<td>0.000000</td>
<td>0.050864</td>
<td>99.949136</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">55</td>
<td>saldo_medio_var44_hace2</td>
<td>0.000000</td>
<td>0.126283</td>
<td>99.873717</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">56</td>
<td>saldo_medio_var44_hace3</td>
<td>0.000000</td>
<td>0.038586</td>
<td>99.961414</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">57</td>
<td>saldo_medio_var44_ult1</td>
<td>0.000000</td>
<td>0.191178</td>
<td>99.808822</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>saldo_medio_var8_hace3</td>
<td>0.000000</td>
<td>0.629659</td>
<td>99.370341</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>saldo_medio_var44_ult3</td>
<td>0.000000</td>
<td>0.191178</td>
<td>99.808822</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>saldo_var32</td>
<td>0.000000</td>
<td>0.108743</td>
<td>99.891257</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>saldo_var18</td>
<td>0.000000</td>
<td>0.001754</td>
<td>99.998246</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>saldo_var20</td>
<td>0.000000</td>
<td>0.250811</td>
<td>99.749189</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>saldo_var24</td>
<td>0.000000</td>
<td>3.837587</td>
<td>96.162413</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>saldo_var26</td>
<td>0.000000</td>
<td>2.502850</td>
<td>97.497150</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>saldo_var25</td>
<td>0.000000</td>
<td>2.402876</td>
<td>97.597124</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>saldo_var29</td>
<td>0.000000</td>
<td>0.003508</td>
<td>99.996492</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>saldo_var13</td>
<td>0.000000</td>
<td>5.126721</td>
<td>94.873279</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>saldo_var31</td>
<td>0.000000</td>
<td>0.368324</td>
<td>99.631676</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>saldo_var17</td>
<td>0.000000</td>
<td>0.152591</td>
<td>99.847409</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>saldo_var14</td>
<td>0.000000</td>
<td>0.533193</td>
<td>99.466807</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>saldo_var37</td>
<td>0.000000</td>
<td>6.596510</td>
<td>93.403490</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>saldo_var40</td>
<td>0.000000</td>
<td>0.349031</td>
<td>99.650969</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>saldo_var13_largo</td>
<td>0.000000</td>
<td>1.052355</td>
<td>98.947645</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>saldo_var44</td>
<td>0.000000</td>
<td>0.175392</td>
<td>99.824608</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>saldo_var13_corto</td>
<td>0.000000</td>
<td>4.141016</td>
<td>95.858984</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>saldo_var12</td>
<td>0.000000</td>
<td>4.575989</td>
<td>95.424011</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>saldo_var33</td>
<td>0.000000</td>
<td>0.050864</td>
<td>99.949136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>saldo_medio_var17_hace2</td>
<td>0.001754</td>
<td>0.110497</td>
<td>99.887749</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>saldo_medio_var8_hace2</td>
<td>0.003508</td>
<td>1.831097</td>
<td>98.165395</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>saldo_medio_var5_hace3</td>
<td>0.007016</td>
<td>60.945365</td>
<td>39.047619</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>saldo_medio_var8_ult3</td>
<td>0.010524</td>
<td>2.893975</td>
<td>97.095501</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>saldo_medio_var8_ult1</td>
<td>0.017539</td>
<td>2.886960</td>
<td>97.095501</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>saldo_var8</td>
<td>0.031571</td>
<td>2.834342</td>
<td>97.134088</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>saldo_medio_var5_ult3</td>
<td>0.031571</td>
<td>67.515566</td>
<td>32.452863</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>saldo_medio_var5_hace2</td>
<td>0.035078</td>
<td>69.402789</td>
<td>30.562133</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>saldo_medio_var5_ult1</td>
<td>0.064895</td>
<td>67.482242</td>
<td>32.452863</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>saldo_var5</td>
<td>0.133298</td>
<td>66.245725</td>
<td>33.620977</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>saldo_var30</td>
<td>0.161361</td>
<td>73.154433</td>
<td>26.684206</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>saldo_var42</td>
<td>0.163115</td>
<td>71.191792</td>
<td>28.645093</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
</section>
<section id="feature-engineering" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="feature-engineering">Feature engineering</h4>
<section id="contagem-de-colunas-diferentes-de-0" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="contagem-de-colunas-diferentes-de-0">Contagem de colunas diferentes de 0</h5>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell" data-execution_count="8">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>anzc_saldo <span class="op">=</span> AddNonZeroCount(prefix<span class="op">=</span><span class="st">"saldo"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>anzc_saldo <span class="op">=</span> anzc_saldo.fit(df)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anzc_saldo.transform(df)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"non_zero_count_saldo"</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(x<span class="op">=</span>df[col], hue<span class="op">=</span>df[<span class="st">"TARGET"</span>], nbins<span class="op">=</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/saldo-nonzero-output-1.png" id="saldo-nonzero" class="img-fluid"></p>
</div>
</div></div>
</section>
<section id="soma-total-das-colunas" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="soma-total-das-colunas">Soma total das colunas</h5>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell" data-execution_count="9">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cs_saldo <span class="op">=</span> CustomSum(prefix<span class="op">=</span><span class="st">"saldo"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>cs_saldo <span class="op">=</span> cs_saldo.fit(df)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> cs_saldo.transform(df)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"sum_of_saldo"</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>min_sum <span class="op">=</span> df[col].<span class="bu">min</span>()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df[col].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.log(x<span class="op">+</span><span class="dv">1</span><span class="op">-</span>min_sum)),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span>df[<span class="st">"TARGET"</span>],</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">10</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/saldo-sum-output-1.png" id="saldo-sum" class="img-fluid"></p>
</div>
</div></div>
</section>
</section>
</section>
<section id="imp" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="imp">Imp</h3>
<p>Assumindo que “imp” se deriva de “imposición”, ou seja, algum tipo de taxa, com caracteríticas semelhantes às descritas no subset de “saldo”(com excessão de valores negativos, que aqui não existem), também partimos do pressuposto de que estas são variáveis numéricas. Foram criadas as mesmas colunas que no subset de “saldo”.</p>
<p>Neste caso, nenhuma das variáveis criadas parece ter poder de discriminação.</p>
<section id="verificações-generalizadas-1" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="verificações-generalizadas-1">Verificações generalizadas</h4>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [10]:</pre></div><div class="cell" data-execution_count="10">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>imp_cols <span class="op">=</span> [</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col.startswith(<span class="st">"imp"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>df[imp_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="imp-describe" class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">imp_ent_var16_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var40_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var40_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var40_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_comer_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_comer_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var41_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var41_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var41_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_efect_ult1</th>
<th data-quarto-table-cell-role="th">imp_op_var39_efect_ult3</th>
<th data-quarto-table-cell-role="th">imp_op_var39_ult1</th>
<th data-quarto-table-cell-role="th">imp_sal_var16_ult1</th>
<th data-quarto-table-cell-role="th">imp_amort_var18_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var13_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var13_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var17_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var17_ult1</th>
<th data-quarto-table-cell-role="th">imp_aport_var33_hace3</th>
<th data-quarto-table-cell-role="th">imp_aport_var33_ult1</th>
<th data-quarto-table-cell-role="th">imp_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">imp_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">imp_compra_var44_hace3</th>
<th data-quarto-table-cell-role="th">imp_compra_var44_ult1</th>
<th data-quarto-table-cell-role="th">imp_reemb_var13_ult1</th>
<th data-quarto-table-cell-role="th">imp_reemb_var17_hace3</th>
<th data-quarto-table-cell-role="th">imp_reemb_var17_ult1</th>
<th data-quarto-table-cell-role="th">imp_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">imp_trans_var37_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_in_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_in_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var17_out_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_in_hace3</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_in_ult1</th>
<th data-quarto-table-cell-role="th">imp_trasp_var33_out_ult1</th>
<th data-quarto-table-cell-role="th">imp_venta_var44_hace3</th>
<th data-quarto-table-cell-role="th">imp_venta_var44_ult1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>81.003089</td>
<td>71.913524</td>
<td>118.994372</td>
<td>3.083158</td>
<td>5.752563</td>
<td>0.365381</td>
<td>0.535336</td>
<td>2.829000</td>
<td>68.830367</td>
<td>113.241809</td>
<td>67.552170</td>
<td>111.873221</td>
<td>136.944608</td>
<td>67.917551</td>
<td>112.408557</td>
<td>139.773609</td>
<td>4.233566</td>
<td>0.275222</td>
<td>2873.495172</td>
<td>635.007707</td>
<td>1.277614e+02</td>
<td>36.573989</td>
<td>2.255196</td>
<td>0.036832</td>
<td>3.628605</td>
<td>1.452222e+02</td>
<td>12.487925</td>
<td>1.506857e+02</td>
<td>48.314042</td>
<td>0.210947</td>
<td>13.714707</td>
<td>868.027511</td>
<td>1.931449e+03</td>
<td>2.499744</td>
<td>3.350238</td>
<td>2.495498</td>
<td>1.948178</td>
<td>0.184902</td>
<td>0.052618</td>
<td>1.369179</td>
<td>1.050151e+02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>1366.949303</td>
<td>335.251692</td>
<td>543.966435</td>
<td>80.869729</td>
<td>140.495976</td>
<td>32.236893</td>
<td>38.987633</td>
<td>87.985696</td>
<td>318.924638</td>
<td>515.535254</td>
<td>531.479065</td>
<td>863.633698</td>
<td>703.052574</td>
<td>535.168344</td>
<td>867.890588</td>
<td>717.360016</td>
<td>294.988427</td>
<td>65.717071</td>
<td>25674.815161</td>
<td>11484.052874</td>
<td>2.553634e+04</td>
<td>2754.144279</td>
<td>202.168560</td>
<td>4.352167</td>
<td>639.990954</td>
<td>6.784845e+03</td>
<td>966.472697</td>
<td>1.572070e+04</td>
<td>3063.934595</td>
<td>50.369561</td>
<td>1206.186327</td>
<td>13840.787878</td>
<td>2.332046e+04</td>
<td>448.305976</td>
<td>587.705484</td>
<td>412.478795</td>
<td>271.121054</td>
<td>27.264123</td>
<td>12.563964</td>
<td>326.833072</td>
<td>1.301850e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>135000.000000</td>
<td>9968.040000</td>
<td>16086.060000</td>
<td>8237.820000</td>
<td>10351.950000</td>
<td>6600.000000</td>
<td>6600.000000</td>
<td>8237.820000</td>
<td>9177.180000</td>
<td>16086.060000</td>
<td>45990.000000</td>
<td>96870.000000</td>
<td>47598.090000</td>
<td>45990.000000</td>
<td>96870.000000</td>
<td>47598.090000</td>
<td>58048.050000</td>
<td>15691.800000</td>
<td>840000.000000</td>
<td>450000.000000</td>
<td>6.083692e+06</td>
<td>432457.320000</td>
<td>36000.000000</td>
<td>750.000000</td>
<td>145384.920000</td>
<td>1.039260e+06</td>
<td>128874.510000</td>
<td>3.410059e+06</td>
<td>450000.000000</td>
<td>12027.150000</td>
<td>182132.970000</td>
<td>901169.100000</td>
<td>1.608000e+06</td>
<td>96781.440000</td>
<td>133730.580000</td>
<td>69622.290000</td>
<td>44251.080000</td>
<td>5400.000000</td>
<td>3000.000000</td>
<td>78040.590000</td>
<td>2.754476e+06</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df[imp_cols] <span class="op">\</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    .nunique() <span class="op">\</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    .sort_values() <span class="op">\</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    .rename(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        mapper<span class="op">=</span>{</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"index"</span>: <span class="st">"Column"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>: <span class="st">"Number of unique values"</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Number of unique values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>imp_trasp_var33_out_ult1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>imp_amort_var18_ult1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>imp_reemb_var17_hace3</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>imp_venta_var44_hace3</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>imp_trasp_var17_in_hace3</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>imp_trasp_var33_in_ult1</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>imp_trasp_var33_in_hace3</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>imp_trasp_var17_out_ult1</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>imp_var7_emit_ult1</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>imp_aport_var33_ult1</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>imp_trasp_var17_in_ult1</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>imp_aport_var33_hace3</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>imp_reemb_var17_ult1</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>imp_aport_var17_hace3</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>imp_op_var40_efect_ult1</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>imp_op_var40_efect_ult3</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>imp_compra_var44_hace3</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>imp_reemb_var13_ult1</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>imp_aport_var17_ult1</td>
<td>35</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>imp_venta_var44_ult1</td>
<td>38</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>imp_sal_var16_ult1</td>
<td>55</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>imp_compra_var44_ult1</td>
<td>70</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>imp_var7_recib_ult1</td>
<td>145</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>imp_aport_var13_ult1</td>
<td>152</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>imp_op_var40_ult1</td>
<td>161</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>imp_op_var40_comer_ult1</td>
<td>205</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>imp_op_var40_comer_ult3</td>
<td>242</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>imp_op_var41_efect_ult1</td>
<td>270</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>imp_op_var39_efect_ult1</td>
<td>273</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>imp_aport_var13_hace3</td>
<td>335</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>imp_op_var41_efect_ult3</td>
<td>379</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>imp_op_var39_efect_ult3</td>
<td>381</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>imp_ent_var16_ult1</td>
<td>479</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>imp_var43_emit_ult1</td>
<td>1856</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>imp_trans_var37_ult1</td>
<td>3034</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>imp_op_var41_comer_ult1</td>
<td>5781</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>imp_op_var39_comer_ult1</td>
<td>5870</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>imp_op_var41_ult1</td>
<td>6190</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>imp_op_var39_ult1</td>
<td>6280</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>imp_op_var41_comer_ult3</td>
<td>6952</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>imp_op_var39_comer_ult3</td>
<td>7047</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [12]:</pre></div><div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>neg_pos_zero(df, imp_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Negative values (%)</th>
<th data-quarto-table-cell-role="th">Positive values (%)</th>
<th data-quarto-table-cell-role="th">Zero values (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>imp_ent_var16_ult1</td>
<td>0</td>
<td>4.751381</td>
<td>95.248619</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>imp_aport_var33_hace3</td>
<td>0</td>
<td>0.026309</td>
<td>99.973691</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>imp_aport_var33_ult1</td>
<td>0</td>
<td>0.008770</td>
<td>99.991230</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>imp_var7_emit_ult1</td>
<td>0</td>
<td>0.005262</td>
<td>99.994738</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>imp_var7_recib_ult1</td>
<td>0</td>
<td>0.284136</td>
<td>99.715864</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>imp_compra_var44_hace3</td>
<td>0</td>
<td>0.038586</td>
<td>99.961414</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>imp_compra_var44_ult1</td>
<td>0</td>
<td>0.121021</td>
<td>99.878979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>imp_reemb_var13_ult1</td>
<td>0</td>
<td>0.050864</td>
<td>99.949136</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29</td>
<td>imp_reemb_var17_hace3</td>
<td>0</td>
<td>0.001754</td>
<td>99.998246</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30</td>
<td>imp_reemb_var17_ult1</td>
<td>0</td>
<td>0.022801</td>
<td>99.977199</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">31</td>
<td>imp_var43_emit_ult1</td>
<td>0</td>
<td>6.664913</td>
<td>93.335087</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32</td>
<td>imp_trans_var37_ult1</td>
<td>0</td>
<td>13.022889</td>
<td>86.977111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33</td>
<td>imp_trasp_var17_in_hace3</td>
<td>0</td>
<td>0.003508</td>
<td>99.996492</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>imp_trasp_var17_in_ult1</td>
<td>0</td>
<td>0.007016</td>
<td>99.992984</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35</td>
<td>imp_trasp_var17_out_ult1</td>
<td>0</td>
<td>0.005262</td>
<td>99.994738</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">36</td>
<td>imp_trasp_var33_in_hace3</td>
<td>0</td>
<td>0.005262</td>
<td>99.994738</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">37</td>
<td>imp_trasp_var33_in_ult1</td>
<td>0</td>
<td>0.005262</td>
<td>99.994738</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">38</td>
<td>imp_trasp_var33_out_ult1</td>
<td>0</td>
<td>0.001754</td>
<td>99.998246</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>imp_aport_var17_ult1</td>
<td>0</td>
<td>0.063141</td>
<td>99.936859</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>imp_venta_var44_hace3</td>
<td>0</td>
<td>0.003508</td>
<td>99.996492</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>imp_aport_var17_hace3</td>
<td>0</td>
<td>0.028063</td>
<td>99.971937</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>imp_aport_var13_hace3</td>
<td>0</td>
<td>2.260809</td>
<td>97.739191</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>imp_op_var39_comer_ult1</td>
<td>0</td>
<td>13.017627</td>
<td>86.982373</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>imp_op_var39_comer_ult3</td>
<td>0</td>
<td>15.339823</td>
<td>84.660177</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>imp_op_var40_comer_ult1</td>
<td>0</td>
<td>0.361308</td>
<td>99.638692</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>imp_op_var40_comer_ult3</td>
<td>0</td>
<td>0.427958</td>
<td>99.572042</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>imp_op_var40_efect_ult1</td>
<td>0</td>
<td>0.042094</td>
<td>99.957906</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>imp_op_var40_efect_ult3</td>
<td>0</td>
<td>0.049110</td>
<td>99.950890</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>imp_op_var40_ult1</td>
<td>0</td>
<td>0.285890</td>
<td>99.714110</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>imp_op_var41_comer_ult1</td>
<td>0</td>
<td>12.836973</td>
<td>87.163027</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>imp_op_var41_comer_ult3</td>
<td>0</td>
<td>15.152153</td>
<td>84.847847</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>imp_op_var41_efect_ult1</td>
<td>0</td>
<td>8.673156</td>
<td>91.326844</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>imp_op_var41_efect_ult3</td>
<td>0</td>
<td>11.309305</td>
<td>88.690695</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>imp_op_var41_ult1</td>
<td>0</td>
<td>15.239849</td>
<td>84.760151</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>imp_op_var39_efect_ult1</td>
<td>0</td>
<td>8.685434</td>
<td>91.314566</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>imp_op_var39_efect_ult3</td>
<td>0</td>
<td>11.319828</td>
<td>88.680172</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>imp_op_var39_ult1</td>
<td>0</td>
<td>15.383671</td>
<td>84.616329</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>imp_sal_var16_ult1</td>
<td>0</td>
<td>0.131544</td>
<td>99.868456</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>imp_amort_var18_ult1</td>
<td>0</td>
<td>0.001754</td>
<td>99.998246</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>imp_aport_var13_ult1</td>
<td>0</td>
<td>0.524423</td>
<td>99.475577</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>imp_venta_var44_ult1</td>
<td>0</td>
<td>0.064895</td>
<td>99.935105</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
</section>
<section id="feature-engineering-1" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="feature-engineering-1">Feature Engineering</h4>
<section id="contagem-de-colunas-diferentes-de-0-1" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="contagem-de-colunas-diferentes-de-0-1">Contagem de colunas diferentes de 0</h5>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [13]:</pre></div><div class="cell" data-execution_count="13">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>anzc_imp <span class="op">=</span> AddNonZeroCount(prefix<span class="op">=</span><span class="st">"imp"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>anzc_imp <span class="op">=</span> anzc_imp.fit(df)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anzc_imp.transform(df)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"non_zero_count_imp"</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(df[col], df[<span class="st">"TARGET"</span>], nbins<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/imp-nonzero-output-1.png" id="imp-nonzero" class="img-fluid"></p>
</div>
</div></div>
</section>
<section id="soma-total-das-colunas-1" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="soma-total-das-colunas-1">Soma total das colunas</h5>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [14]:</pre></div><div class="cell" data-execution_count="14">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cs_imp <span class="op">=</span> CustomSum(prefix<span class="op">=</span><span class="st">"imp"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>cs_imp <span class="op">=</span> cs_imp.fit(df)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> cs_imp.transform(df)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"sum_of_imp"</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(df[<span class="st">"sum_of_imp"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.log(x <span class="op">+</span> <span class="dv">1</span>)), df[<span class="st">"TARGET"</span>], nbins<span class="op">=</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/imp-sum-output-1.png" id="imp-sum" class="img-fluid"></p>
</div>
</div></div>
</section>
</section>
</section>
<section id="delta" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="delta">Delta</h3>
<p>O nome da coluna sugere que seja algum tipo de variação. Assim, também assumimos que se trata de uma variável numérica. Mesmo que haja poucos valores únicos, aqueles que são diferentes de zero são, em geral, negativos ou decimais.</p>
<p>Diferentemente dos demais subconjuntos estudados até o momento, acredita-se haver valores nulos neste subconjunto, mas que foram preenchidos com 9999999999. Todas as colunas deste subconjunto compartilham este valor como valor máximo, sendo que ao removê-lo o maior valor máximo é de 8. Um transformador customizado foi criado para preencher estes valores falsos com <em>np.nan</em>.</p>
<p>Em seguida, foi criado um transformador para contar valores nulos neste subconjunto, mas a variável criada não aparenta ter poder de discriminação, assim como a contagem de não-zeros e a soma total.</p>
<p>Como lidar com valores nulos varia para cada problema e seu respectivo conjunto de dados. O próprio <em>sklearn</em> implementa <em>KNN</em> para preencher campos vazios. Essa abordagem é funcional pois as distâncias dos vizinhos mais próximos de uma determinada observação serão calculadas com base apenas em suas variáveis devidamente preenchidas.</p>
<p>Contudo, o <em>KNNImputer</em> precisa de uma série de preprocessamentos e considerações antes do uso:</p>
<ul>
<li><p>Medida de distância razoável para os tipos das variáveis no conjunto de dados.</p></li>
<li><p>Pré-processamento cuidadoso, ajustando a escala das variáveis de forma que façam sentido para a medida de distância escolhida.</p></li>
<li><p>Tratamento da multicolinearidade, pois variáveis com forte correlação aumentam a distância entre observações sem agregar mais informação.</p></li>
</ul>
<p>Um processamento cauteloso dos dados envolveria estudar cada variável individualmente para entender sua distribuição e, então, tomar as decisões necessárias sobre seu preprocessamento.</p>
<p>Assim, para as etapas de classificação e rankeamento, optou-se por usar apenas modelos baseados em árvore.</p>
<p>A escolha do modelo usado também afeta na decisão de como tratar os valores faltantes. No <em>sklearn</em>, árvores de decisão e modelos de <em>boosting</em> têm uma estratégia própria para lidar com valores faltantes. Em cada nó, os algoritmos encontram o <em>split</em> que minimiza a função de custo desconsiderando valores faltantes. Encontrado este split, os modelos testam em qual dos nós filhos as observações com valores faltantes devem ser alocadas: o nó filho que minimiza a função de custo é o escolhido. Estes modelos também testam se o melhor <em>split</em> é, na verdade, separar faltantes de preenchidos, eliminando também a necessidade de criar uma <em>flag</em> para nulo em determinada coluna.</p>
<p>Contudo, a implementação de florestas aleatórias do <em>sklearn</em> ainda não oferece esta funcionalidade. Neste caso, optou-se por preencher os valores faltantes com a mediana. Dada a distribuição das variáveis (avaliadas pelo <em>df.describe</em> deste prefixo), preencher os dados com a mediana é essencialmente o mesmo que preenche-los com 0, pois são dados extremamente esparsos.</p>
<p>Já no caso da análise de agrupamentos, optou-se por realizar o preprocessamento mesmo que grosseiramente e de forma generalizada, imputando valores faltantes com o KNNImputer. Mais sobre as tomadas de decisão são discutidas em <em>03-cluster.ipynb</em>.</p>
<p>Percebe-se também que valores nulos tendem a aparecer em mais de uma variável para uma mesma observação, mas apenas entre variáveis com nomes semelhantes – corroborando a ideia de que muitas das variáveis estão diretamente relacionadas umas com as outras.</p>
<p>Foram criadas variáveis de contagem de nulos, contagem de valores diferentes de zero e soma do subconjunto, sendo que nenhuma delas parece ter poder de discriminação.</p>
<section id="verificações-generalizadas-2" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="verificações-generalizadas-2">Verificações generalizadas</h4>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [15]:</pre></div><div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>delta_cols <span class="op">=</span> [</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col.startswith(<span class="st">"delta"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>df[delta_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">delta_imp_amort_var18_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_venta_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_venta_var44_1y3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
<td>5.701500e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>1.753924e+05</td>
<td>4.823292e+07</td>
<td>5.963343e+06</td>
<td>1.753924e+05</td>
<td>9.997369e+06</td>
<td>5.086381e+06</td>
<td>2.280102e+06</td>
<td>7.015698e+05</td>
<td>5.261773e+05</td>
<td>5.261773e+05</td>
<td>1.753924e+05</td>
<td>6.314128e+06</td>
<td>4.823292e+07</td>
<td>5.963343e+06</td>
<td>1.753924e+05</td>
<td>9.997369e+06</td>
<td>6.314128e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>4.187988e+07</td>
<td>6.928284e+08</td>
<td>2.441289e+08</td>
<td>4.187988e+07</td>
<td>3.160308e+08</td>
<td>2.254747e+08</td>
<td>1.509842e+08</td>
<td>8.375756e+07</td>
<td>7.253681e+07</td>
<td>7.253681e+07</td>
<td>4.187988e+07</td>
<td>2.512021e+08</td>
<td>6.928284e+08</td>
<td>2.441289e+08</td>
<td>4.187988e+07</td>
<td>3.160308e+08</td>
<td>2.512021e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>0.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>0.000000e+00</td>
<td>-1.000000e+00</td>
<td>0.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
<td>-1.000000e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
<td>1.000000e+10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [16]:</pre></div><div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df[delta_cols] <span class="op">\</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    .nunique() <span class="op">\</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    .sort_values() <span class="op">\</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    .rename(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        mapper<span class="op">=</span>{</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"index"</span>: <span class="st">"Column"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>: <span class="st">"Number of unique values"</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Number of unique values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>delta_imp_amort_var18_1y3</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>delta_imp_trasp_var33_out_1y3</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>delta_imp_reemb_var13_1y3</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>delta_imp_trasp_var17_out_1y3</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>delta_imp_reemb_var17_1y3</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>delta_imp_trasp_var17_in_1y3</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>delta_imp_trasp_var33_in_1y3</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>delta_num_aport_var17_1y3</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>delta_imp_aport_var17_1y3</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>delta_imp_venta_var44_1y3</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>delta_num_aport_var13_1y3</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>delta_num_aport_var33_1y3</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>delta_num_venta_var44_1y3</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>delta_num_compra_var44_1y3</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>delta_imp_aport_var33_1y3</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>delta_imp_compra_var44_1y3</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>delta_imp_aport_var13_1y3</td>
<td>22</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [17]:</pre></div><div class="cell" data-execution_count="17">
<details open="">
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ci_delta <span class="op">=</span> CustomImputer(prefix<span class="op">=</span><span class="st">"delta"</span>, to_replace<span class="op">=</span><span class="dv">9999999999</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ci_delta <span class="op">=</span> ci_delta.fit(df)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ci_delta.transform(df)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>df[delta_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="delta-describe" class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">delta_imp_amort_var18_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_reemb_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var17_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_in_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_trasp_var33_out_1y3</th>
<th data-quarto-table-cell-role="th">delta_imp_venta_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var13_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var17_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_aport_var33_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_compra_var44_1y3</th>
<th data-quarto-table-cell-role="th">delta_num_venta_var44_1y3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>57014.0</td>
<td>56740.000000</td>
<td>56981.000000</td>
<td>57014.000000</td>
<td>56958.000000</td>
<td>56986.0</td>
<td>57002.000000</td>
<td>57011.000000</td>
<td>57012.0</td>
<td>57012.000000</td>
<td>57014.0</td>
<td>56979.000000</td>
<td>56740.000000</td>
<td>56981.000000</td>
<td>57014.000000</td>
<td>56958.000000</td>
<td>56979.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.0</td>
<td>-0.022012</td>
<td>-0.000219</td>
<td>-0.000247</td>
<td>0.000009</td>
<td>0.0</td>
<td>-0.000018</td>
<td>-0.000035</td>
<td>0.0</td>
<td>-0.000053</td>
<td>0.0</td>
<td>0.000078</td>
<td>-0.022259</td>
<td>-0.000246</td>
<td>-0.000202</td>
<td>0.000050</td>
<td>0.000123</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.0</td>
<td>0.152221</td>
<td>0.016886</td>
<td>0.015401</td>
<td>0.036869</td>
<td>0.0</td>
<td>0.004188</td>
<td>0.005923</td>
<td>0.0</td>
<td>0.007254</td>
<td>0.0</td>
<td>0.023077</td>
<td>0.147766</td>
<td>0.015673</td>
<td>0.014046</td>
<td>0.030126</td>
<td>0.033775</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.0</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>0.0</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>0.0</td>
<td>-1.000000</td>
<td>0.0</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>0.0</td>
<td>5.500000</td>
<td>1.500000</td>
<td>0.000000</td>
<td>6.267608</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.0</td>
<td>0.000000</td>
<td>0.0</td>
<td>5.417098</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>4.000000</td>
<td>8.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [18]:</pre></div><div id="delta-missing" class="cell" data-execution_count="18">
<details open="">
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Biblioteca missingno, disponível no PyPi</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>mno.matrix(df[delta_cols])</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>mno.dendrogram(df[delta_cols])</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/delta-missing-output-1.png" id="delta-missing-1" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/delta-missing-output-2.png" id="delta-missing-2" class="img-fluid"></p>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [19]:</pre></div><div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>neg_pos_zero(df, delta_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Negative values (%)</th>
<th data-quarto-table-cell-role="th">Positive values (%)</th>
<th data-quarto-table-cell-role="th">Zero values (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>delta_imp_amort_var18_1y3</td>
<td>0.000000</td>
<td>0.000000</td>
<td>99.998246</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>delta_imp_trasp_var33_out_1y3</td>
<td>0.000000</td>
<td>0.000000</td>
<td>99.998246</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>delta_imp_reemb_var13_1y3</td>
<td>0.000000</td>
<td>0.000000</td>
<td>99.949136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>delta_imp_trasp_var17_out_1y3</td>
<td>0.000000</td>
<td>0.000000</td>
<td>99.994738</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>delta_imp_reemb_var17_1y3</td>
<td>0.001754</td>
<td>0.000000</td>
<td>99.975445</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>delta_imp_venta_var44_1y3</td>
<td>0.001754</td>
<td>0.001754</td>
<td>99.933351</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>delta_num_venta_var44_1y3</td>
<td>0.001754</td>
<td>0.001754</td>
<td>99.933351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>delta_imp_trasp_var17_in_1y3</td>
<td>0.003508</td>
<td>0.000000</td>
<td>99.989476</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>delta_imp_trasp_var33_in_1y3</td>
<td>0.005262</td>
<td>0.000000</td>
<td>99.989476</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>delta_num_compra_var44_1y3</td>
<td>0.019293</td>
<td>0.010524</td>
<td>99.870210</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>delta_num_aport_var33_1y3</td>
<td>0.021047</td>
<td>0.000000</td>
<td>99.977199</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>delta_imp_aport_var17_1y3</td>
<td>0.024555</td>
<td>0.001754</td>
<td>99.914058</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>delta_num_aport_var17_1y3</td>
<td>0.024555</td>
<td>0.000000</td>
<td>99.915812</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>delta_imp_compra_var44_1y3</td>
<td>0.026309</td>
<td>0.012277</td>
<td>99.861440</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>delta_imp_aport_var33_1y3</td>
<td>0.026309</td>
<td>0.000000</td>
<td>99.971937</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>delta_num_aport_var13_1y3</td>
<td>2.218714</td>
<td>0.003508</td>
<td>97.295449</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>delta_imp_aport_var13_1y3</td>
<td>2.238008</td>
<td>0.017539</td>
<td>97.262124</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
</section>
<section id="feature-engineering-2" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="feature-engineering-2">Feature Engineering</h4>
<section id="contagem-de-nulos" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="contagem-de-nulos">Contagem de nulos</h5>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [20]:</pre></div><div class="cell" data-execution_count="20">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>anc_delta <span class="op">=</span> AddNoneCount(prefix<span class="op">=</span><span class="st">"delta"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>anc_delta <span class="op">=</span> anc_delta.fit(df)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anc_delta.transform(df)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"none_count_delta"</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(df[col], df[<span class="st">"TARGET"</span>], nbins<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/delta-missingcount-output-1.png" id="delta-missingcount" class="img-fluid"></p>
</div>
</div></div>
</section>
<section id="contagem-de-colunas-diferentes-de-0-2" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="contagem-de-colunas-diferentes-de-0-2">Contagem de colunas diferentes de 0</h5>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [21]:</pre></div><div class="cell" data-execution_count="21">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>anzc_delta <span class="op">=</span> AddNonZeroCount(prefix<span class="op">=</span><span class="st">"delta"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>anzc_delta <span class="op">=</span> anzc_delta.fit(df)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anzc_delta.transform(df)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"non_zero_count_delta"</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(df[col], df[<span class="st">"TARGET"</span>], nbins<span class="op">=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/delta-nonzero-output-1.png" id="delta-nonzero" class="img-fluid"></p>
</div>
</div></div>
</section>
<section id="soma-total-das-colunas-2" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="soma-total-das-colunas-2">Soma total das colunas</h5>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [22]:</pre></div><div class="cell" data-execution_count="22">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>cs_delta <span class="op">=</span> CustomSum(prefix<span class="op">=</span><span class="st">"delta"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cs_delta <span class="op">=</span> cs_delta.fit(df)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> cs_delta.transform(df)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"sum_of_delta"</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(df[col], df[<span class="st">"TARGET"</span>], nbins<span class="op">=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/delta-sum-output-1.png" id="delta-sum" class="img-fluid"></p>
</div>
</div></div>
</section>
</section>
</section>
<section id="ind" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="ind">Ind</h3>
<p>Estas variáveis são compostas exclusivamente por valores de 0 e 1, ou seja, são variáveis binárias. Não há nenhum outlier que chame a atenção ou levante suspeitas de ser, na verdade, algum valor faltante.</p>
<p>Foi criada a coluna de contagem de valores diferentes de zero e percebe-se que observações com “TARGET” = 1 se concentram em valores mais baixos de contagem.</p>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [23]:</pre></div><div class="cell" data-execution_count="23">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ind_cols <span class="op">=</span> [</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col.startswith(<span class="st">"ind"</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>df[ind_cols].describe().loc[[<span class="st">"min"</span>, <span class="st">"max"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="ind-describe" class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ind_var1_0</th>
<th data-quarto-table-cell-role="th">ind_var1</th>
<th data-quarto-table-cell-role="th">ind_var5_0</th>
<th data-quarto-table-cell-role="th">ind_var5</th>
<th data-quarto-table-cell-role="th">ind_var8_0</th>
<th data-quarto-table-cell-role="th">ind_var8</th>
<th data-quarto-table-cell-role="th">ind_var12_0</th>
<th data-quarto-table-cell-role="th">ind_var12</th>
<th data-quarto-table-cell-role="th">ind_var13_0</th>
<th data-quarto-table-cell-role="th">ind_var13_corto_0</th>
<th data-quarto-table-cell-role="th">ind_var13_corto</th>
<th data-quarto-table-cell-role="th">ind_var13_largo_0</th>
<th data-quarto-table-cell-role="th">ind_var13_largo</th>
<th data-quarto-table-cell-role="th">ind_var13</th>
<th data-quarto-table-cell-role="th">ind_var14_0</th>
<th data-quarto-table-cell-role="th">ind_var14</th>
<th data-quarto-table-cell-role="th">ind_var17_0</th>
<th data-quarto-table-cell-role="th">ind_var17</th>
<th data-quarto-table-cell-role="th">ind_var18</th>
<th data-quarto-table-cell-role="th">ind_var19</th>
<th data-quarto-table-cell-role="th">ind_var20_0</th>
<th data-quarto-table-cell-role="th">ind_var20</th>
<th data-quarto-table-cell-role="th">ind_var24_0</th>
<th data-quarto-table-cell-role="th">ind_var24</th>
<th data-quarto-table-cell-role="th">ind_var25_cte</th>
<th data-quarto-table-cell-role="th">ind_var26_cte</th>
<th data-quarto-table-cell-role="th">ind_var26</th>
<th data-quarto-table-cell-role="th">ind_var25</th>
<th data-quarto-table-cell-role="th">ind_var29_0</th>
<th data-quarto-table-cell-role="th">ind_var29</th>
<th data-quarto-table-cell-role="th">ind_var30_0</th>
<th data-quarto-table-cell-role="th">ind_var30</th>
<th data-quarto-table-cell-role="th">ind_var31_0</th>
<th data-quarto-table-cell-role="th">ind_var31</th>
<th data-quarto-table-cell-role="th">ind_var32_cte</th>
<th data-quarto-table-cell-role="th">ind_var32</th>
<th data-quarto-table-cell-role="th">ind_var33_0</th>
<th data-quarto-table-cell-role="th">ind_var33</th>
<th data-quarto-table-cell-role="th">ind_var37_cte</th>
<th data-quarto-table-cell-role="th">ind_var37</th>
<th data-quarto-table-cell-role="th">ind_var39_0</th>
<th data-quarto-table-cell-role="th">ind_var40_0</th>
<th data-quarto-table-cell-role="th">ind_var41_0</th>
<th data-quarto-table-cell-role="th">ind_var39</th>
<th data-quarto-table-cell-role="th">ind_var44_0</th>
<th data-quarto-table-cell-role="th">ind_var44</th>
<th data-quarto-table-cell-role="th">ind_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">ind_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">ind_var10_ult1</th>
<th data-quarto-table-cell-role="th">ind_var10cte_ult1</th>
<th data-quarto-table-cell-role="th">ind_var9_cte_ult1</th>
<th data-quarto-table-cell-role="th">ind_var9_ult1</th>
<th data-quarto-table-cell-role="th">ind_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">ind_var43_recib_ult1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [24]:</pre></div><div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df[ind_cols].nunique().<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>2</code></pre>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [25]:</pre></div><div class="cell" data-execution_count="25">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>anzc_ind <span class="op">=</span> AddNonZeroCount(prefix<span class="op">=</span><span class="st">"ind"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>anzc_ind <span class="op">=</span> anzc_ind.fit(df)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anzc_ind.transform(df)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"non_zero_count_ind"</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(df[col], df[<span class="st">"TARGET"</span>], nbins<span class="op">=</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/ind-nonzero-output-1.png" id="ind-nonzero" class="img-fluid"></p>
</div>
</div></div>
</section>
<section id="num" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="num">Num</h3>
<p>O prefixo indica que as variáveis sejam uma contagem (“número de vendas”, “número de recibos”). O fato de não haver nenhum valor negativo nem nenhum número decimal corrobora com esta ideia. Também não há um valor exorbitante comum entre as colunas, indicando que estes dados não tiveram valores faltantes preenchidos artificialmente.</p>
<p>Percebe-se que tanto na contagem de valores diferentes de zero quanto na soma do subconjunto, clientes insatisfeitos se concentram de forma diferente de clientes satisfeitos.</p>
<section id="verificações-generalizadas-3" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="verificações-generalizadas-3">Verificações generalizadas</h4>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [26]:</pre></div><div class="cell" data-execution_count="26">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>num_cols <span class="op">=</span> [</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col.startswith(<span class="st">"num"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>df[num_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="num-describe" class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">num_var1_0</th>
<th data-quarto-table-cell-role="th">num_var1</th>
<th data-quarto-table-cell-role="th">num_var4</th>
<th data-quarto-table-cell-role="th">num_var5_0</th>
<th data-quarto-table-cell-role="th">num_var5</th>
<th data-quarto-table-cell-role="th">num_var8_0</th>
<th data-quarto-table-cell-role="th">num_var8</th>
<th data-quarto-table-cell-role="th">num_var12_0</th>
<th data-quarto-table-cell-role="th">num_var12</th>
<th data-quarto-table-cell-role="th">num_var13_0</th>
<th data-quarto-table-cell-role="th">num_var13_corto_0</th>
<th data-quarto-table-cell-role="th">num_var13_corto</th>
<th data-quarto-table-cell-role="th">num_var13_largo_0</th>
<th data-quarto-table-cell-role="th">num_var13_largo</th>
<th data-quarto-table-cell-role="th">num_var13</th>
<th data-quarto-table-cell-role="th">num_var14_0</th>
<th data-quarto-table-cell-role="th">num_var14</th>
<th data-quarto-table-cell-role="th">num_var17_0</th>
<th data-quarto-table-cell-role="th">num_var17</th>
<th data-quarto-table-cell-role="th">num_var18</th>
<th data-quarto-table-cell-role="th">num_var20_0</th>
<th data-quarto-table-cell-role="th">num_var20</th>
<th data-quarto-table-cell-role="th">num_var24_0</th>
<th data-quarto-table-cell-role="th">num_var24</th>
<th data-quarto-table-cell-role="th">num_var26</th>
<th data-quarto-table-cell-role="th">num_var25</th>
<th data-quarto-table-cell-role="th">num_op_var40_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var40_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var40_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var41_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var41_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_hace2</th>
<th data-quarto-table-cell-role="th">num_op_var39_hace3</th>
<th data-quarto-table-cell-role="th">num_op_var39_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_ult3</th>
<th data-quarto-table-cell-role="th">num_var29_0</th>
<th data-quarto-table-cell-role="th">num_var29</th>
<th data-quarto-table-cell-role="th">num_var30_0</th>
<th data-quarto-table-cell-role="th">num_var30</th>
<th data-quarto-table-cell-role="th">num_var31_0</th>
<th data-quarto-table-cell-role="th">num_var31</th>
<th data-quarto-table-cell-role="th">num_var32</th>
<th data-quarto-table-cell-role="th">num_var33_0</th>
<th data-quarto-table-cell-role="th">num_var33</th>
<th data-quarto-table-cell-role="th">num_var35</th>
<th data-quarto-table-cell-role="th">num_var37_med_ult2</th>
<th data-quarto-table-cell-role="th">num_var37</th>
<th data-quarto-table-cell-role="th">num_var39_0</th>
<th data-quarto-table-cell-role="th">num_var40_0</th>
<th data-quarto-table-cell-role="th">num_var41_0</th>
<th data-quarto-table-cell-role="th">num_var39</th>
<th data-quarto-table-cell-role="th">num_var42_0</th>
<th data-quarto-table-cell-role="th">num_var42</th>
<th data-quarto-table-cell-role="th">num_var44_0</th>
<th data-quarto-table-cell-role="th">num_var44</th>
<th data-quarto-table-cell-role="th">num_aport_var13_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var13_ult1</th>
<th data-quarto-table-cell-role="th">num_aport_var17_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var17_ult1</th>
<th data-quarto-table-cell-role="th">num_aport_var33_hace3</th>
<th data-quarto-table-cell-role="th">num_aport_var33_ult1</th>
<th data-quarto-table-cell-role="th">num_var7_emit_ult1</th>
<th data-quarto-table-cell-role="th">num_var7_recib_ult1</th>
<th data-quarto-table-cell-role="th">num_compra_var44_hace3</th>
<th data-quarto-table-cell-role="th">num_compra_var44_ult1</th>
<th data-quarto-table-cell-role="th">num_ent_var16_ult1</th>
<th data-quarto-table-cell-role="th">num_var22_hace2</th>
<th data-quarto-table-cell-role="th">num_var22_hace3</th>
<th data-quarto-table-cell-role="th">num_var22_ult1</th>
<th data-quarto-table-cell-role="th">num_var22_ult3</th>
<th data-quarto-table-cell-role="th">num_med_var22_ult3</th>
<th data-quarto-table-cell-role="th">num_med_var45_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var5_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var8_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var12_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var13_corto_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var13_largo_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var17_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var29_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var33_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var39_vig_ult3</th>
<th data-quarto-table-cell-role="th">num_meses_var44_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var40_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var40_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var40_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_comer_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_comer_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var41_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var41_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_op_var39_efect_ult1</th>
<th data-quarto-table-cell-role="th">num_op_var39_efect_ult3</th>
<th data-quarto-table-cell-role="th">num_reemb_var13_ult1</th>
<th data-quarto-table-cell-role="th">num_reemb_var17_hace3</th>
<th data-quarto-table-cell-role="th">num_reemb_var17_ult1</th>
<th data-quarto-table-cell-role="th">num_sal_var16_ult1</th>
<th data-quarto-table-cell-role="th">num_var43_emit_ult1</th>
<th data-quarto-table-cell-role="th">num_var43_recib_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var11_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_in_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_in_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var17_out_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_in_hace3</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_in_ult1</th>
<th data-quarto-table-cell-role="th">num_trasp_var33_out_ult1</th>
<th data-quarto-table-cell-role="th">num_venta_var44_hace3</th>
<th data-quarto-table-cell-role="th">num_venta_var44_ult1</th>
<th data-quarto-table-cell-role="th">num_var45_hace2</th>
<th data-quarto-table-cell-role="th">num_var45_hace3</th>
<th data-quarto-table-cell-role="th">num_var45_ult1</th>
<th data-quarto-table-cell-role="th">num_var45_ult3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.00000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.00000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.00000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.033517</td>
<td>0.010524</td>
<td>1.081312</td>
<td>2.894712</td>
<td>1.999105</td>
<td>0.098763</td>
<td>0.085977</td>
<td>0.212839</td>
<td>0.139069</td>
<td>0.168956</td>
<td>0.129966</td>
<td>0.124283</td>
<td>0.038990</td>
<td>0.036885</td>
<td>0.161168</td>
<td>0.073402</td>
<td>0.016259</td>
<td>0.012681</td>
<td>0.009471</td>
<td>0.000053</td>
<td>0.010366</td>
<td>0.007524</td>
<td>0.129071</td>
<td>0.115285</td>
<td>0.089976</td>
<td>0.085977</td>
<td>0.021415</td>
<td>0.001210</td>
<td>0.054828</td>
<td>0.077453</td>
<td>1.619521</td>
<td>0.092555</td>
<td>2.867929</td>
<td>4.580005</td>
<td>1.640937</td>
<td>0.093765</td>
<td>2.922757</td>
<td>4.657459</td>
<td>0.000421</td>
<td>0.000105</td>
<td>3.375691</td>
<td>2.385425</td>
<td>0.020784</td>
<td>0.016417</td>
<td>0.003999</td>
<td>0.00221</td>
<td>0.001684</td>
<td>3.304499</td>
<td>0.268719</td>
<td>0.425046</td>
<td>2.724809</td>
<td>0.033465</td>
<td>2.699658</td>
<td>0.010471</td>
<td>3.206735</td>
<td>2.219258</td>
<td>0.005893</td>
<td>0.005262</td>
<td>0.077295</td>
<td>0.017890</td>
<td>0.001421</td>
<td>0.003631</td>
<td>0.001000</td>
<td>0.000316</td>
<td>0.000158</td>
<td>0.010629</td>
<td>0.001736</td>
<td>0.008945</td>
<td>0.182426</td>
<td>1.307656</td>
<td>1.191213</td>
<td>0.567535</td>
<td>3.066404</td>
<td>0.642620</td>
<td>4.029361</td>
<td>1.979374</td>
<td>0.053688</td>
<td>0.102885</td>
<td>0.098676</td>
<td>0.018381</td>
<td>0.002947</td>
<td>0.00014</td>
<td>0.001245</td>
<td>1.592809</td>
<td>0.003560</td>
<td>2.195633</td>
<td>3.611313</td>
<td>0.068403</td>
<td>0.129071</td>
<td>0.002105</td>
<td>0.003368</td>
<td>2.12723</td>
<td>3.482242</td>
<td>0.715022</td>
<td>1.206262</td>
<td>0.717127</td>
<td>1.209629</td>
<td>0.001526</td>
<td>0.000053</td>
<td>0.001052</td>
<td>0.005157</td>
<td>0.394002</td>
<td>0.815259</td>
<td>0.120442</td>
<td>0.000158</td>
<td>0.000210</td>
<td>0.000158</td>
<td>0.000158</td>
<td>0.000210</td>
<td>0.000053</td>
<td>0.000105</td>
<td>0.005525</td>
<td>5.412155</td>
<td>3.887240</td>
<td>4.371902</td>
<td>13.671297</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.315827</td>
<td>0.177371</td>
<td>0.912384</td>
<td>0.655596</td>
<td>1.431735</td>
<td>0.535590</td>
<td>0.500544</td>
<td>0.921900</td>
<td>0.640704</td>
<td>0.746919</td>
<td>0.617687</td>
<td>0.598101</td>
<td>0.409706</td>
<td>0.386513</td>
<td>0.714767</td>
<td>0.654402</td>
<td>0.225918</td>
<td>0.388061</td>
<td>0.302956</td>
<td>0.012564</td>
<td>0.176040</td>
<td>0.150056</td>
<td>0.612357</td>
<td>0.577511</td>
<td>0.624008</td>
<td>0.609736</td>
<td>0.975323</td>
<td>0.205295</td>
<td>1.901246</td>
<td>2.729616</td>
<td>7.435993</td>
<td>1.195419</td>
<td>11.003501</td>
<td>17.084495</td>
<td>7.511256</td>
<td>1.212827</td>
<td>11.226281</td>
<td>17.374287</td>
<td>0.035534</td>
<td>0.017768</td>
<td>1.357028</td>
<td>1.644851</td>
<td>0.429071</td>
<td>0.341847</td>
<td>0.128067</td>
<td>0.09566</td>
<td>0.077432</td>
<td>2.876147</td>
<td>1.648699</td>
<td>2.247020</td>
<td>1.137049</td>
<td>0.315582</td>
<td>1.103534</td>
<td>0.176929</td>
<td>0.973878</td>
<td>1.499418</td>
<td>0.134018</td>
<td>0.125531</td>
<td>0.562886</td>
<td>0.297313</td>
<td>0.098118</td>
<td>0.177201</td>
<td>0.072168</td>
<td>0.035535</td>
<td>0.021761</td>
<td>0.230743</td>
<td>0.096491</td>
<td>0.356584</td>
<td>0.989789</td>
<td>3.482298</td>
<td>3.269985</td>
<td>2.136909</td>
<td>6.260567</td>
<td>1.853569</td>
<td>10.853226</td>
<td>1.298381</td>
<td>0.334850</td>
<td>0.489703</td>
<td>0.485321</td>
<td>0.219571</td>
<td>0.077167</td>
<td>0.01567</td>
<td>0.056950</td>
<td>0.718959</td>
<td>0.086671</td>
<td>9.218574</td>
<td>15.030522</td>
<td>2.092828</td>
<td>4.201767</td>
<td>0.138759</td>
<td>0.204886</td>
<td>8.89960</td>
<td>14.306734</td>
<td>3.210513</td>
<td>5.179312</td>
<td>3.220403</td>
<td>5.198728</td>
<td>0.067642</td>
<td>0.012564</td>
<td>0.100507</td>
<td>0.160816</td>
<td>2.182773</td>
<td>3.415429</td>
<td>1.209621</td>
<td>0.028094</td>
<td>0.025127</td>
<td>0.021761</td>
<td>0.021761</td>
<td>0.030775</td>
<td>0.012564</td>
<td>0.017768</td>
<td>0.303314</td>
<td>14.494831</td>
<td>10.326638</td>
<td>14.180760</td>
<td>33.076786</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>2.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>2.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>12.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>6.000000</td>
<td>3.000000</td>
<td>7.000000</td>
<td>15.000000</td>
<td>15.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>111.000000</td>
<td>15.000000</td>
<td>15.000000</td>
<td>6.000000</td>
<td>6.000000</td>
<td>15.000000</td>
<td>15.000000</td>
<td>15.000000</td>
<td>111.000000</td>
<td>12.000000</td>
<td>36.000000</td>
<td>27.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>9.000000</td>
<td>6.000000</td>
<td>33.000000</td>
<td>33.000000</td>
<td>117.000000</td>
<td>48.000000</td>
<td>234.000000</td>
<td>351.000000</td>
<td>249.000000</td>
<td>81.000000</td>
<td>468.000000</td>
<td>468.000000</td>
<td>249.000000</td>
<td>81.000000</td>
<td>468.000000</td>
<td>468.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>114.000000</td>
<td>33.000000</td>
<td>36.000000</td>
<td>27.000000</td>
<td>6.000000</td>
<td>12.00000</td>
<td>6.000000</td>
<td>36.000000</td>
<td>90.000000</td>
<td>111.000000</td>
<td>33.000000</td>
<td>6.000000</td>
<td>33.000000</td>
<td>3.000000</td>
<td>114.000000</td>
<td>18.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>24.000000</td>
<td>30.000000</td>
<td>12.000000</td>
<td>21.000000</td>
<td>12.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>24.000000</td>
<td>9.000000</td>
<td>39.000000</td>
<td>60.000000</td>
<td>123.000000</td>
<td>108.000000</td>
<td>96.000000</td>
<td>234.000000</td>
<td>78.000000</td>
<td>267.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>2.00000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>438.000000</td>
<td>600.000000</td>
<td>210.000000</td>
<td>582.000000</td>
<td>24.000000</td>
<td>24.000000</td>
<td>438.00000</td>
<td>438.000000</td>
<td>90.000000</td>
<td>156.000000</td>
<td>90.000000</td>
<td>156.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>21.000000</td>
<td>15.000000</td>
<td>102.000000</td>
<td>159.000000</td>
<td>93.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>39.000000</td>
<td>342.000000</td>
<td>333.000000</td>
<td>510.000000</td>
<td>801.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [27]:</pre></div><div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df[num_cols] <span class="op">\</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    .nunique() <span class="op">\</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    .nlargest(<span class="dv">10</span>) <span class="op">\</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    .rename(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        mapper<span class="op">=</span>{</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"index"</span>: <span class="st">"Column"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>: <span class="st">"Number of unique values"</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Number of unique values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>num_var45_ult3</td>
<td>157</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>num_op_var39_ult3</td>
<td>95</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>num_op_var41_ult3</td>
<td>92</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>num_op_var39_comer_ult3</td>
<td>88</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>num_op_var41_comer_ult3</td>
<td>85</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>num_var45_ult1</td>
<td>85</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>num_var45_hace2</td>
<td>76</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>num_op_var39_ult1</td>
<td>66</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>num_med_var45_ult3</td>
<td>64</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>num_op_var41_ult1</td>
<td>62</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [28]:</pre></div><div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>nfloat <span class="op">=</span> df[num_cols].applymap(<span class="kw">lambda</span> x: <span class="dv">0</span> <span class="cf">if</span> x<span class="op">%</span><span class="dv">1</span> <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">1</span>).<span class="bu">sum</span>().<span class="bu">sum</span>()</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Contagem de números decimais: </span><span class="sc">{</span>nfloat<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Contagem de números decimais: 0</code></pre>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [29]:</pre></div><div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>neg_pos_zero(df, num_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Negative values (%)</th>
<th data-quarto-table-cell-role="th">Positive values (%)</th>
<th data-quarto-table-cell-role="th">Zero values (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>num_var1_0</td>
<td>0</td>
<td>1.115496</td>
<td>98.884504</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">84</td>
<td>num_meses_var44_ult3</td>
<td>0</td>
<td>0.194686</td>
<td>99.805314</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83</td>
<td>num_meses_var39_vig_ult3</td>
<td>0</td>
<td>86.671928</td>
<td>13.328072</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">82</td>
<td>num_meses_var33_ult3</td>
<td>0</td>
<td>0.050864</td>
<td>99.949136</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">81</td>
<td>num_meses_var29_ult3</td>
<td>0</td>
<td>0.008770</td>
<td>99.991230</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">80</td>
<td>num_meses_var17_ult3</td>
<td>0</td>
<td>0.164869</td>
<td>99.835131</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">79</td>
<td>num_meses_var13_largo_ult3</td>
<td>0</td>
<td>0.748926</td>
<td>99.251074</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">78</td>
<td>num_meses_var13_corto_ult3</td>
<td>0</td>
<td>4.279576</td>
<td>95.720424</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77</td>
<td>num_meses_var12_ult3</td>
<td>0</td>
<td>4.612821</td>
<td>95.387179</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76</td>
<td>num_meses_var8_ult3</td>
<td>0</td>
<td>2.922038</td>
<td>97.077962</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75</td>
<td>num_meses_var5_ult3</td>
<td>0</td>
<td>73.007103</td>
<td>26.992897</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">74</td>
<td>num_med_var45_ult3</td>
<td>0</td>
<td>32.458125</td>
<td>67.541875</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">73</td>
<td>num_med_var22_ult3</td>
<td>0</td>
<td>15.001315</td>
<td>84.998685</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">72</td>
<td>num_var22_ult3</td>
<td>0</td>
<td>34.452337</td>
<td>65.547663</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">71</td>
<td>num_var22_ult1</td>
<td>0</td>
<td>10.709462</td>
<td>89.290538</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">70</td>
<td>num_var22_hace3</td>
<td>0</td>
<td>18.733667</td>
<td>81.266333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">69</td>
<td>num_var22_hace2</td>
<td>0</td>
<td>20.417434</td>
<td>79.582566</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">68</td>
<td>num_ent_var16_ult1</td>
<td>0</td>
<td>4.751381</td>
<td>95.248619</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">67</td>
<td>num_compra_var44_ult1</td>
<td>0</td>
<td>0.121021</td>
<td>99.878979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">66</td>
<td>num_compra_var44_hace3</td>
<td>0</td>
<td>0.038586</td>
<td>99.961414</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">65</td>
<td>num_var7_recib_ult1</td>
<td>0</td>
<td>0.284136</td>
<td>99.715864</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">64</td>
<td>num_var7_emit_ult1</td>
<td>0</td>
<td>0.005262</td>
<td>99.994738</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">63</td>
<td>num_aport_var33_ult1</td>
<td>0</td>
<td>0.008770</td>
<td>99.991230</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">62</td>
<td>num_aport_var33_hace3</td>
<td>0</td>
<td>0.026309</td>
<td>99.973691</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">61</td>
<td>num_aport_var17_ult1</td>
<td>0</td>
<td>0.063141</td>
<td>99.936859</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">60</td>
<td>num_aport_var17_hace3</td>
<td>0</td>
<td>0.028063</td>
<td>99.971937</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">85</td>
<td>num_op_var39_comer_ult1</td>
<td>0</td>
<td>13.017627</td>
<td>86.982373</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">59</td>
<td>num_aport_var13_ult1</td>
<td>0</td>
<td>0.524423</td>
<td>99.475577</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>num_op_var39_comer_ult3</td>
<td>0</td>
<td>15.339823</td>
<td>84.660177</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">88</td>
<td>num_op_var40_comer_ult3</td>
<td>0</td>
<td>0.427958</td>
<td>99.572042</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">113</td>
<td>num_var45_hace3</td>
<td>0</td>
<td>33.424537</td>
<td>66.575463</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">112</td>
<td>num_var45_hace2</td>
<td>0</td>
<td>35.773042</td>
<td>64.226958</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">111</td>
<td>num_venta_var44_ult1</td>
<td>0</td>
<td>0.064895</td>
<td>99.935105</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">110</td>
<td>num_venta_var44_hace3</td>
<td>0</td>
<td>0.003508</td>
<td>99.996492</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">109</td>
<td>num_trasp_var33_out_ult1</td>
<td>0</td>
<td>0.001754</td>
<td>99.998246</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">108</td>
<td>num_trasp_var33_in_ult1</td>
<td>0</td>
<td>0.005262</td>
<td>99.994738</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">107</td>
<td>num_trasp_var33_in_hace3</td>
<td>0</td>
<td>0.005262</td>
<td>99.994738</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">106</td>
<td>num_trasp_var17_out_ult1</td>
<td>0</td>
<td>0.005262</td>
<td>99.994738</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">105</td>
<td>num_trasp_var17_in_ult1</td>
<td>0</td>
<td>0.007016</td>
<td>99.992984</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">104</td>
<td>num_trasp_var17_in_hace3</td>
<td>0</td>
<td>0.003508</td>
<td>99.996492</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">103</td>
<td>num_trasp_var11_ult1</td>
<td>0</td>
<td>2.150311</td>
<td>97.849689</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">102</td>
<td>num_var43_recib_ult1</td>
<td>0</td>
<td>13.022889</td>
<td>86.977111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">101</td>
<td>num_var43_emit_ult1</td>
<td>0</td>
<td>6.664913</td>
<td>93.335087</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">100</td>
<td>num_sal_var16_ult1</td>
<td>0</td>
<td>0.131544</td>
<td>99.868456</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>num_reemb_var17_ult1</td>
<td>0</td>
<td>0.022801</td>
<td>99.977199</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>num_reemb_var17_hace3</td>
<td>0</td>
<td>0.001754</td>
<td>99.998246</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>num_reemb_var13_ult1</td>
<td>0</td>
<td>0.050864</td>
<td>99.949136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">96</td>
<td>num_op_var39_efect_ult3</td>
<td>0</td>
<td>11.319828</td>
<td>88.680172</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95</td>
<td>num_op_var39_efect_ult1</td>
<td>0</td>
<td>8.685434</td>
<td>91.314566</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">94</td>
<td>num_op_var41_efect_ult3</td>
<td>0</td>
<td>11.309305</td>
<td>88.690695</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">93</td>
<td>num_op_var41_efect_ult1</td>
<td>0</td>
<td>8.673156</td>
<td>91.326844</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">92</td>
<td>num_op_var41_comer_ult3</td>
<td>0</td>
<td>15.152153</td>
<td>84.847847</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">91</td>
<td>num_op_var41_comer_ult1</td>
<td>0</td>
<td>12.836973</td>
<td>87.163027</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>num_op_var40_efect_ult3</td>
<td>0</td>
<td>0.049110</td>
<td>99.950890</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">89</td>
<td>num_op_var40_efect_ult1</td>
<td>0</td>
<td>0.042094</td>
<td>99.957906</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">87</td>
<td>num_op_var40_comer_ult1</td>
<td>0</td>
<td>0.361308</td>
<td>99.638692</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>num_aport_var13_hace3</td>
<td>0</td>
<td>2.260809</td>
<td>97.739191</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">57</td>
<td>num_var44</td>
<td>0</td>
<td>0.175392</td>
<td>99.824608</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56</td>
<td>num_var44_0</td>
<td>0</td>
<td>0.194686</td>
<td>99.805314</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>num_var25</td>
<td>0</td>
<td>2.402876</td>
<td>97.597124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>num_var26</td>
<td>0</td>
<td>2.502850</td>
<td>97.497150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>num_var24</td>
<td>0</td>
<td>3.837587</td>
<td>96.162413</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>num_var24_0</td>
<td>0</td>
<td>4.279576</td>
<td>95.720424</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>num_var20</td>
<td>0</td>
<td>0.250811</td>
<td>99.749189</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>num_var20_0</td>
<td>0</td>
<td>0.345523</td>
<td>99.654477</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>num_var18</td>
<td>0</td>
<td>0.001754</td>
<td>99.998246</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>num_var17</td>
<td>0</td>
<td>0.152591</td>
<td>99.847409</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>num_var17_0</td>
<td>0</td>
<td>0.184162</td>
<td>99.815838</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>num_var14</td>
<td>0</td>
<td>0.533193</td>
<td>99.466807</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>num_var14_0</td>
<td>0</td>
<td>2.371306</td>
<td>97.628694</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>num_var13</td>
<td>0</td>
<td>5.126721</td>
<td>94.873279</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>num_var13_largo</td>
<td>0</td>
<td>1.052355</td>
<td>98.947645</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>num_var13_largo_0</td>
<td>0</td>
<td>1.069894</td>
<td>98.930106</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>num_var13_corto</td>
<td>0</td>
<td>4.141016</td>
<td>95.858984</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>num_var13_corto_0</td>
<td>0</td>
<td>4.284837</td>
<td>95.715163</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>num_var13_0</td>
<td>0</td>
<td>5.265281</td>
<td>94.734719</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>num_var12</td>
<td>0</td>
<td>4.575989</td>
<td>95.424011</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>num_var12_0</td>
<td>0</td>
<td>6.789441</td>
<td>93.210559</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>num_var8</td>
<td>0</td>
<td>2.865912</td>
<td>97.134088</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>num_var8_0</td>
<td>0</td>
<td>3.290362</td>
<td>96.709638</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>num_var5</td>
<td>0</td>
<td>66.379023</td>
<td>33.620977</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>num_var5_0</td>
<td>0</td>
<td>95.823906</td>
<td>4.176094</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>num_var4</td>
<td>0</td>
<td>74.317285</td>
<td>25.682715</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>num_var1</td>
<td>0</td>
<td>0.350785</td>
<td>99.649215</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>num_op_var40_hace2</td>
<td>0</td>
<td>0.133298</td>
<td>99.866702</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>num_op_var40_hace3</td>
<td>0</td>
<td>0.010524</td>
<td>99.989476</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>num_op_var40_ult1</td>
<td>0</td>
<td>0.285890</td>
<td>99.714110</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>num_op_var40_ult3</td>
<td>0</td>
<td>0.313952</td>
<td>99.686048</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">55</td>
<td>num_var42</td>
<td>0</td>
<td>71.191792</td>
<td>28.808208</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">54</td>
<td>num_var42_0</td>
<td>0</td>
<td>99.436990</td>
<td>0.563010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">53</td>
<td>num_var39</td>
<td>0</td>
<td>0.349031</td>
<td>99.650969</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">52</td>
<td>num_var41_0</td>
<td>0</td>
<td>87.959309</td>
<td>12.040691</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">51</td>
<td>num_var40_0</td>
<td>0</td>
<td>1.113742</td>
<td>98.886258</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50</td>
<td>num_var39_0</td>
<td>0</td>
<td>88.110146</td>
<td>11.889854</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">49</td>
<td>num_var37</td>
<td>0</td>
<td>6.596510</td>
<td>93.403490</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">48</td>
<td>num_var37_med_ult2</td>
<td>0</td>
<td>4.749627</td>
<td>95.250373</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">47</td>
<td>num_var35</td>
<td>0</td>
<td>74.317285</td>
<td>25.682715</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">46</td>
<td>num_var33</td>
<td>0</td>
<td>0.050864</td>
<td>99.949136</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">45</td>
<td>num_var33_0</td>
<td>0</td>
<td>0.064895</td>
<td>99.935105</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">44</td>
<td>num_var32</td>
<td>0</td>
<td>0.108743</td>
<td>99.891257</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">114</td>
<td>num_var45_ult1</td>
<td>0</td>
<td>28.469701</td>
<td>71.530299</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>num_var31</td>
<td>0</td>
<td>0.368324</td>
<td>99.631676</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41</td>
<td>num_var30</td>
<td>0</td>
<td>73.315794</td>
<td>26.684206</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">40</td>
<td>num_var30_0</td>
<td>0</td>
<td>99.561519</td>
<td>0.438481</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39</td>
<td>num_var29</td>
<td>0</td>
<td>0.003508</td>
<td>99.996492</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">38</td>
<td>num_var29_0</td>
<td>0</td>
<td>0.014031</td>
<td>99.985969</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">37</td>
<td>num_op_var39_ult3</td>
<td>0</td>
<td>18.105762</td>
<td>81.894238</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">36</td>
<td>num_op_var39_ult1</td>
<td>0</td>
<td>15.383671</td>
<td>84.616329</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35</td>
<td>num_op_var39_hace3</td>
<td>0</td>
<td>1.315443</td>
<td>98.684557</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>num_op_var39_hace2</td>
<td>0</td>
<td>11.077787</td>
<td>88.922213</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33</td>
<td>num_op_var41_ult3</td>
<td>0</td>
<td>17.961940</td>
<td>82.038060</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32</td>
<td>num_op_var41_ult1</td>
<td>0</td>
<td>15.239849</td>
<td>84.760151</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">31</td>
<td>num_op_var41_hace3</td>
<td>0</td>
<td>1.304920</td>
<td>98.695080</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30</td>
<td>num_op_var41_hace2</td>
<td>0</td>
<td>10.986582</td>
<td>89.013418</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>num_var31_0</td>
<td>0</td>
<td>0.427958</td>
<td>99.572042</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">115</td>
<td>num_var45_ult3</td>
<td>0</td>
<td>49.702710</td>
<td>50.297290</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
</section>
<section id="feature-engineering-3" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="feature-engineering-3">Feature Engineering</h4>
<section id="contagem-de-colunas-diferentes-de-0-3" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="contagem-de-colunas-diferentes-de-0-3">Contagem de colunas diferentes de 0</h5>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [30]:</pre></div><div class="cell" data-execution_count="30">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>anzc_num <span class="op">=</span> AddNonZeroCount(prefix<span class="op">=</span><span class="st">"num"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>anzc_num <span class="op">=</span> anzc_num.fit(df)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> anzc_num.transform(df)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"non_zero_count_num"</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    df[col].<span class="bu">apply</span>(np.log1p),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">15</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/num-nonzero-output-1.png" id="num-nonzero" class="img-fluid"></p>
</div>
</div></div>
</section>
<section id="soma-total-das-colunas-3" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="soma-total-das-colunas-3">Soma total das colunas</h5>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [31]:</pre></div><div class="cell" data-execution_count="31">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>cs_num <span class="op">=</span> CustomSum(prefix<span class="op">=</span><span class="st">"num"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>cs_num <span class="op">=</span> cs_num.fit(df)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> cs_num.transform(df)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"sum_of_num"</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    df[col].<span class="bu">apply</span>(np.log1p),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">16</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/num-sum-output-1.png" id="num-sum" class="img-fluid"></p>
</div>
</div></div>
</section>
</section>
</section>
<section id="demais-variáveis" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="demais-variáveis">Demais variáveis</h3>
<p>Por fim, foram encontradas variáveis sem prefixos. Como são poucas variáveis, optou-se por tratá-las uma a uma, pois sem prefixo não podemos assumir que se tratam de grandezas semelhantes nem que são do mesmo tipo (contínua, discreta, categórica, etc).</p>
<p>O ideal seria abordar todas as variáveis desta forma – não apenas individualmente, mas também tentando encontrar relações entre as variáveis.</p>
<section id="verificações-generalizadas-4" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="verificações-generalizadas-4">Verificações generalizadas</h4>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [32]:</pre></div><div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>remaining_cols <span class="op">=</span> [</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    col</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        (col <span class="kw">not</span> <span class="kw">in</span> imp_cols)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (col <span class="kw">not</span> <span class="kw">in</span> ind_cols)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (col <span class="kw">not</span> <span class="kw">in</span> num_cols)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (col <span class="kw">not</span> <span class="kw">in</span> saldo_cols)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (col <span class="kw">not</span> <span class="kw">in</span> delta_cols)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (<span class="st">"count"</span> <span class="kw">not</span> <span class="kw">in</span> col)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (<span class="st">"sum"</span> <span class="kw">not</span> <span class="kw">in</span> col)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (<span class="st">"avg"</span> <span class="kw">not</span> <span class="kw">in</span> col)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">"TARGET"</span>, <span class="st">"ID"</span>])</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [33]:</pre></div><div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df[remaining_cols].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">var3</th>
<th data-quarto-table-cell-role="th">var15</th>
<th data-quarto-table-cell-role="th">var36</th>
<th data-quarto-table-cell-role="th">var21</th>
<th data-quarto-table-cell-role="th">var38</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>57015.000000</td>
<td>5.701500e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>-1523.211874</td>
<td>33.229624</td>
<td>40.467228</td>
<td>31.965272</td>
<td>1.179580e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>39033.547421</td>
<td>12.957207</td>
<td>47.367241</td>
<td>393.934733</td>
<td>1.947151e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-999999.000000</td>
<td>5.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>5.163750e+03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>2.000000</td>
<td>23.000000</td>
<td>2.000000</td>
<td>0.000000</td>
<td>6.775136e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>2.000000</td>
<td>28.000000</td>
<td>3.000000</td>
<td>0.000000</td>
<td>1.064813e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>2.000000</td>
<td>40.000000</td>
<td>99.000000</td>
<td>0.000000</td>
<td>1.188111e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>238.000000</td>
<td>105.000000</td>
<td>99.000000</td>
<td>30000.000000</td>
<td>2.203474e+07</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [34]:</pre></div><div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df[remaining_cols] <span class="op">\</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    .nunique() <span class="op">\</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    .reset_index() <span class="op">\</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    .rename(</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        mapper<span class="op">=</span>{</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"index"</span>: <span class="st">"Column"</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>: <span class="st">"Number of unique values"</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Number of unique values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>var3</td>
<td>186</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>var15</td>
<td>100</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>var36</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>var21</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>var38</td>
<td>43895</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [35]:</pre></div><div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>neg_pos_zero(df, [<span class="st">"var3"</span>, <span class="st">"var15"</span>, <span class="st">"var38"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Column</th>
<th data-quarto-table-cell-role="th">Negative values (%)</th>
<th data-quarto-table-cell-role="th">Positive values (%)</th>
<th data-quarto-table-cell-role="th">Zero values (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>var15</td>
<td>0.000000</td>
<td>100.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>var38</td>
<td>0.000000</td>
<td>100.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>var3</td>
<td>0.152591</td>
<td>99.742173</td>
<td>0.105235</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
</section>
<section id="var3" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="var3">var3</h4>
<p>Outra variável que possui valores faltantes (-999999) e que também não parece ter poder de discriminação. Como lidar com estes valores varia entre o algorítmo implementado, como discutido anteriormente e no notebook de origem do código abaixo (seção de <em>delta</em>). Não há números decimais, apenas inteiros. Assume-se que é uma variável de contagem. A variável não parece ter poder de discriminação, embora a concentração de clientes insatisfeitos seja menor para valores nulos. Para a floresta aleatória, foi criada uma outra coluna indicadora para valor faltante desta variável.</p>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [36]:</pre></div><div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"var3"</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>nfloat <span class="op">=</span> df[col].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">0</span> <span class="cf">if</span> x<span class="op">%</span><span class="dv">1</span> <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Contagem de números decimais: </span><span class="sc">{</span>nfloat<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Contagem de números decimais: 0</code></pre>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [37]:</pre></div><div class="cell" data-execution_count="37">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"var3"</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>ci_var3 <span class="op">=</span> CustomImputer(prefix<span class="op">=</span><span class="st">"var3"</span>, to_replace<span class="op">=-</span><span class="dv">999999</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>ci_var3 <span class="op">=</span> ci_var3.fit(df)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ci_var3.transform(df)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">\</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    .assign(null <span class="op">=</span> df[col].isna().astype(<span class="bu">int</span>)) <span class="op">\</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"null"</span>)[<span class="st">"TARGET"</span>] <span class="op">\</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    .value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">\</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    .unstack()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="var3-missing" class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">null</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.960406</td>
<td>0.039594</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.977011</td>
<td>0.022989</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [38]:</pre></div><div class="cell" data-execution_count="38">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"var3"</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(df[col], df[<span class="st">"TARGET"</span>], nbins<span class="op">=</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/var3-output-1.png" id="var3" class="img-fluid"></p>
</div>
</div></div>
</section>
<section id="var15" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="var15">var15</h4>
<p>Esta variável possui 100 valores únicos entre 5 e 105. Não há valores decimais. Todas estas características levam a acreditar que esta variável se trata da idade do cliente – o que faz algum sentido, dada a escassez de clientes menores de 18 anos, que provavelmente é resultado de alguma política do banco. Assumiu-se que é uma variável numérica, sem necessidade de qualquer outro tratamento.</p>
<p>Neste caso, as distribuições de clientes satisfeitos e insatisfeitos são bem diferentes, levando a acreditar que a variável possui poder de discriminação.</p>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [39]:</pre></div><div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"var15"</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>nfloat <span class="op">=</span> df[col].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">0</span> <span class="cf">if</span> x<span class="op">%</span><span class="dv">1</span> <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Contagem de números decimais: </span><span class="sc">{</span>nfloat<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Contagem de números decimais: 0</code></pre>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [40]:</pre></div><div class="cell" data-execution_count="40">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> <span class="st">"var15"</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(df[col], df[<span class="st">"TARGET"</span>], nbins<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/var15-output-1.png" id="var15" class="img-fluid"></p>
</div>
</div></div>
</section>
<section id="var36" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="var36">var36</h4>
<p>Esta variável aparenta ser uma variável categórica com labels não ordinais. Para a floresta aleatória, será interessante aplicar um Target Encoder customizado para que as categorias sejam ordenadas com base na proporção de clientes insatisfeitos. Já para modelos lineares e análise de cluster, One Hot Encoding ou Weight of Evidence podem ser mais interessantes. O valor 99 aparenta ser artificial, mas será considerado como uma categoria por ser muito representativo.</p>
<p>Os modelos de <em>boosting</em>, por outro lado, possuem métodos nativos para lidar com variáveis categóricas, mas exigem que seus <em>labels</em> sejam números inteiros variando de 0 a <em>nfeatures</em>-1. Assim, o tratamento será o mesmo que no caso da floresta por pura conveniência.</p>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [41]:</pre></div><div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">"var36"</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>ordered_df <span class="op">=</span> df <span class="op">\</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    .groupby(var)[<span class="st">"TARGET"</span>] <span class="op">\</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    .value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">\</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    .unstack() <span class="op">\</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="dv">0</span>, ascending<span class="op">=</span><span class="va">False</span>) <span class="op">\</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    .merge(</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>        df[var] <span class="op">\</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>            .value_counts() <span class="op">\</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>            .reset_index() <span class="op">\</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>            .set_index(var),</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>        left_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        right_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>ordered_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">var36</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.000000</td>
<td>NaN</td>
<td>302</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.983975</td>
<td>0.016025</td>
<td>16599</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.970058</td>
<td>0.029942</td>
<td>6546</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.968026</td>
<td>0.031974</td>
<td>11009</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>0.936079</td>
<td>0.063921</td>
<td>22559</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [42]:</pre></div><div class="cell" data-execution_count="42">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>CE_var36 <span class="op">=</span> CustomEncoder(colname<span class="op">=</span><span class="st">"var36"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>CE_var36 <span class="op">=</span> CE_var36.fit(df.drop(<span class="st">"TARGET"</span>, axis<span class="op">=</span><span class="dv">1</span>), df[<span class="st">"TARGET"</span>])</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> CE_var36.transform(df)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>ordered_df <span class="op">=</span> df <span class="op">\</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    .groupby(var)[<span class="st">"TARGET"</span>] <span class="op">\</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    .value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">\</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    .unstack() <span class="op">\</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="dv">0</span>, ascending<span class="op">=</span><span class="va">False</span>) <span class="op">\</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    .merge(</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>        df[var] <span class="op">\</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>            .value_counts() <span class="op">\</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>            .reset_index() <span class="op">\</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>            .set_index(var),</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>        left_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>        right_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>ordered_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="var36" class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">var36</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.000000</td>
<td>NaN</td>
<td>302</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.983975</td>
<td>0.016025</td>
<td>16599</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.970058</td>
<td>0.029942</td>
<td>6546</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.968026</td>
<td>0.031974</td>
<td>11009</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.936079</td>
<td>0.063921</td>
<td>22559</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
</section>
<section id="var21" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="var21">var21</h4>
<p>Outra variável que aparenta ser categórica com labels não ordinais. Os mesmos tratamentos de var36 foram escolhidos.</p>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [43]:</pre></div><div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">"var21"</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>ordered_df <span class="op">=</span> df <span class="op">\</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    .groupby(var)[<span class="st">"TARGET"</span>] <span class="op">\</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    .value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">\</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    .unstack() <span class="op">\</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="dv">0</span>, ascending<span class="op">=</span><span class="va">False</span>) <span class="op">\</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    .merge(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>        df[var] <span class="op">\</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>            .value_counts() <span class="op">\</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>            .reset_index() <span class="op">\</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>            .set_index(var),</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>        left_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>        right_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>ordered_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">var21</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">30000</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5400</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1200</td>
<td>1.000000</td>
<td>NaN</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1500</td>
<td>1.000000</td>
<td>NaN</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18000</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9000</td>
<td>1.000000</td>
<td>NaN</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2400</td>
<td>1.000000</td>
<td>NaN</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2700</td>
<td>1.000000</td>
<td>NaN</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3300</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6000</td>
<td>1.000000</td>
<td>NaN</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5700</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5100</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4500</td>
<td>0.985915</td>
<td>0.014085</td>
<td>71</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7200</td>
<td>0.977273</td>
<td>0.022727</td>
<td>44</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3600</td>
<td>0.976744</td>
<td>0.023256</td>
<td>43</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>0.960465</td>
<td>0.039535</td>
<td>56380</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3000</td>
<td>0.954545</td>
<td>0.045455</td>
<td>66</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">900</td>
<td>0.940120</td>
<td>0.059880</td>
<td>167</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1800</td>
<td>0.939189</td>
<td>0.060811</td>
<td>148</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4200</td>
<td>0.500000</td>
<td>0.500000</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2100</td>
<td>0.500000</td>
<td>0.500000</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [44]:</pre></div><div class="cell" data-execution_count="44">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>CE_var21 <span class="op">=</span> CustomEncoder(colname<span class="op">=</span><span class="st">"var21"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>CE_var21 <span class="op">=</span> CE_var21.fit(df.drop(<span class="st">"TARGET"</span>, axis<span class="op">=</span><span class="dv">1</span>), df[<span class="st">"TARGET"</span>])</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> CE_var21.transform(df)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>ordered_df <span class="op">=</span> df <span class="op">\</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    .groupby(var)[<span class="st">"TARGET"</span>] <span class="op">\</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    .value_counts(normalize<span class="op">=</span><span class="va">True</span>) <span class="op">\</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    .unstack() <span class="op">\</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    .merge(</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>        df[var] <span class="op">\</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>            .value_counts() <span class="op">\</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>            .reset_index() <span class="op">\</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>            .set_index(var),</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>        left_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>        right_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>ordered_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="var21" class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">var21</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.000000</td>
<td>NaN</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.000000</td>
<td>NaN</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.000000</td>
<td>NaN</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1.000000</td>
<td>NaN</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1.000000</td>
<td>NaN</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>1.000000</td>
<td>NaN</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>1.000000</td>
<td>NaN</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>1.000000</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>0.985915</td>
<td>0.014085</td>
<td>71</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>0.977273</td>
<td>0.022727</td>
<td>44</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>0.976744</td>
<td>0.023256</td>
<td>43</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>0.960465</td>
<td>0.039535</td>
<td>56380</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>0.954545</td>
<td>0.045455</td>
<td>66</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>0.940120</td>
<td>0.059880</td>
<td>167</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>0.939189</td>
<td>0.060811</td>
<td>148</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>0.500000</td>
<td>0.500000</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>0.500000</td>
<td>0.500000</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
</section>
<section id="var38" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="var38">var38</h4>
<p>Já esta variável aparenta ser numérica, dada a grande quantidade de valores únicos e presença majoritária de números decimais. As ditribuições de clientes satisfeitos e insatisfeitos são muito parecidas, indicando que a variável não tem grande poder de discriminação.</p>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [45]:</pre></div><div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">"var38"</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>nfloat <span class="op">=</span> df[var] <span class="op">\</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x:</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> x<span class="op">%</span><span class="dv">1</span> <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">\</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">sum</span>() <span class="op">\</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> <span class="bu">len</span>(df) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Números decimais: </span><span class="sc">{</span>nfloat<span class="sc">:.2f}</span><span class="ss"> %"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Números decimais: 99.08 %</code></pre>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [46]:</pre></div><div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df[[var]].describe().transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">var38</td>
<td>57015.0</td>
<td>117957.96857</td>
<td>194715.060906</td>
<td>5163.75</td>
<td>67751.355</td>
<td>106481.34</td>
<td>118811.055</td>
<td>22034738.76</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container column-page-left"><div class="cell-decorator"><pre>In [47]:</pre></div><div class="cell" data-execution_count="47">
<details>
<summary>Mostrar/esconder código</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">"var38"</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>cv.binaryhistplot(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    df[var].<span class="bu">apply</span>(np.log1p),</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"TARGET"</span>],</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    nbins<span class="op">=</span><span class="dv">20</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="01-eda_files/figure-html/var38-output-1.png" id="var38" class="img-fluid"></p>
</div>
</div></div>
</section>
</section>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content --> 
  

</body></html>